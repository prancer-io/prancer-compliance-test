{
    "testSet": [
        {
            "masterTestName": "AZURE_Cloud_TEST",
            "version": "0.1",
            "cases": [
                {
                    "masterTestId": "PR-AZR-CLD-KV-001",
                    "type": "rego",
                    "rule": "file(Keyvault.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-KV-001",
                            "eval": "data.rule.KeyVault",
                            "message": "data.rule.KeyVault_err",
                            "remediationDescription": "1. Go to 'Key vaults' and choose your Key Vault<br>2. Select 'Keys/Secrets/Certificates' under 'Settings' in the navigation menu<br>3. Select 'Generate/Import' and complete the wizard.<br>Please visit <a href='https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_CLD_KV_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice",
                                "HIPAA",
                                "NIST CSF"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_228"
                    ],
                    "severity": "Low",
                    "title": "Ensure at least one principal has access to Keyvault",
                    "description": "Use the Azure Key Vault to store secrets within the Microsoft Azure environment. Secrets in Azure Key Vault are octet sequences with a maximum size of 25k bytes each."
                },
                {
                    "masterTestId": "PR-AZR-CLD-KV-002",
                    "type": "rego",
                    "rule": "file(Keyvault.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-KV-002",
                            "eval": "data.rule.enableSoftDelete",
                            "message": "data.rule.enableSoftDelete_err",
                            "remediationDescription": "Via Azure Portal<br>Azure Portal does not have provision to update the respective configurations<br><br>Via Azure CLI<br>Existing key vault:<br><br>For an existing key vault named ContosoVault, enable soft-delete as follows:<br><br>az resource update --ids $(az keyvault show --name ContosoVault -o tsv , awk '{print $1}') --set properties.enableSoftDelete=true.<br>Please visit <a href='https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_CLD_KV_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15", 
                                "APRA (CPS 234) Information Security-CPS234-16", 
                                "APRA (CPS 234) Information Security-CPS234-17", 
                                "APRA (CPS 234) Information Security-CPS234-21", 
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-BR-3", 
                                "Azure Security Benchmark (v3)-GS-8", 
                                "Brazilian Data Protection Law (LGPD)-Article 42", 
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CIS",
                                "CIS v1.1 (Azure)-8.4", 
                                "CIS v1.2.0 (Azure)-8.4", 
                                "CIS v1.3.0 (Azure)-8.4", 
                                "CIS v1.3.1 (Azure)-8.4", 
                                "CIS v1.4.0 (Azure)-8.6", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03", 
                                "CSA CCM v.4.0.1-DSP-10", 
                                "CSA CCM v.4.0.1-IVS-03", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AM.4.226", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:06.c", 
                                "HITRUST v.9.4.2-Control Reference:06.d", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1", 
                                "ISO/IEC 27002:2013-13.1.1", 
                                "ISO/IEC 27002:2013-13.1.2", 
                                "ISO/IEC 27002:2013-13.1.3", 
                                "ISO/IEC 27002:2013-13.2.1", 
                                "ISO/IEC 27002:2013-13.2.3", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.1.3", 
                                "ISO/IEC 27002:2013-8.3.3", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2", 
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1485 - Data Destruction", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Cryptographic Key Establishment and Management", 
                                "NIST 800-53 Rev4-SC-12",
                                "NIST CSF", 
                                "NIST CSF-PR.DS-1", 
                                "NIST CSF-PR.DS-2",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.13.10", 
                                "NIST SP 800-172-3.1.1e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-3.1", 
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_228"
                    ],
                    "severity": "Medium",
                    "title": "Ensure the key vault is recoverable - enable 'Soft Delete' setting for a Key Vault",
                    "description": "The key vault contains object keys, secrets, and certificates. Accidental unavailability of a key vault can cause immediate data loss or loss of security functions (authentication, validation, verification, non-repudiation, etc.) supported by the key vault objects. It is recommended the key vault be made recoverable by enabling the 'Do Not Purge' and 'Soft Delete' functions. This is in order to prevent loss of encrypted data including storage accounts, SQL databases, and/or dependent services provided by key vault objects (Keys, Secrets, Certificates), etc., as may happen in the case of accidental deletion by a user or from disruptive activity by a malicious user."
                },
                {
                    "masterTestId": "PR-AZR-CLD-KV-003",
                    "type": "rego",
                    "rule": "file(Keyvault.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-KV-003",
                            "eval": "data.rule.enablePurgeProtection",
                            "message": "data.rule.enablePurgeProtection_err",
                            "remediationDescription": "Via Azure Portal<br>Azure Portal does not have provision to update the respective configurations<br><br>Via Azure CLI<br>Existing key vault:<br><br>For an existing key vault named ContosoVault, enable purge-protection as follows:<br><br>az resource update --ids $(az keyvault show --name ContosoVault -o tsv , awk '{print $1}') --set properties.enablePurgeProtection=true.<br>Please visit <a href='https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_CLD_KV_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1485 - Data Destruction"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_228"
                    ],
                    "severity": "Medium",
                    "title": "Key vault should have purge protection enabled",
                    "description": "The key vault contains object keys, secrets, and certificates. Accidental unavailability of a key vault can cause immediate data loss or loss of security functions (authentication, validation, verification, non-repudiation"
                },
                {
                    "masterTestId": "PR-AZR-CLD-KV-004",
                    "type": "rego",
                    "rule": "file(KeyvaultKey.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-KV-004",
                            "eval": "data.rule.kv_keys_expire",
                            "message": "data.rule.kv_keys_expire_err",
                            "remediationDescription": "1. Go to 'Key vaults' and choose your Key Vault<br>2. Select 'Keys' under 'Settings' in the navigation menu<br>3. Select the relevant key and reselect its current version<br>4. Check 'Set expiration date'<br>4. Save.<br>Please visit <a href='https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_CLD_KV_004.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v3)-GS-3", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CIS",
                                "CIS v1.1 (Azure)-8.1", 
                                "CIS v1.2.0 (Azure)-8.1", 
                                "CIS v1.3.0 (Azure)-8.1", 
                                "CIS v1.3.1 (Azure)-8.1", 
                                "CIS v1.4.0 (Azure)-8.1", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03", 
                                "CSA CCM v.4.0.1-DSP-10", 
                                "CSA CCM v.4.0.1-IVS-03", 
                                "CyberSecurity Law of the People's Republic of China-Article 21", 
                                "CyberSecurity Law of the People's Republic of China-Article 24", 
                                "CyberSecurity Law of the People's Republic of China-Article 31", 
                                "CyberSecurity Law of the People's Republic of China-Article 40",
                                "CMMC", 
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.187", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.s", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1", 
                                "ISO/IEC 27002:2013-13.1.1", 
                                "ISO/IEC 27002:2013-13.1.2", 
                                "ISO/IEC 27002:2013-13.1.3", 
                                "ISO/IEC 27002:2013-13.2.1", 
                                "ISO/IEC 27002:2013-13.2.3", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.1.3", 
                                "ISO/IEC 27002:2013-8.3.3", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2", 
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v6.3-T1078", 
                                "MITRE ATT&CK v6.3-T1078", 
                                "MITRE ATT&CK v6.3-T1078", 
                                "MITRE ATT&CK v6.3-T1078", 
                                "MITRE ATT&CK v6.3-T1098", 
                                "MITRE ATT&CK v6.3-T1098", 
                                "MITRE ATT&CK v8.2-T1078", 
                                "MITRE ATT&CK v8.2-T1098", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Cryptographic Key Establishment and Management", 
                                "NIST 800-53 Rev4-SC-12",
                                "NIST CSF", 
                                "NIST CSF-PR.DS-1", 
                                "NIST CSF-PR.DS-2",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.13.10", 
                                "NIST SP 800-172-3.5.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-4.1", 
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_228"
                    ],
                    "severity": "Medium",
                    "title": "Azure Key Vault keys should have an expiration date",
                    "description": "This policy identifies Azure Key Vault keys that do not have an expiration date. As a best practice, set an expiration date for each secret and rotate the secret regularly."
                },
                {
                    "masterTestId": "PR-AZR-CLD-KV-005",
                    "type": "rego",
                    "rule": "file(KeyvaultSecrets.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-KV-005",
                            "eval": "data.rule.kv_expire",
                            "message": "data.rule.kv_expire_err",
                            "remediationDescription": "1. Go to Key vaults<br>2. For each Key vault, click on Secrets.<br>3. Ensure that each secret in the vault has EXPIRATION DATE set as appropriate.<br>Please visit <a href='https://docs.microsoft.com/en-us/cli/azure/keyvault/secret?view=azure-cli-latest' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_CLD_KV_005.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v3)-GS-3", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CIS",
                                "CIS v1.1 (Azure)-8.1", 
                                "CIS v1.2.0 (Azure)-8.1", 
                                "CIS v1.3.0 (Azure)-8.1", 
                                "CIS v1.3.1 (Azure)-8.1", 
                                "CIS v1.4.0 (Azure)-8.1", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03", 
                                "CSA CCM v.4.0.1-DSP-10", 
                                "CSA CCM v.4.0.1-IVS-03", 
                                "CyberSecurity Law of the People's Republic of China-Article 21", 
                                "CyberSecurity Law of the People's Republic of China-Article 24", 
                                "CyberSecurity Law of the People's Republic of China-Article 31", 
                                "CyberSecurity Law of the People's Republic of China-Article 40",
                                "CMMC", 
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.187", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.s", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1", 
                                "ISO/IEC 27002:2013-13.1.1", 
                                "ISO/IEC 27002:2013-13.1.2", 
                                "ISO/IEC 27002:2013-13.1.3", 
                                "ISO/IEC 27002:2013-13.2.1", 
                                "ISO/IEC 27002:2013-13.2.3", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.1.3", 
                                "ISO/IEC 27002:2013-8.3.3", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2", 
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v6.3-T1078", 
                                "MITRE ATT&CK v6.3-T1078", 
                                "MITRE ATT&CK v6.3-T1078", 
                                "MITRE ATT&CK v6.3-T1078", 
                                "MITRE ATT&CK v6.3-T1098", 
                                "MITRE ATT&CK v6.3-T1098", 
                                "MITRE ATT&CK v8.2-T1078", 
                                "MITRE ATT&CK v8.2-T1098", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Cryptographic Key Establishment and Management", 
                                "NIST 800-53 Rev4-SC-12",
                                "NIST CSF", 
                                "NIST CSF-PR.DS-1", 
                                "NIST CSF-PR.DS-2",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.13.10", 
                                "NIST SP 800-172-3.5.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-4.1", 
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_228"
                    ],
                    "severity": "Medium",
                    "title": "Azure Key Vault secrets should have an expiration date",
                    "description": "This policy identifies Azure Key Vault secrets that do not have an expiration date. As a best practice, set an expiration date for each secret and rotate the secret regularly."
                },
                {
                    "masterTestId": "PR-AZR-CLD-KV-006",
                    "type": "rego",
                    "rule": "file(Keyvault.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-KV-006",
                            "eval": "data.rule.keyvault_Acl",
                            "message": "data.rule.keyvault_Acl_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/bs-latn-ba/azure/key-vault/general/how-to-azure-key-vault-network-security?tabs=azure-portal' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_KV_006.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_228"
                    ],
                    "severity": "Medium",
                    "title": "Azure Key Vault Network Access default action should be 'deny'",
                    "description": "Azure Key Vault Network Access default action should be 'deny' so that it's not accessible over the public internet. This can reduce data leakage risks."
                },
                {
                    "masterTestId": "PR-AZR-CLD-KV-007",
                    "type": "rego",
                    "rule": "file(Keyvault.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-KV-007",
                            "eval": "data.rule.keyvault_bypass",
                            "message": "data.rule.keyvault_bypass_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/key-vault/general/network-security' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_KV_007.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_228"
                    ],
                    "severity": "Medium",
                    "title": "Azure Key Vault Trusted Microsoft Services access should be enabled",
                    "description": "Specifies whether traffic is bypassed for Logging/Metrics/AzureServices. Possible values are any combination of Logging, Metrics, AzureServices (For example, 'Logging, Metrics'), or None to bypass none of those traffics. - None, Logging, Metrics, AzureServices."
                },
                {
                    "masterTestId": "PR-AZR-CLD-KV-008",
                    "type": "rego",
                    "rule": "file(Keyvault.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-KV-008",
                            "eval": "data.rule.keyvault_service_endpoint",
                            "message": "data.rule.keyvault_service_endpoint_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/key-vault/general/overview-vnet-service-endpoints' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_KV_008.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_228"
                    ],
                    "severity": "Medium",
                    "title": "Key Vault should use a virtual network service endpoint",
                    "description": "This policy audits any Key Vault not configured to use a virtual network service endpoint."
                },
                {
                    "masterTestId": "PR-AZR-CLD-KV-009",
                    "type": "rego",
                    "rule": "file(Keyvault.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-KV-009",
                            "eval": "data.rule.kv_private_endpoint",
                            "message": "data.rule.kv_private_endpoint_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/key-vault/general/private-link-service?tabs=portal' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_KV_009.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_228",
                        "AZRSNP_500"
                    ],
                    "severity": "Medium",
                    "title": "Configure Azure Key Vaults with private endpoints",
                    "description": "Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your key vault, data leakage risks are reduced. Learn more about private links at - https://aka.ms/azureprivatelinkoverview"
                },
                {
                    "masterTestId": "PR-AZR-CLD-KV-010",
                    "type": "rego",
                    "rule": "file(Keyvault.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-KV-010",
                            "eval": "data.rule.kv_public_access_disabled",
                            "message": "data.rule.kv_public_access_disabled_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/key-vault/general/network-security' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_KV_010.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_228"
                    ],
                    "severity": "Medium",
                    "title": "Azure KeyVault Public Network Access should be 'disabled'",
                    "description": "Azure KeyVault Public Network Access should be 'disabled' so that it's not accessible over the public internet. This can reduce data leakage risks."
                },
                {
                    "masterTestId": "PR-AZR-CLD-STR-003",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-STR-003",
                            "eval": "data.rule.storage_secure",
                            "message": "data.rule.storage_secure_err",
                            "remediationDescription": "1. Go to 'Storage accounts' and choose your storage account<br>2. Select 'Configuration' under 'Settings' in the navigation menu<br>3. Set 'Secure transfer required' to 'Enabled'<br>4. Save.<br>Please visit <a href='https://docs.microsoft.com/en-us/rest/api/storagerp/storage-accounts/get-properties' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_CLD_STR_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15",
                                "APRA (CPS 234) Information Security-CPS234-16",
                                "APRA (CPS 234) Information Security-CPS234-17",
                                "APRA (CPS 234) Information Security-CPS234-21",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-DP-4",
                                "Azure Security Benchmark (v3)-DP-3",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CIS",
                                "CIS v1.1 (Azure)-3.1",
                                "CIS v1.2.0 (Azure)-3.1",
                                "CIS v1.3.0 (Azure)-3.1",
                                "CIS v1.3.1 (Azure)-3.1",
                                "CIS v1.4.0 (Azure)-3.1",
                                "CSA CCM",
                                "CSA CCM v3.0.1-CCC-04",
                                "CSA CCM v3.0.1-EKM-02",
                                "CSA CCM v3.0.1-EKM-03",
                                "CSA CCM v3.0.1-EKM-04",
                                "CyberSecurity Law of the People's Republic of China-Article 40",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.185",
                                "GDPR-Article 25",
                                "GDPR-Article 32",
                                "HIPAA",
                                "HIPAA-164.312(e)(2)(ii)",
                                "HITRUST",
                                "HITRUST CSF v9.3-Control Reference:01.j",
                                "HITRUST CSF v9.3-Control Reference:01.y",
                                "HITRUST CSF v9.3-Control Reference:05.i",
                                "HITRUST CSF v9.3-Control Reference:06.f",
                                "HITRUST CSF v9.3-Control Reference:09.s",
                                "HITRUST CSF v9.3-Control Reference:09.x",
                                "HITRUST CSF v9.3-Control Reference:10.f",
                                "ISO 27001:2013",
                                "ISO 27001:2013-A.10.1.2",
                                "ISO 27001:2013-A.14.1.2",
                                "ISO 27001:2013-A.18.1.3",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1530 - Data from Cloud Storage Object",
                                "MITRE ATT&CK v6.3-T1530",
                                "MITRE ATT&CK v8.2-T1530",
                                "NIST 800",
                                "NIST 800-53 Rev4-AC-17 (2)",
                                "NIST 800-53 Rev4-SC-13",
                                "NIST 800-53 Rev4-SI-7 (6)",
                                "NIST CSF",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.8",
                                "NIST SP 800-172-3.4.1e",
                                "NIST SP 800-172-3.4.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-4.1",
                                "PCI DSS v3.2.1-6.5.3",
                                "PIPEDA",
                                "PIPEDA-4.7.3",
                                "SOC 2",
                                "SOC 2-CC6.1"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Storage Accounts https based secure transfer should be enabled",
                    "description": "The secure transfer option enhances the security of your storage account by only allowing requests to the storage account by a secure connection. For example, when calling REST APIs to access your storage accounts, you must connect using HTTPS. Any requests using HTTP will be rejected when 'secure transfer required' is enabled. When you are using the Azure files service, connection without encryption will fail, including scenarios using SMB 2.1, SMB 3.0 without encryption, and some flavors of the Linux SMB client. Because Azure storage doesn't support HTTPS for custom domain names, this option is not applied when using a custom domain name.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "PR-AZR-CLD-STR-004",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-STR-004",
                            "eval": "data.rule.storage_acl",
                            "message": "data.rule.storage_acl_err",
                            "remediationDescription": "1. Go to Storage Accounts<br>2. For each storage account, Click on the settings menu called Firewalls and virtual networks.<br>3. Ensure that you have selected to allow access from Selected networks.<br>4. Add rules to allow traffic from specific network.<br>5. Click Save to apply your changes.<br>Azure Command Line Interface 2.0 Use the below command to update default-action to Deny.<br>Please visit <a href='https://docs.microsoft.com/en-us/rest/api/storagerp/storage-accounts/get-properties' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_CLD_STR_004.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-GS-2", 
                                "Azure Security Benchmark (v2)-NS-1", 
                                "Azure Security Benchmark (v3)-GS-4", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CIS",
                                "CIS v1.1 (Azure)-3.7", 
                                "CIS v1.2.0 (Azure)-3.6", 
                                "CIS v1.3.0 (Azure)-3.6", 
                                "CIS v1.3.1 (Azure)-3.6", 
                                "CIS v1.4.0 (Azure)-3.6", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-AIS-01", 
                                "CSA CCM v.4.0.1-AIS-02", 
                                "CSA CCM v.4.0.1-AIS-04", 
                                "CSA CCM v.4.0.1-CCC-01", 
                                "CSA CCM v.4.0.1-GRC-03", 
                                "CSA CCM v.4.0.1-IVS-04", 
                                "CSA CCM v.4.0.1-UEM-06", 
                                "CyberSecurity Law of the People's Republic of China-Article 21", 
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.177", 
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.185", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.d", 
                                "HITRUST v.9.4.2-Control Reference:01.r", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.1.2", 
                                "ISO/IEC 27002:2013-14.1.1", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.2.1", 
                                "ISO/IEC 27002:2013-14.2.2", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.1.2", 
                                "ISO/IEC 27017:2015-14.1.1", 
                                "ISO/IEC 27017:2015-14.1.2", 
                                "ISO/IEC 27017:2015-14.2.1",
                                "ISO/IEC 27017:2015-14.2.5", 
                                "ISO/IEC 27017:2015-5.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-12.1.2", 
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1530 - Data from Cloud Storage Object", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Boundary Protection | Block Communication from Non-organizationally Configured Hosts", 
                                "NIST 800-53 Rev 5-Boundary Protection | Deny by Default â Allow by Exception", 
                                "NIST 800-53 Rev 5-Boundary Protection | Restrict Incoming Communications Traffic", 
                                "NIST 800-53 Rev 5-Remote Access | Protection of Confidentiality and Integrity Using Encryption", 
                                "NIST 800-53 Rev 5-System Monitoring | Inbound and Outbound Communications Traffic", 
                                "NIST 800-53 Rev4-AC-17 (2)", 
                                "NIST 800-53 Rev4-SC-7 (11)", 
                                "NIST 800-53 Rev4-SC-7 (19)",
                                "NIST 800-53 Rev4-SC-7 (5)", 
                                "NIST 800-53 Rev4-SI-4 (4)", 
                                "NIST CSF",
                                "NIST CSF-PR.IP-1", 
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.4.2", 
                                "NIST SP 800-172-3.14.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-2.1", 
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Storage Accounts should have firewall rules enabled",
                    "description": "Turning on firewall rules for your storage account blocks incoming requests for data by default, unless the requests come from a service that is operating within an Azure Virtual Network (VNet). Requests that are blocked include those from other Azure services, from the Azure portal, from logging and metrics services, and so on.<br><br>You can grant access to Azure services that operate from within a VNet by allowing the subnet of the service instance. Enable a limited number of scenarios through the Exceptions mechanism described in the following section. To access the Azure portal, you would need to be on a machine within the trusted boundary (either IP or VNet) that you set up.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "PR-AZR-CLD-STR-006",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-STR-006",
                            "eval": "data.rule.blobService",
                            "message": "data.rule.blobService_err",
                            "remediationDescription": "Currently, Storage account supports customer-managed keys encryption for blobs by default upon account creation, this cannot be changed after.<br>Note: When customer-managed keys are configured, your data in Blob storage and Azure Files is automatically protected using the customer-managed keys.<br>Please visit <a href='https://docs.microsoft.com/en-us/azure/storage/common/storage-service-encryption' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_CLD_STR_006.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "PCI-DSS",
                                "GDPR",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "severity": "High",
                    "title": "Ensure that 'Storage service encryption' is enabled for the Blob Service",
                    "description": "Enable data encryption at rest for blobs. Storage service encryption protects your data at rest. Azure Storage encrypts data when it's written, and automatically decrypts it when it is accessed.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "PR-AZR-CLD-STR-007",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-STR-007",
                            "eval": "data.rule.fileService",
                            "message": "data.rule.fileService_err",
                            "remediationDescription": "By default Azure Storage uses server-side encryption (SSE) to automatically encrypt your data when it is persisted to the cloud.<br>No autoremediation needed.<br>Please visit <a href='https://docs.microsoft.com/en-us/azure/storage/common/storage-service-encryption' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_CLD_STR_007.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "PCI-DSS",
                                "GDPR",
                                "ISO 27001",
                                "HIPAA",
                                "Best Practice"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "severity": "High",
                    "title": "Ensure that 'Storage service encryption' is enabled for the File Service",
                    "description": "Azure Storage encryption protects your data and helps you to meet your organizational security and compliance commitments. Data in Azure Storage is encrypted and decrypted transparently using 256-bit AES encryption, one of the strongest block ciphers available, and is FIPS 140-2 compliant. Azure Storage encryption is similar to BitLocker encryption on Windows",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "PR-AZR-CLD-STR-008",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-STR-008",
                            "eval": "data.rule.keySource",
                            "message": "data.rule.keySource_err",
                            "remediationDescription": "To configure customer-managed keys with automatic updating of the key version with Azure CLI:<br><br>key_vault_uri=$(az keyvault show --name --resource-group --query properties.vaultUri --output tsv)<br>az storage account update<br>--name --resource-group --encryption-key-name --encryption-key-source Microsoft.Keyvault --encryption-key-vault $key_vault_uri<br><br>References:<a href='https://docs.microsoft.com/en-us/azure/storage/common/customer-managed-keys-configure-key-vault?tabs=azure-cli' target='_blank'>https://docs.microsoft.com/en-us/azure/storage/common/customer-managed-keys-configure-key-vault?tabs=azure-cli</a>",
                            "remediationFunction": "PR_AZR_CLD_STR_008.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15", 
                                "APRA (CPS 234) Information Security-CPS234-16", 
                                "APRA (CPS 234) Information Security-CPS234-17", 
                                "APRA (CPS 234) Information Security-CPS234-21", 
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-DP-5", 
                                "Azure Security Benchmark (v3)-DP-4", 
                                "Azure Security Benchmark (v3)-DP-5", 
                                "Azure Security Benchmark (v3)-GS-7", 
                                "CIS",
                                "CIS v1.1 (Azure)-5.1.6", 
                                "CIS v1.3.0 (Azure)-5.1.4", 
                                "CIS v1.3.1 (Azure)-5.1.4", 
                                "CIS v1.4.0 (Azure)-5.1.4", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03", 
                                "CSA CCM v.4.0.1-DSP-10", 
                                "CSA CCM v.4.0.1-UEM-11", 
                                "CyberSecurity Law of the People's Republic of China-Article 30", 
                                "CyberSecurity Law of the People's Republic of China-Article 31", 
                                "CyberSecurity Law of the People's Republic of China-Article 40", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:06.d", 
                                "HITRUST v.9.4.2-Control Reference:09.s", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1", 
                                "ISO/IEC 27002:2013-12.2.1", 
                                "ISO/IEC 27002:2013-12.3.1", 
                                "ISO/IEC 27002:2013-13.2.1", 
                                "ISO/IEC 27002:2013-13.2.3", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.1.3", 
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2", 
                                "ISO/IEC 27017:2015-6.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2", 
                                "ISO/IEC 27018:2019-12.3.1", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Cryptographic Key Establishment and Management", 
                                "NIST 800-53 Rev 5-Remote Access | Protection of Confidentiality and Integrity Using Encryption", 
                                "NIST 800-53 Rev 5-Transmission Confidentiality and Integrity | Cryptographic Protection", 
                                "NIST 800-53 Rev4-AC-17 (2)", 
                                "NIST 800-53 Rev4-SC-12", 
                                "NIST 800-53 Rev4-SC-8 (1)", 
                                "NIST CSF",
                                "NIST CSF-PR.DS-1", 
                                "NIST CSF-PR.DS-5", 
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.16", 
                                "NIST SP 800-172-3.1.3e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-3.4.1", 
                                "PCI DSS v3.2.1-4.1"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Ensure critical data storage in Storage Account is encrypted with Customer Managed Key",
                    "description": "By default, data in the storage account is encrypted using Microsoft Managed Keys at rest. All Azure Storage resources are encrypted, including blobs, disks, files, queues, and tables. All object metadata is also encrypted. However, if you want to control and manage this encryption key yourself, you can specify a customer-managed key, that key is used to protect and control access to the key that encrypts your data. You can also choose to automatically update the key version used for Azure Storage encryption whenever a new version is available in the associated Key Vault.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "PR-AZR-CLD-STR-009",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-STR-009",
                            "eval": "data.rule.region",
                            "message": "data.rule.region_err",
                            "remediationDescription": "Please refer to Azure documentations about Storage Accounts:<br><a href='https://docs.microsoft.com/en-us/azure/storage/common/storage-create-storage-account' target='_blank'>here</a>.<br>and<br>Azure documentations about Regions:<br><a href='https://azure.microsoft.com/en-us/global-infrastructure/regions/#services' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_STR_009.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "GDPR"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "severity": "High",
                    "title": "Storage Accounts location configuration should be inside of Europe",
                    "description": "Identify Storage Accounts outside of the following regions: northeurope, westeurope",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "PR-AZR-CLD-STR-010",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-STR-010",
                            "eval": "data.rule.blobServicePublicAccessDisabled",
                            "message": "data.rule.blobServicePublicAccessDisabled_err",
                            "remediationDescription": "To disallow public access for a storage account in the Azure portal, follow these steps:<br><br>1. Navigate to your storage account in the Azure portal.<br>2. Locate the Configuration setting under Settings.<br>3. Set Blob public access to Disabled.",
                            "remediationFunction": "PR_AZR_CLD_STR_010.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-NS-1", 
                                "Azure Security Benchmark (v3)-AM-4", 
                                "Azure Security Benchmark (v3)-GS-7", 
                                "Azure Security Benchmark (v3)-IM-7", 
                                "Azure Security Benchmark (v3)-PA-7", 
                                "Brazilian Data Protection Law (LGPD)-Article 26", 
                                "CIS",
                                "CIS v1.1 (Azure)-5.1.5", 
                                "CIS v1.3.0 (Azure)-5.1.3", 
                                "CIS v1.3.1 (Azure)-5.1.3", 
                                "CIS v1.4.0 (Azure)-5.1.3", 
                                "CyberSecurity Law of the People's Republic of China-Article 30", 
                                "CyberSecurity Law of the People's Republic of China-Article 31", 
                                "CyberSecurity Law of the People's Republic of China-Article 45", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AC.1.004", 
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AU.3.049", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.c", 
                                "HITRUST v.9.4.2-Control Reference:09.m", 
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1530 - Data from Cloud Storage Object", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Protection of Audit Information", 
                                "NIST 800-53 Rev4-AU-9", 
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.1.22", 
                                "NIST SP 800-172-3.14.3e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.3", 
                                "PCI DSS v3.2.1-7.1"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Ensure that Storage Account should not allow public access to all blobs or containers",
                    "description": "This policy will identify which Storage Account has public access enabled for all blobs or containers",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "PR-AZR-CLD-STR-011",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-STR-011",
                            "eval": "data.rule.storage_acount_by_pass",
                            "message": "data.rule.storage_acount_by_pass_err",
                            "remediationDescription": "1. Go to Storage Accounts<br>2. For each storage account, Click on the settings menu called Firewalls and virtual networks.<br>3. Ensure that you have elected to allow access from 'Selected networks'.<br>4. Enable check box for Allow trusted Microsoft services to access this storage account.<br>5. Click Save to apply your changes.<br>Azure Command Line Interface 2.0 Use the below command to update trusted Microsoft services.<br>Please visit <a href='https://docs.microsoft.com/en-us/azure/storage/common/storage-network-security' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_CLD_STR_011.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15",
                                "APRA (CPS 234) Information Security-CPS234-16",
                                "APRA (CPS 234) Information Security-CPS234-17",
                                "APRA (CPS 234) Information Security-CPS234-21",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-GS-2",
                                "Azure Security Benchmark (v2)-NS-1",
                                "Azure Security Benchmark (v3)-GS-9",
                                "Azure Security Benchmark (v3)-NS-1",
                                "Azure Security Benchmark (v3)-NS-2",
                                "Azure Security Benchmark (v3)-NS-3",
                                "Azure Security Benchmark (v3)-NS-7",
                                "Azure Security Benchmark (v3)-NS-8",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CIS",
                                "CIS v1.1 (Azure)-3.8",
                                "CIS v1.2.0 (Azure)-3.7",
                                "CIS v1.3.0 (Azure)-3.7",
                                "CIS v1.3.1 (Azure)-3.7",
                                "CIS v1.4.0 (Azure)-3.7",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-AIS-01",
                                "CSA CCM v.4.0.1-AIS-02",
                                "CSA CCM v.4.0.1-AIS-04",
                                "CSA CCM v.4.0.1-CCC-01",
                                "CSA CCM v.4.0.1-GRC-03",
                                "CSA CCM v.4.0.1-IVS-04",
                                "CSA CCM v.4.0.1-UEM-06",
                                "CyberSecurity Law of the People's Republic of China-Article 21",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AC.1.001",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AC.1.002",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:10.a",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.1.2",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.2.1",
                                "ISO/IEC 27002:2013-14.2.2",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.1.2",
                                "ISO/IEC 27017:2015-14.1.1",
                                "ISO/IEC 27017:2015-14.1.2",
                                "ISO/IEC 27017:2015-14.2.1",
                                "ISO/IEC 27017:2015-14.2.5",
                                "ISO/IEC 27017:2015-5.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-12.1.2",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1199 - Trusted Relationship",
                                "MITRE ATT&CK v6.3-T1199",
                                "MITRE ATT&CK v6.3-T1530",
                                "MITRE ATT&CK v8.2-T1199",
                                "MITRE ATT&CK v8.2-T1530",
                                "NIST CSF",
                                "NIST CSF-PR.IP-1",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.4.2",
                                "NIST SP 800-172-3.4.1e",
                                "NIST SP 800-172-3.4.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-6.3",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Storage Account Trusted Microsoft Services access should be enabled",
                    "description": "Specifies whether traffic is bypassed for Logging/Metrics/AzureServices. Possible values are any combination of Logging, Metrics, AzureServices (For example, 'Logging, Metrics'), or None to bypass none of those traffics. - None, Logging, Metrics, AzureServices.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "PR-AZR-CLD-STR-018",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-STR-018",
                            "eval": "data.rule.storage_account_latest_tls_configured",
                            "message": "data.rule.storage_account_latest_tls_configured_err",
                            "remediationDescription": "To configure the minimum TLS version for an existing storage account with the Azure portal, follow these steps:<br><br>1. Navigate to your storage account in the Azure portal.<br>2. Under Settings, select Configuration.<br>3. Under Minimum TLS version, use the drop-down to select the minimum version of TLS required to access data in this storage account",
                            "remediationFunction": "PR_AZR_CLD_STR_018.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "CIS",
                                "CIS v1.4.0 (Azure)-3.12"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Ensure Azure Storage Account has latest version of tls configured",
                    "description": "This policy will identify the Azure Storage Account which don't have the latest version of tls configured and give the alert",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "PR-AZR-CLD-STR-019",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-STR-019",
                            "eval": "data.rule.storage_account_private_endpoint",
                            "message": "data.rule.storage_account_private_endpoint_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/storage/common/storage-private-endpoints' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_STR_019.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "severity": "High",
                    "title": "Storage accounts should use private link",
                    "description": "Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your storage account, data leakage risks are reduced. Learn more about private links at - https://aka.ms/azureprivatelinkoverview",
                    "masterSnapshotId": [
                        "AZRSNP_301",
                        "AZRSNP_500"
                    ]
                },
                {
                    "masterTestId": "PR-AZR-CLD-STR-020",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-STR-020",
                            "eval": "data.rule.storage_account_require_encryption",
                            "message": "data.rule.storage_account_require_encryption_err",
                            "remediationDescription": "1. In the Azure portal, navigate to the Storage accounts page.<br>2. Choose the Add button to add a new general-purpose v2 storage account.<br>3. On the Advanced tab, locate Infrastructure encryption, and select Enabled.<br>4. Select Review + create to finish creating the storage account.",
                            "remediationFunction": "PR_AZR_CLD_STR_020.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "severity": "High",
                    "title": "Storage accounts should have infrastructure encryption",
                    "description": "Enable infrastructure encryption for a higher level of assurance that the data is secure. When infrastructure encryption is enabled, data in a storage account is encrypted twice.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "PR-AZR-CLD-STR-021",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-STR-021",
                            "eval": "data.rule.storage_account_scopes_require_encryption",
                            "message": "data.rule.storage_account_scopes_require_encryption_err",
                            "remediationDescription": "1. In the Azure portal, navigate to the Storage accounts page.<br>2. Choose the Add button to add a new general-purpose v2 storage account.<br>3. On the Advanced tab, locate Infrastructure encryption, and select Enabled.<br>4. Select Review + create to finish creating the storage account.",
                            "remediationFunction": "PR_AZR_CLD_STR_021.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "severity": "High",
                    "title": "Storage account encryption scopes should have infrastructure encryption",
                    "description": "Enable infrastructure encryption for encryption at the rest of your storage account encryption scopes for added security. Infrastructure encryption ensures that your data is encrypted twice.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "PR-AZR-CLD-STR-022",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-STR-022",
                            "eval": "data.rule.storage_account_encryption_scopes_source",
                            "message": "data.rule.storage_account_encryption_scopes_source_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/storage/common/customer-managed-keys-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_STR_022.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "severity": "High",
                    "title": "Storage account encryption scopes should use customer-managed keys to encrypt data at rest",
                    "description": "Use customer-managed keys to manage the encryption at the rest of your storage account encryption scopes. Customer-managed keys enable the data to be encrypted with an Azure key-vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about storage account encryption scopes at https://aka.ms/encryption-scopes-overview.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "PR-AZR-CLD-STR-023",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-STR-023",
                            "eval": "data.rule.storage_vnet_service_endpoint",
                            "message": "data.rule.storage_vnet_service_endpoint_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/virtual-network/virtual-network-service-endpoint-policies-overviewv' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_STR_023.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "severity": "High",
                    "title": "Storage Accounts should use a virtual network service endpoint",
                    "description": "This policy audits any Storage Account not configured to use a virtual network service endpoint.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "PR-AZR-CLD-STR-024",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-STR-024",
                            "eval": "data.rule.storage_account_allow_shared_key_access",
                            "message": "data.rule.storage_account_allow_shared_key_access_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/storage/common/shared-key-authorization-prevent?tabs=portal' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_STR_024.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "severity": "High",
                    "title": "Storage accounts should prevent shared key access",
                    "description": "Audit requirement of Azure Active Directory (Azure AD) to authorize requests for your storage account. By default, requests can be authorized with either Azure Active Directory credentials or by using the account access key for Shared Key authorization. Of these two types of authorization, Azure AD provides superior security and ease of use over Shared Key and is recommended by Microsoft.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "PR-AZR-CLD-STR-025",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-STR-025",
                            "eval": "data.rule.storage_account_file_share_usage_smb_protocol",
                            "message": "data.rule.storage_account_file_share_usage_smb_protocol_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/storage/files/files-smb-protocol?tabs=azure-portal#smb-security-settings' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_STR_025.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Storage Account File Share should use SMB protocol",
                    "description": "The Server Message Block (SMB) protocol is a network file sharing protocol that allows applications on a computer to read and write to files and to request services from server programs in a computer network. The SMB protocol can be used on top of its TCP/IP protocol or other network protocols.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "PR-AZR-CLD-WEB-001",
                    "type": "rego",
                    "rule": "file(web.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-WEB-001",
                            "eval": "data.rule.https_only",
                            "message": "data.rule.https_only_err",
                            "remediationDescription": "1. Sign on to Azure App services<br>2. Click on the name of the App service web application you want to examine<br>3. In the navigation panel,under Settings, select 'TLS/SSL settings'<br>4. In the 'HTTPS Only' toggle select ON<br><br>References:<br><a href='https://docs.microsoft.com/en-us/azure/app-service/configure-ssl-bindings' target='_blank'>https://docs.microsoft.com/en-us/azure/app-service/configure-ssl-bindings</a>",
                            "remediationFunction": "PR_AZR_CLD_WEB_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15", 
                                "APRA (CPS 234) Information Security-CPS234-16", 
                                "APRA (CPS 234) Information Security-CPS234-17", 
                                "APRA (CPS 234) Information Security-CPS234-21", 
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-DP-4", 
                                "Azure Security Benchmark (v2)-NS-1", 
                                "Azure Security Benchmark (v3)-DP-3", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CIS",
                                "CIS v1.1 (Azure)-9.2", 
                                "CIS v1.2.0 (Azure)-9.2", 
                                "CIS v1.3.0 (Azure)-9.2", 
                                "CIS v1.3.1 (Azure)-9.2", 
                                "CIS v1.4.0 (Azure)-9.2", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03", 
                                "CSA CCM v.4.0.1-DSP-10", 
                                "CSA CCM v.4.0.1-IVS-03", 
                                "CSA CCM v.4.0.1-UEM-11", 
                                "CyberSecurity Law of the People's Republic of China-Article 21", 
                                "CyberSecurity Law of the People's Republic of China-Article 40", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.185", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.s", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1", 
                                "ISO/IEC 27002:2013-12.2.1", 
                                "ISO/IEC 27002:2013-12.3.1", 
                                "ISO/IEC 27002:2013-13.1.1", 
                                "ISO/IEC 27002:2013-13.1.2", 
                                "ISO/IEC 27002:2013-13.1.3", 
                                "ISO/IEC 27002:2013-13.2.1", 
                                "ISO/IEC 27002:2013-13.2.3", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.1.3", 
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-8.3.1", 
                                "ISO/IEC 27002:2013-8.3.3", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2", 
                                "ISO/IEC 27017:2015-6.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2", 
                                "ISO/IEC 27018:2019-12.3.1", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Transmission Confidentiality and Integrity | Cryptographic Protection", 
                                "NIST 800-53 Rev4-SC-8 (1)",
                                "NIST CSF", 
                                "NIST CSF-PR.DS-2", 
                                "NIST CSF-PR.DS-5",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.13.8", 
                                "NIST SP 800-172-3.4.1e", 
                                "NIST SP 800-172-3.4.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-2.3", 
                                "PCI DSS v3.2.1-4.1", 
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Web"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Azure App Service Web App enforce https connection",
                    "description": "Azure Web Apps by default allow sites to run under both HTTP and HTTPS and can be accessed by anyone using non-secure HTTP links. Non-secure HTTP requests can be restricted and all HTTP requests redirected to the secure HTTPS port. We recommend you enforce HTTPS-only traffic to increase security. This will redirect all non-secure HTTP requests to HTTPS ports. HTTPS uses the SSL/TLS protocol to provide a secure connection, which is both encrypted and authenticated."
                },
                {
                    "masterTestId": "PR-AZR-CLD-WEB-002",
                    "type": "rego",
                    "rule": "file(web.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-WEB-002",
                            "eval": "data.rule.min_tls_version",
                            "message": "data.rule.min_tls_version_err",
                            "remediationDescription": "1. Go to 'App Services' and choose your App Service.<br>2. Select 'TLS/SSL settings' under 'Settings' on the navigation menu.<br>3. Under 'Bindings' set 'Minimum TLS Version' to '1.2'.<br><br><a href=' https://docs.microsoft.com/en-us/cli/azure/webapp/config?view=azure-cli-latest' target='_blank'> https://docs.microsoft.com/en-us/cli/azure/webapp/config?view=azure-cli-latest</a>",
                            "remediationFunction": "PR_AZR_CLD_WEB_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15", 
                                "APRA (CPS 234) Information Security-CPS234-16", 
                                "APRA (CPS 234) Information Security-CPS234-17", 
                                "APRA (CPS 234) Information Security-CPS234-21", 
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-DP-4", 
                                "Azure Security Benchmark (v2)-NS-1", 
                                "Azure Security Benchmark (v3)-DP-3", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CIS",
                                "CIS v1.1 (Azure)-9.3", 
                                "CIS v1.2.0 (Azure)-9.3", 
                                "CIS v1.3.0 (Azure)-9.3", 
                                "CIS v1.3.1 (Azure)-9.3", 
                                "CIS v1.4.0 (Azure)-9.3", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03", 
                                "CSA CCM v.4.0.1-DSP-10", 
                                "CSA CCM v.4.0.1-IVS-03", 
                                "CSA CCM v.4.0.1-UEM-11", 
                                "CyberSecurity Law of the People's Republic of China-Article 21", 
                                "CyberSecurity Law of the People's Republic of China-Article 40", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.185", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.s", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1", 
                                "ISO/IEC 27002:2013-12.2.1", 
                                "ISO/IEC 27002:2013-12.3.1", 
                                "ISO/IEC 27002:2013-13.1.1", 
                                "ISO/IEC 27002:2013-13.1.2", 
                                "ISO/IEC 27002:2013-13.1.3", 
                                "ISO/IEC 27002:2013-13.2.1", 
                                "ISO/IEC 27002:2013-13.2.3", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.1.3", 
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-8.3.1", 
                                "ISO/IEC 27002:2013-8.3.3", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2", 
                                "ISO/IEC 27017:2015-6.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2", 
                                "ISO/IEC 27018:2019-12.3.1", 
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1190 - Exploit Public-Facing Application", 
                                "MITRE ATT&CK v6.3-T1190", 
                                "MITRE ATT&CK v8.2-T1190", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Transmission Confidentiality and Integrity | Cryptographic Protection", 
                                "NIST 800-53 Rev4-SC-8 (1)",
                                "NIST CSF", 
                                "NIST CSF-PR.DS-2", 
                                "NIST CSF-PR.DS-5",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.13.8", 
                                "NIST SP 800-172-3.4.1e", 
                                "NIST SP 800-172-3.4.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-2.3", 
                                "PCI DSS v3.2.1-4.1", 
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Web"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "High",
                    "title": "Web App should use the latest version of TLS encryption",
                    "description": "App service currently allows the web app to set TLS versions 1.0, 1.1, and 1.2. For secure web app connections, it is highly recommended to only use the latest TLS 1.2 version."
                },
                {
                    "masterTestId": "PR-AZR-CLD-WEB-003",
                    "type": "rego",
                    "rule": "file(web.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-WEB-003",
                            "eval": "data.rule.client_cert_enabled",
                            "message": "data.rule.client_cert_enabled_err",
                            "remediationDescription": "1. Go to 'App Services' from Azure Management console and choose your App Service.<br>2. Under 'Settings, select 'Configuration' on the navigation menu.<br>3. Select 'General Settings'.<br>4. Go to 'Client Certificate mode' under 'Incoming Client Certificates' and select 'Require' Button.<br>5. Click Save.<br><br>Note: By default, Client Certificate mode is set to Ignore.<br><br>References:<a href='https://docs.microsoft.com/en-us/azure/app-service/app-service-web-configure-tls-mutual-auth' target='_blank'>https://docs.microsoft.com/en-us/azure/app-service/app-service-web-configure-tls-mutual-auth</a>",
                            "remediationFunction": "PR_AZR_CLD_WEB_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15", 
                                "APRA (CPS 234) Information Security-CPS234-16", 
                                "APRA (CPS 234) Information Security-CPS234-17", 
                                "APRA (CPS 234) Information Security-CPS234-21", 
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-DP-4", 
                                "Azure Security Benchmark (v3)-AM-4", 
                                "Azure Security Benchmark (v3)-IM-7", 
                                "Azure Security Benchmark (v3)-PA-7", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CIS",
                                "CIS v1.1 (Azure)-9.4", 
                                "CIS v1.2.0 (Azure)-9.4", 
                                "CIS v1.3.0 (Azure)-9.4", 
                                "CIS v1.3.1 (Azure)-9.4", 
                                "CIS v1.4.0 (Azure)-9.4", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-AIS-01", 
                                "CSA CCM v.4.0.1-AIS-02", 
                                "CSA CCM v.4.0.1-AIS-04", 
                                "CSA CCM v.4.0.1-CCC-01", 
                                "CSA CCM v.4.0.1-GRC-03", 
                                "CSA CCM v.4.0.1-IVS-04", 
                                "CSA CCM v.4.0.1-UEM-06", 
                                "CyberSecurity Law of the People's Republic of China-Article 21", 
                                "CyberSecurity Law of the People's Republic of China-Article 31", 
                                "CyberSecurity Law of the People's Republic of China-Article 40", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AC.2.013", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:10.a", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.1.2", 
                                "ISO/IEC 27002:2013-14.1.1", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.2.1", 
                                "ISO/IEC 27002:2013-14.2.2", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.1.2", 
                                "ISO/IEC 27017:2015-14.1.1", 
                                "ISO/IEC 27017:2015-14.1.2", 
                                "ISO/IEC 27017:2015-14.2.1", 
                                "ISO/IEC 27017:2015-14.2.5", 
                                "ISO/IEC 27017:2015-5.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-12.1.2", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Signed Components", 
                                "NIST 800-53 Rev4-CM-5 (3)",
                                "NIST CSF", 
                                "NIST CSF-PR.IP-1",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.4.2", 
                                "NIST SP 800-172-3.5.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-6.3"
                            ],
                            "service": [
                                "Web"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Web App should have incoming client certificates enabled",
                    "description": "Client certificates allow the Web App to require a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app. The TLS mutual authentication technique in enterprise environments ensures the authenticity of clients to the server. If incoming client certificates are enabled only an authenticated client with valid certificates can access the app."
                },
                {
                    "masterTestId": "PR-AZR-CLD-WEB-004",
                    "type": "rego",
                    "rule": "file(web.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-WEB-004",
                            "eval": "data.rule.http_20_enabled",
                            "message": "data.rule.http_20_enabled_err",
                            "remediationDescription": "1. Sign on to Azure Management console and navigate to App services<br>2. Click on the name of the App service web application you want to examine<br>3. In the navigation panel,under Settings, select Configuration to access the configuration settings defined for the selected application.<br>4. On the Configuration panel, select 'General settings' tab to access the application general settings<br>5. In the Platform settings section, select '2.0' from the HTTP version dropdown list to enable HTTP/2 – the latest version of HTTP protocol,for the selected web application<br>6. Click Save to apply the change<br><br>References:<br><a href='https://docs.microsoft.com/en-us/azure/app-service/configure-ssl-bindings#enforce-tls-versions' target='_blank'>https://docs.microsoft.com/en-us/azure/app-service/configure-ssl-bindings#enforce-tls-versions</a>",
                            "remediationFunction": "PR_AZR_CLD_WEB_004.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15", 
                                "APRA (CPS 234) Information Security-CPS234-16", 
                                "APRA (CPS 234) Information Security-CPS234-17", 
                                "APRA (CPS 234) Information Security-CPS234-21", 
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-PV-3", 
                                "Azure Security Benchmark (v2)-PV-7", 
                                "Azure Security Benchmark (v3)-AM-2", 
                                "Azure Security Benchmark (v3)-AM-5", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CIS",
                                "CIS v1.1 (Azure)-9.10", 
                                "CIS v1.2.0 (Azure)-9.10", 
                                "CIS v1.3.0 (Azure)-9.9", 
                                "CIS v1.3.1 (Azure)-9.9", 
                                "CIS v1.4.0 (Azure)-9.9", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03", 
                                "CSA CCM v.4.0.1-DSP-10", 
                                "CSA CCM v.4.0.1-IVS-03", 
                                "CSA CCM v.4.0.1-UEM-11", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.185", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.s", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1", 
                                "ISO/IEC 27002:2013-12.2.1", 
                                "ISO/IEC 27002:2013-12.3.1", 
                                "ISO/IEC 27002:2013-13.1.1", 
                                "ISO/IEC 27002:2013-13.1.2", 
                                "ISO/IEC 27002:2013-13.1.3", 
                                "ISO/IEC 27002:2013-13.2.1", 
                                "ISO/IEC 27002:2013-13.2.3", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.1.3", 
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-8.3.1", 
                                "ISO/IEC 27002:2013-8.3.3", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2", 
                                "ISO/IEC 27017:2015-6.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2", 
                                "ISO/IEC 27018:2019-12.3.1", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Transmission Confidentiality and Integrity | Cryptographic Protection", 
                                "NIST 800-53 Rev4-SC-8 (1)",
                                "NIST CSF", 
                                "NIST CSF-PR.DS-2", 
                                "NIST CSF-PR.DS-5",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.13.8", 
                                "NIST SP 800-172-3.4.1e", 
                                "NIST SP 800-172-3.4.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-2.3", 
                                "PCI DSS v3.2.1-4.1"
                            ],
                            "service": [
                                "Web"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Web App should use the latest version of HTTP",
                    "description": "We recommend you use the latest HTTP version for web apps and take advantage of any security fixes and new functionalities featured. With each software installation you can determine if a given update meets your organization's requirements. Organizations should verify the compatibility and support provided for any additional software, assessing the current version against the update revision being considered."
                },
                {
                    "masterTestId": "PR-AZR-CLD-WEB-006",
                    "type": "rego",
                    "rule": "file(web.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-WEB-006",
                            "eval": "data.rule.web_service_cors_not_allowing_all",
                            "message": "data.rule.web_service_cors_not_allowing_all_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/rest/api/storageservices/cross-origin-resource-sharing--cors--support-for-the-azure-storage-services' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_WEB_006.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Web"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "High",
                    "title": "Ensure CORS configuration is not allowing every resources to access Azure Web Service",
                    "description": "This policy will identify CORS configuration which are allowing every resoruce to access Azure Web service and give alert"
                },
                {
                    "masterTestId": "PR-AZR-CLD-WEB-007",
                    "type": "rego",
                    "rule": "file(web.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-WEB-007",
                            "eval": "data.rule.web_service_http_logging_enabled",
                            "message": "data.rule.web_service_http_logging_enabled_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/app-service/troubleshoot-diagnostic-logs' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_WEB_007.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Web"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Azure Web Service http logging should be enabled",
                    "description": "This policy will identify the Azure Web service which don't have http logging enabled and give alert"
                },
                {
                    "masterTestId": "PR-AZR-CLD-WEB-008",
                    "type": "rego",
                    "rule": "file(web.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-WEB-008",
                            "eval": "data.rule.web_service_detaild_error_message_enabled",
                            "message": "data.rule.web_service_detaild_error_message_enabled_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/app-service/troubleshoot-diagnostic-logs' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_WEB_008.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Web"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Azure Web Service detailed error message should be enabled",
                    "description": "This policy will identify the Azure Web service which doesn't have a detailed error message enabled and give the alert"
                },
                {
                    "masterTestId": "PR-AZR-CLD-WEB-009",
                    "type": "rego",
                    "rule": "file(web.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-WEB-009",
                            "eval": "data.rule.web_service_request_tracing_enabled",
                            "message": "data.rule.web_service_request_tracing_enabled_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/app-service/troubleshoot-diagnostic-logs' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_WEB_009.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Web"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Azure Web Service request tracing should be enabled",
                    "description": "This policy will identify the Azure web service which doesn't have request tracing enabled and give the alert"
                },
                {
                    "masterTestId": "PR-AZR-CLD-WEB-010",
                    "type": "rego",
                    "rule": "file(web.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-WEB-010",
                            "eval": "data.rule.web_service_managed_identity_provider_enabled",
                            "message": "data.rule.web_service_managed_identity_provider_enabled_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_WEB_010.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-IM-1", 
                                "Azure Security Benchmark (v3)-GS-6", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CIS",
                                "CIS v1.1 (Azure)-9.5", 
                                "CIS v1.2.0 (Azure)-9.5", 
                                "CIS v1.3.0 (Azure)-9.5", 
                                "CIS v1.3.1 (Azure)-9.5", 
                                "CIS v1.4.0 (Azure)-9.5", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-DSP-17", 
                                "CSA CCM v.4.0.1-HRS-04", 
                                "CSA CCM v.4.0.1-IAM-01", 
                                "CSA CCM v.4.0.1-IAM-04", 
                                "CSA CCM v.4.0.1-IAM-05", 
                                "CSA CCM v.4.0.1-IAM-09", 
                                "CSA CCM v.4.0.1-IAM-14", 
                                "CSA CCM v.4.0.1-IAM-16", 
                                "CSA CCM v.4.0.1-UEM-13", 
                                "CyberSecurity Law of the People's Republic of China-Article 21", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AM.4.226", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:10.a", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-18.1.4", 
                                "ISO/IEC 27002:2013-5.1.2", 
                                "ISO/IEC 27002:2013-6.1.2", 
                                "ISO/IEC 27002:2013-6.2.1", 
                                "ISO/IEC 27002:2013-6.2.2", 
                                "ISO/IEC 27002:2013-9.1.1", 
                                "ISO/IEC 27002:2013-9.1.2", 
                                "ISO/IEC 27002:2013-9.2.3", 
                                "ISO/IEC 27002:2013-9.2.4", 
                                "ISO/IEC 27002:2013-9.2.5", 
                                "ISO/IEC 27002:2013-9.4.2", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-9.1.2", 
                                "ISO/IEC 27017:2015-9.2.3", 
                                "ISO/IEC 27017:2015-9.2.4", 
                                "ISO/IEC 27017:2015-9.2.5", 
                                "ISO/IEC 27017:2015-9.4.2", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-9.2.3", 
                                "ISO/IEC 27018:2019-9.2.5", 
                                "ISO/IEC 27018:2019-9.4.2", 
                                "NIST CSF",
                                "NIST CSF-PR.AC-3", 
                                "NIST CSF-PR.AC-4", 
                                "NIST CSF-PR.PT-3",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.1.1", 
                                "NIST SP 800-172-3.4.1e", 
                                "NIST SP 800-172-3.4.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-6.3", 
                                "PIPEDA",
                                "PIPEDA-4.7.3"

                            ],
                            "service": [
                                "Web"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Azure Web Service Managed Identity provider should be enabled",
                    "description": "This policy will identify the Azure Web service which doesn't have Managed Identity provider enabled and give the alert"
                },
                {
                    "masterTestId": "PR-AZR-CLD-WEB-011",
                    "type": "rego",
                    "rule": "file(web.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-WEB-011",
                            "eval": "data.rule.web_service_remote_debugging_disabled",
                            "message": "data.rule.web_service_remote_debugging_disabled_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/visualstudio/debugger/remote-debugging-azure?view=vs-2022' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_WEB_011.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15", 
                                "APRA (CPS 234) Information Security-CPS234-16", 
                                "APRA (CPS 234) Information Security-CPS234-17", 
                                "APRA (CPS 234) Information Security-CPS234-21", 
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-DP-4", 
                                "Azure Security Benchmark (v2)-NS-1", 
                                "Azure Security Benchmark (v3)-DP-3", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CIS",
                                "CIS v1.1 (Azure)-9.3", 
                                "CIS v1.2.0 (Azure)-9.3", 
                                "CIS v1.3.0 (Azure)-9.3", 
                                "CIS v1.3.1 (Azure)-9.3", 
                                "CIS v1.4.0 (Azure)-9.3", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03", 
                                "CSA CCM v.4.0.1-DSP-10", 
                                "CSA CCM v.4.0.1-IVS-03", 
                                "CSA CCM v.4.0.1-UEM-11", 
                                "CyberSecurity Law of the People's Republic of China-Article 21", 
                                "CyberSecurity Law of the People's Republic of China-Article 40", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.185", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.s", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1", 
                                "ISO/IEC 27002:2013-12.2.1", 
                                "ISO/IEC 27002:2013-12.3.1", 
                                "ISO/IEC 27002:2013-13.1.1", 
                                "ISO/IEC 27002:2013-13.1.2", 
                                "ISO/IEC 27002:2013-13.1.3", 
                                "ISO/IEC 27002:2013-13.2.1", 
                                "ISO/IEC 27002:2013-13.2.3", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.1.3", 
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-8.3.1", 
                                "ISO/IEC 27002:2013-8.3.3", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2", 
                                "ISO/IEC 27017:2015-6.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2", 
                                "ISO/IEC 27018:2019-12.3.1", 
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1190 - Exploit Public-Facing Application", 
                                "MITRE ATT&CK v6.3-T1190", 
                                "MITRE ATT&CK v8.2-T1190", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Transmission Confidentiality and Integrity | Cryptographic Protection", 
                                "NIST 800-53 Rev4-SC-8 (1)",
                                "NIST CSF", 
                                "NIST CSF-PR.DS-2", 
                                "NIST CSF-PR.DS-5",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.13.8", 
                                "NIST SP 800-172-3.4.1e", 
                                "NIST SP 800-172-3.4.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-2.3", 
                                "PCI DSS v3.2.1-4.1", 
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Web"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Low",
                    "title": "Azure Web Service remote debugging should be disabled",
                    "description": "This policy will identify the Azure web service which has remote debugging enabled and give the alert"
                },
                {
                    "masterTestId": "PR-AZR-CLD-WEB-012",
                    "type": "rego",
                    "rule": "file(web.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-WEB-012",
                            "eval": "data.rule.web_service_ftp_deployment_disabled",
                            "message": "data.rule.web_service_ftp_deployment_disabled_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/app-service/deploy-ftp?tabs=portal' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_WEB_012.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15", 
                                "APRA (CPS 234) Information Security-CPS234-16", 
                                "APRA (CPS 234) Information Security-CPS234-17", 
                                "APRA (CPS 234) Information Security-CPS234-21", 
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-DP-4", 
                                "Azure Security Benchmark (v2)-NS-1", 
                                "Azure Security Benchmark (v3)-DP-3", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CIS",
                                "CIS v1.1 (Azure)-9.3", 
                                "CIS v1.2.0 (Azure)-9.3", 
                                "CIS v1.3.0 (Azure)-9.3", 
                                "CIS v1.3.1 (Azure)-9.3", 
                                "CIS v1.4.0 (Azure)-9.3", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03", 
                                "CSA CCM v.4.0.1-DSP-10", 
                                "CSA CCM v.4.0.1-IVS-03", 
                                "CSA CCM v.4.0.1-UEM-11", 
                                "CyberSecurity Law of the People's Republic of China-Article 21", 
                                "CyberSecurity Law of the People's Republic of China-Article 40", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.185", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.s", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1", 
                                "ISO/IEC 27002:2013-12.2.1", 
                                "ISO/IEC 27002:2013-12.3.1", 
                                "ISO/IEC 27002:2013-13.1.1", 
                                "ISO/IEC 27002:2013-13.1.2", 
                                "ISO/IEC 27002:2013-13.1.3", 
                                "ISO/IEC 27002:2013-13.2.1", 
                                "ISO/IEC 27002:2013-13.2.3", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.1.3", 
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-8.3.1", 
                                "ISO/IEC 27002:2013-8.3.3", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2", 
                                "ISO/IEC 27017:2015-6.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2", 
                                "ISO/IEC 27018:2019-12.3.1", 
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1190 - Exploit Public-Facing Application", 
                                "MITRE ATT&CK v6.3-T1190", 
                                "MITRE ATT&CK v8.2-T1190", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Transmission Confidentiality and Integrity | Cryptographic Protection", 
                                "NIST 800-53 Rev4-SC-8 (1)",
                                "NIST CSF", 
                                "NIST CSF-PR.DS-2", 
                                "NIST CSF-PR.DS-5",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.13.8", 
                                "NIST SP 800-172-3.4.1e", 
                                "NIST SP 800-172-3.4.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-2.3", 
                                "PCI DSS v3.2.1-4.1", 
                                "PIPEDA",
                                "PIPEDA-4.7.3"

                            ],
                            "service": [
                                "Web"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Azure Web Service FTP deployments should be disabled",
                    "description": "This policy will identify the Azure web service which has FTP deployment enabled and gives the alert"
                },
                {
                    "masterTestId": "PR-AZR-CLD-WEB-013",
                    "type": "rego",
                    "rule": "file(web.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-WEB-013",
                            "eval": "data.rule.web_service_net_framework_latest",
                            "message": "data.rule.web_service_net_framework_latest_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/app-service/configure-language-dotnet-framework' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_WEB_013.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Web"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Azure Web Service Dot Net Framework should be latest",
                    "description": "This policy will identify the Azure web service which doesn't have the latest version of Net Framework and give the alert"
                },
                {
                    "masterTestId": "PR-AZR-CLD-WEB-014",
                    "type": "rego",
                    "rule": "file(web.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-WEB-014",
                            "eval": "data.rule.web_service_php_version_latest",
                            "message": "data.rule.web_service_php_version_latest_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/app-service/configure-language-php?pivots=platform-linux' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_WEB_014.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-PV-3", 
                                "Azure Security Benchmark (v2)-PV-7", 
                                "Azure Security Benchmark (v3)-AM-2", 
                                "Azure Security Benchmark (v3)-AM-5", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CIS",
                                "CIS v1.1 (Azure)-9.9", 
                                "CIS v1.2.0 (Azure)-9.9", 
                                "CIS v1.3.0 (Azure)-9.8", 
                                "CIS v1.3.1 (Azure)-9.8", 
                                "CIS v1.4.0 (Azure)-9.8", 
                                "CyberSecurity Law of the People's Republic of China-Article 25", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-RM.4.148", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:10.a", 
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1190 - Exploit Public-Facing Application", 
                                "MITRE ATT&CK v6.3-T1190", 
                                "MITRE ATT&CK v8.2-T1190", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Flaw Remediation | Removal of Previous Versions of Software and Firmware", 
                                "NIST 800-53 Rev4-SI-2 (6)", 
                                "NIST CSF",
                                "NIST CSF-DE.CM-3",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.4.9", 
                                "NIST SP 800-172-3.4.1e", 
                                "NIST SP 800-172-3.4.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-6.3", 
                                "PIPEDA",
                                "PIPEDA-4.7.3"

                            ],
                            "service": [
                                "Web"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Azure Web Service PHP version should be latest",
                    "description": "This policy will identify the Azure web service which doesn't have the latest version of PHP and give the alert"
                },
                {
                    "masterTestId": "PR-AZR-CLD-WEB-015",
                    "type": "rego",
                    "rule": "file(web.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-WEB-015",
                            "eval": "data.rule.web_service_python_version_latest",
                            "message": "data.rule.web_service_python_version_latest_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/app-service/configure-language-python' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_WEB_015.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-PV-3", 
                                "Azure Security Benchmark (v2)-PV-7", 
                                "Azure Security Benchmark (v3)-AM-2", 
                                "Azure Security Benchmark (v3)-AM-5", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CIS",
                                "CIS v1.1 (Azure)-9.9", 
                                "CIS v1.2.0 (Azure)-9.9", 
                                "CIS v1.3.0 (Azure)-9.8", 
                                "CIS v1.3.1 (Azure)-9.8", 
                                "CIS v1.4.0 (Azure)-9.8", 
                                "CyberSecurity Law of the People's Republic of China-Article 25", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-RM.4.148", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:10.a", 
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1190 - Exploit Public-Facing Application", 
                                "MITRE ATT&CK v6.3-T1190", 
                                "MITRE ATT&CK v8.2-T1190", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Flaw Remediation | Removal of Previous Versions of Software and Firmware", 
                                "NIST 800-53 Rev4-SI-2 (6)",
                                "NIST CSF", 
                                "NIST CSF-DE.CM-3",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.4.9", 
                                "NIST SP 800-172-3.4.1e", 
                                "NIST SP 800-172-3.4.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-6.3", 
                                "PIPEDA",
                                "PIPEDA-4.7.3"

                            ],
                            "service": [
                                "Web"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Azure Web Service Python version should be latest",
                    "description": "This policy will identify the Azure web service which doesn't have the latest version of Python and give the alert"
                },  
                {
                    "masterTestId": "PR-AZR-CLD-WEB-016",
                    "type": "rego",
                    "rule": "file(web.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-WEB-016",
                            "eval": "data.rule.web_service_java_version_latest",
                            "message": "data.rule.web_service_java_version_latest_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/app-service/configure-language-java?pivots=platform-linux' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_WEB_016.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-PV-3", 
                                "Azure Security Benchmark (v2)-PV-7", 
                                "Azure Security Benchmark (v3)-AM-2", 
                                "Azure Security Benchmark (v3)-AM-5", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CIS",
                                "CIS v1.1 (Azure)-9.9", 
                                "CIS v1.2.0 (Azure)-9.9", 
                                "CIS v1.3.0 (Azure)-9.8", 
                                "CIS v1.3.1 (Azure)-9.8", 
                                "CIS v1.4.0 (Azure)-9.8", 
                                "CyberSecurity Law of the People's Republic of China-Article 25", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-RM.4.148", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:10.a", 
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1190 - Exploit Public-Facing Application", 
                                "MITRE ATT&CK v6.3-T1190", 
                                "MITRE ATT&CK v8.2-T1190", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Flaw Remediation | Removal of Previous Versions of Software and Firmware", 
                                "NIST 800-53 Rev4-SI-2 (6)",
                                "NIST CSF", 
                                "NIST CSF-DE.CM-3",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.4.9", 
                                "NIST SP 800-172-3.4.1e", 
                                "NIST SP 800-172-3.4.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-6.3", 
                                "PIPEDA",
                                "PIPEDA-4.7.3"

                            ],
                            "service": [
                                "Web"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Azure Web Service Java version should be latest",
                    "description": "This policy will identify the Azure web service which doesn't have the latest version of Java and give the alert"
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-001",
                    "type": "rego",
                    "rule": "file(dbadministrators.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-001",
                            "eval": "data.rule.sql_server_ad_admin",
                            "message": "data.rule.sql_server_ad_admin_err",
                            "remediationDescription": "In Azure Portal<br>1. Go to SQL servers<br>2. For each SQL server, click on Active Directory admin<br>3. Click on Set admin<br>4. Select an admin<br>5. Click Save<br><br>Default Value:<br>Azure Active Directory Authentication for SQL Database/Server is not enabled by default<br>References:<br><a href='https://docs.microsoft.com/en-us/azure/sql-database/sql-database-aad-authentication-configure' target='_blank'>1. https://docs.microsoft.com/en-us/azure/sql-database/sql-database-aad-authentication-configure</a><br><a href='https://docs.microsoft.com/en-us/azure/sql-database/sql-database-aad-authentication' target='_blank'>2. https://docs.microsoft.com/en-us/azure/sql-database/sql-database-aad-authentication</a>",
                            "remediationFunction": "PR_AZR_CLD_SQL_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15",
                                "APRA (CPS 234) Information Security-CPS234-16",
                                "APRA (CPS 234) Information Security-CPS234-17",
                                "APRA (CPS 234) Information Security-CPS234-21",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-IM-1",
                                "Azure Security Benchmark (v2)-PA-1",
                                "Azure Security Benchmark (v3)-GS-6",
                                "Brazilian Data Protection Law (LGPD)-Article 46",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CIS",
                                "CIS v1.1 (Azure)-4.19",
                                "CIS v1.1 (Azure)-4.8",
                                "CIS v1.2.0 (Azure)-4.4",
                                "CIS v1.3.0 (Azure)-4.4",
                                "CIS v1.3.1 (Azure)-4.4",
                                "CIS v1.4.0 (Azure)-4.5",
                                "CSA CCM",
                                "CSA CCM v3.0.1-DCS-01",
                                "CSA CCM v3.0.1-DSI-06",
                                "CSA CCM v3.0.1-EKM-01",
                                "CSA CCM v3.0.1-IAM-01",
                                "CSA CCM v3.0.1-IAM-02",
                                "CSA CCM v3.0.1-IAM-03",
                                "CSA CCM v3.0.1-IAM-04",
                                "CSA CCM v3.0.1-IAM-05",
                                "CSA CCM v3.0.1-IAM-08",
                                "CSA CCM v3.0.1-IAM-09",
                                "CSA CCM v3.0.1-IAM-10",
                                "CSA CCM v3.0.1-IAM-11",
                                "CSA CCM v3.0.1-IAM-12",
                                "CSA CCM v3.0.1-IAM-13",
                                "CSA CCM v3.0.1-IVS-02",
                                "CSA CCM v3.0.1-IVS-11",
                                "CSA CCM v3.0.1-MOS-09",
                                "CSA CCM v3.0.1-MOS-16",
                                "CyberSecurity Law of the People's Republic of China-Article 24",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.181",
                                "HITRUST",
                                "HITRUST CSF v9.3-Control Reference:01.b",
                                "HITRUST CSF v9.3-Control Reference:01.d",
                                "HITRUST CSF v9.3-Control Reference:01.f",
                                "HITRUST CSF v9.3-Control Reference:01.q",
                                "HITRUST CSF v9.3-Control Reference:01.r",
                                "ISO 27001:2013",
                                "ISO 27001:2013-A.14.1.3",
                                "ISO 27001:2013-A.9.2.5",
                                "NIST 800",
                                "NIST 800-53 Rev4-AC-2 (7)(a)",
                                "NIST 800-53 Rev4-CM-8 (4)",
                                "NIST 800-53 Rev4-IA-5d",
                                "NIST CSF",
                                "NIST CSF-PR.AC-1",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.4.2",
                                "NIST SP 800-172-3.1.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-8.7",
                                "PIPEDA",
                                "PIPEDA-4.7.3",
                                "SOC 2",
                                "SOC 2-CC6.1",
                                "SOC 2-CC6.2",
                                "SOC 2-CC6.3",
                                "SOC 2-CC8.1"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "Medium",
                    "title": "SQL servers should be integrated with Azure Active Directory for administration",
                    "description": "Checks to ensure that SQL servers are configured with Active Directory admin authentication. Azure Active Directory (Azure AD) authentication is a mechanism for connecting to Azure SQL Database, Azure SQL Managed Instance, and Synapse SQL in Azure Synapse Analytics by using identities in Azure AD. With Azure AD authentication, you can centrally manage the identities of database users and other Microsoft services in one central location. Central ID management provides a single place to manage database users and simplifies permission management."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-003",
                    "type": "rego",
                    "rule": "file(dbadministrators.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-003",
                            "eval": "data.rule.sql_managedinstances_ad_admin",
                            "message": "data.rule.sql_managedinstances_ad_admin_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/azure-sql/managed-instance/aad-security-configure-tutorial' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_SQL_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA-CCM",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_401"
                    ],
                    "severity": "Medium",
                    "title": "SQL managedInstances should be integrated with Azure Active Directory for administration",
                    "description": "Checks to ensure that SQL managedInstances are configured with Active Directory admin authentication. Azure Active Directory (Azure AD) authentication is a mechanism for connecting to Azure SQL Database, Azure SQL Managed Instance, and Synapse SQL in Azure Synapse Analytics by using identities in Azure AD. With Azure AD authentication, you can centrally manage the identities of database users and other Microsoft services in one central location. Central ID management provides a single place to manage database users and simplifies permission management."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-004",
                    "type": "rego",
                    "rule": "file(dbauditingsettings.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-004",
                            "eval": "data.rule.sql_db_log_audit",
                            "message": "data.rule.sql_db_log_audit_err",
                            "remediationDescription": "In Azure Portal<br>1. Go to SQL databases<br>2. For each DB instance<br>3. Click on Auditing & Threat Detection<br>4. Set Threat Detection to On<br><br>Default Value:<br>By default, Threat Detection is set to Off.<br><br>References:<br><a href='https://docs.microsoft.com/en-us/azure/sql-database/sql-database-threat-detection' target='_blank'>https://docs.microsoft.com/en-us/azure/sql-database/sql-database-threat-detection</a>",
                            "remediationFunction": "PR_AZR_CLD_SQL_004.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Brazilian Data Protection Law (LGPD)-Article 31",
                                "Brazilian Data Protection Law (LGPD)-Article 48",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CSA CCM",
                                "CSA CCM v3.0.1-CCC-04",
                                "CSA CCM v3.0.1-IAM-03",
                                "CSA CCM v3.0.1-IAM-06",
                                "CyberSecurity Law of the People's Republic of China-Article 55",
                                "CyberSecurity Law of the People's Republic of China-Article 56",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AU.3.046",
                                "GDPR-Article 30",
                                "HIPAA",
                                "HIPAA-164.312(b)",
                                "HITRUST",
                                "HITRUST CSF v9.3-Control Reference:01.s",
                                "HITRUST CSF v9.3-Control Reference:06.i",
                                "HITRUST CSF v9.3-Control Reference:09.aa",
                                "HITRUST CSF v9.3-Control Reference:09.ab",
                                "HITRUST CSF v9.3-Control Reference:09.ad",
                                "HITRUST CSF v9.3-Control Reference:09.ae",
                                "HITRUST CSF v9.3-Control Reference:10.k",
                                "ISO 27001:2013",
                                "ISO 27001:2013-A.12.4.2",
                                "ISO 27001:2013-A.18.1.3",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1562.008 - Impair Defenses:Disable Cloud Logs",
                                "NIST 800",
                                "NIST 800-53 Rev4-AU-2a",
                                "NIST 800-53 Rev4-CM-5 (1)",
                                "NIST 800-53 Rev4-SI-7 (8)",
                                "NIST CSF",
                                "NIST CSF-PR.PT-1",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.3.4",
                                "NIST SP 800-172-3.14.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-10.3",
                                "PIPEDA",
                                "PIPEDA-4.1.4",
                                "SOC 2",
                                "SOC 2-CC6.1",
                                "SOC 2-CC8.1"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "Medium",
                    "title": "Auditing for SQL database should be enabled",
                    "description": "Database events are tracked by the Auditing feature and the events are written to an audit log in your Azure storage account. This process helps you to monitor database activity, and get insight into anomalies that could indicate business concerns or suspected security violations."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-006",
                    "type": "rego",
                    "rule": "file(dbauditingsettings.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-006",
                            "eval": "data.rule.sql_db_log_retention",
                            "message": "data.rule.sql_db_log_retention_err",
                            "remediationDescription": "To change the policy using the Azure Portal, follow these steps:<br><br>1. Log in to the Azure Portal at https://portal.azure.com.<br>2. Navigate to SQL Databases.<br>2. For each server instance:<br>a) Click Auditing.<br>b) Select Storage Details.<br>c) Set Retention (days) to greater than 90 days.<br>d) Click OK.<br>e) Click Save",
                            "remediationFunction": "PR_AZR_CLD_SQL_006.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "Medium",
                    "title": "Azure SQL Database Auditing Retention should be 90 days or more",
                    "description": "This policy identifies SQL Databases that have Auditing Retention of fewer than 90 days. Audit Logs can be used to check for anomalies and give insight into suspected breaches or misuse of information and access. It is recommended to configure SQL database Audit Retention to be greater than or equal to 90 days."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-009",
                    "type": "rego",
                    "rule": "file(dbdataencryption.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-009",
                            "eval": "data.rule.db_encrypt",
                            "message": "data.rule.db_encrypt_err",
                            "remediationDescription": "1. Go to 'SQL databases' and choose your database<br>2. Select 'Transparent data encryption' under 'Security' in the navigation menu<br>3. Set 'Data encryption' to 'On'<br>4. Save",
                            "remediationFunction": "PR_AZR_CLD_SQL_009.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "Medium",
                    "title": "Azure SQL databases should have transparent data encryption enabled",
                    "description": "Transparent data encryption protects Azure database against malicious activity. It performs real-time encryption and decryption of the database, related reinforcements, and exchanges log records without requiring any changes to the application. It encrypts the storage of the entire database by using a symmetric key called the database encryption key."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-011",
                    "type": "rego",
                    "rule": "file(dbfirewallrules.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-011",
                            "eval": "data.rule.db_firewall",
                            "message": "data.rule.db_firewall_err",
                            "remediationDescription": "1. Log in to the Azure Portal at https://portal.azure.com.<br>2. Navigate to SQL servers.<br>3. For each SQL server:<br>a) Click Firewall / Virtual Networks.<br>b) Set Allow access to Azure services to OFF.<br>c) Set firewall rules to limit access to authorized connections.",
                            "remediationFunction": "PR_AZR_CLD_SQL_011.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-07",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-DSP-17",
                                "CSA CCM v.4.0.1-HRS-04",
                                "CSA CCM v.4.0.1-IVS-03",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CSA CCM v.4.0.1-STA-14",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-05",
                                "CSA CCM v.4.0.1-UEM-11",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.n",
                                "HITRUST v.9.4.2-Control Reference:01.o",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-12.6.2",
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2",
                                "ISO/IEC 27002:2013-13.1.3",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-14.2.5",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-18.1.4",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-6.2.2",
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1",
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-16.1.2",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2",
                                "ISO/IEC 27018:2019-12.3.1",
                                "ISO/IEC 27018:2019-18.2.1",
                                "NIST CSF",
                                "NIST CSF-DE.AE-2",
                                "NIST CSF-DE.CM-6",
                                "NIST CSF-DE.CM-7",
                                "NIST CSF-DE.DP-2",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-PR.AC-5",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5",
                                "NIST CSF-PR.PT-4",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6",
                                "NIST SP 800-171 Revision 2-3.14.6",
                                "NIST SP 800-172-3.14.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "Medium",
                    "title": "SQL Server Firewall rules should not configure to allow full inbound access to everyone",
                    "description": "Firewalls grant access to databases based on the originating IP address of each request and should be within the range of START IP and END IP. Firewall settings with START IP and END IP both with \"0.0.0.0\" represents access to all Azure internal network. This setting needs to be turned-off to remove blanket access."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-012",
                    "type": "rego",
                    "rule": "file(dbforMariaDB.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-012",
                            "eval": "data.rule.maria_ingress_from_any_ip_disabled",
                            "message": "data.rule.maria_ingress_from_any_ip_disabled_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/mariadb/concepts-firewall-rules' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_SQL_012.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_409"
                    ],
                    "severity": "High",
                    "title": "MariaDB should not allow ingress from all Azure-internal IP addresses (0.0.0.0/0)",
                    "description": "This policy will identify MariaDB firewall rule that are currently allowing ingress from all Azure-internal IP addresses"
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-014",
                    "type": "rego",
                    "rule": "file(dbforMySQL_firewallrules.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-014",
                            "eval": "data.rule.mysql_ingress_from_any_ip_disabled",
                            "message": "data.rule.mysql_ingress_from_any_ip_disabled_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/mysql/concepts-firewall-rules' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_SQL_014.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15", 
                                "APRA (CPS 234) Information Security-CPS234-16", 
                                "APRA (CPS 234) Information Security-CPS234-17", 
                                "APRA (CPS 234) Information Security-CPS234-21", 
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Azure Security Benchmark", 
                                "Azure Security Benchmark (v2)-DP-4", 
                                "Azure Security Benchmark (v3)-DP-3", 
                                "CIS",
                                "CIS v1.1 (Azure)-4.11", 
                                "CIS v1.2.0 (Azure)-4.3.2", 
                                "CIS v1.3.0 (Azure)-4.3.2", 
                                "CIS v1.3.1 (Azure)-4.3.2", 
                                "CIS v1.4.0 (Azure)-4.4.1", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03", 
                                "CSA CCM v.4.0.1-DSP-10", 
                                "CSA CCM v.4.0.1-IVS-03", 
                                "CSA CCM v.4.0.1-UEM-11", 
                                "CyberSecurity Law of the People's Republic of China-Article 21", 
                                "CyberSecurity Law of the People's Republic of China-Article 40", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.s, ISO/IEC 27002:2013-10.1.1", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.2.1", 
                                "ISO/IEC 27002:2013-12.3.1", 
                                "ISO/IEC 27002:2013-13.1.1", 
                                "ISO/IEC 27002:2013-13.1.2", 
                                "ISO/IEC 27002:2013-13.1.3", 
                                "ISO/IEC 27002:2013-13.2.1", 
                                "ISO/IEC 27002:2013-13.2.3", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.1.3", 
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-8.3.1", 
                                "ISO/IEC 27002:2013-8.3.3", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2", 
                                "ISO/IEC 27017:2015-6.1.1", 
                                "ISO/IEC 27018:2019-10.1.2", 
                                "ISO/IEC 27018:2019-12.3.1", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Transmission Confidentiality and Integrity | Cryptographic Protection", 
                                "NIST 800-53 Rev4-SC-8 (1)", 
                                "NIST CSF",
                                "NIST CSF-PR.DS-2", 
                                "NIST CSF-PR.DS-5", 
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.8", 
                                "NIST SP 800-172-3.1.3e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-2.3", 
                                "PCI DSS v3.2.1-4.1"
                            ],
                             "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_411"
                    ],
                    "severity": "High",
                    "title": "MySQL Database Server should not allow ingress from all Azure-internal IP addresses (0.0.0.0/0)",
                    "description": "This policy will identify MySQL Database Server firewall rule that is currently allowing ingress from all Azure-internal IP addresses"
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-016",
                    "type": "rego",
                    "rule": "file(dbforMySQL.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-016",
                            "eval": "data.rule.ssl_enforcement",
                            "message": "data.rule.ssl_enforcement_err",
                            "remediationDescription": "Using the Azure portal, visit your Azure Database for MySQL server, and then click Connection security. Use the toggle button to enable or disable the Enforce SSL connection setting, and then click Save. Microsoft recommends to always enable the Enforce SSL connection setting for enhanced security.",
                            "remediationFunction": "PR_AZR_CLD_SQL_016.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15", 
                                "APRA (CPS 234) Information Security-CPS234-16", 
                                "APRA (CPS 234) Information Security-CPS234-17", 
                                "APRA (CPS 234) Information Security-CPS234-21", 
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-DP-4", 
                                "Azure Security Benchmark (v3)-DP-3", 
                                "CIS",
                                "CIS v1.1 (Azure)-4.11", 
                                "CIS v1.2.0 (Azure)-4.3.2", 
                                "CIS v1.3.0 (Azure)-4.3.2", 
                                "CIS v1.3.1 (Azure)-4.3.2", 
                                "CIS v1.4.0 (Azure)-4.4.1", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03", 
                                "CSA CCM v.4.0.1-DSP-10", 
                                "CSA CCM v.4.0.1-IVS-03", 
                                "CSA CCM v.4.0.1-UEM-11", 
                                "CyberSecurity Law of the People's Republic of China-Article 21", 
                                "CyberSecurity Law of the People's Republic of China-Article 40", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.s", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1", 
                                "ISO/IEC 27002:2013-12.2.1", 
                                "ISO/IEC 27002:2013-12.3.1", 
                                "ISO/IEC 27002:2013-13.1.1", 
                                "ISO/IEC 27002:2013-13.1.2", 
                                "ISO/IEC 27002:2013-13.1.3", 
                                "ISO/IEC 27002:2013-13.2.1", 
                                "ISO/IEC 27002:2013-13.2.3", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.1.3", 
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-8.3.1", 
                                "ISO/IEC 27002:2013-8.3.3", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2", 
                                "ISO/IEC 27017:2015-6.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2", 
                                "ISO/IEC 27018:2019-12.3.1", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Transmission Confidentiality and Integrity | Cryptographic Protection", 
                                "NIST 800-53 Rev4-SC-8 (1)", 
                                "NIST CSF",
                                "NIST CSF-PR.DS-2", 
                                "NIST CSF-PR.DS-5", 
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.8", 
                                "NIST SP 800-172-3.1.3e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-2.3", 
                                "PCI DSS v3.2.1-4.1"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_411"
                    ],
                    "severity": "Medium",
                    "title": "Ensure ssl enforcement is enabled on MySQL server Database Server.",
                    "description": "Enable SSL connection on MySQL Servers databases. Rationale: SSL connectivity helps to provide a new layer of security, by connecting database server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between database server and client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and application."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-017",
                    "type": "rego",
                    "rule": "file(dbsecurityalertpolicies.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-017",
                            "eval": "data.rule.dbsec_threat_off",
                            "message": "data.rule.dbsec_threat_off_err",
                            "remediationDescription": "If Azure Defender is enabled at server level it will also be applied to all the database, regardless of the database Azure Defender settings. It is recommended that you enable only server-level Azure Defender settings. To enable auditing at server level: Log in to the Azure Portal. Note down the reported SQL database and SQL server. Select 'SQL servers', Click on the SQL server instance you wanted to modify. Click on 'Security Center' under 'Security'. Click on 'Enable Azure Defender for SQL'. It is recommended to avoid enabling Azure Defender in both server and database. If you want to enable different storage account, email addresses for scan and alert notifications or 'Advanced Threat Protection types' for a specific database that differ from the rest of the databases on the server. Then to enable auditing at database level by: Log in to the Azure Portal. Note down the reported SQL database. Select 'SQL databases', Click on the SQL database instance you wanted to modify. Click on 'Security Center' under 'Security'. Click on 'Enable Azure Defender for SQL'",
                            "remediationFunction": "PR_AZR_CLD_SQL_017.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "APRA (CPS 234) Information Security-CPS234-35",
                                "APRA (CPS 234) Information Security-CPS234-36",
                                "Brazilian Data Protection Law (LGPD)-Article 31",
                                "Brazilian Data Protection Law (LGPD)-Article 48",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-AIS-01",
                                "CSA CCM v.4.0.1-AIS-02",
                                "CSA CCM v.4.0.1-AIS-04",
                                "CSA CCM v.4.0.1-CCC-01",
                                "CSA CCM v.4.0.1-DSP-01",
                                "CSA CCM v.4.0.1-DSP-04",
                                "CSA CCM v.4.0.1-GRC-03",
                                "CSA CCM v.4.0.1-IVS-04",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-06",
                                "CyberSecurity Law of the People's Republic of China-Article 55",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-RM.4.150",
                                "ISO 27001:2013",
                                "ISO 27001:2013-A.14.1.2",
                                "ISO 27001:2013-A.16.1.4",
                                "ISO 27001:2013-A.18.1.3",
                                "ISO 27001:2013-A.8.2.3",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.1.1",
                                "ISO/IEC 27002:2013-12.1.2",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.2.1",
                                "ISO/IEC 27002:2013-14.2.2",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-5.1.2",
                                "ISO/IEC 27002:2013-8.2.1",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.1.2",
                                "ISO/IEC 27017:2015-14.1.1",
                                "ISO/IEC 27017:2015-14.1.2",
                                "ISO/IEC 27017:2015-14.2.1",
                                "ISO/IEC 27017:2015-14.2.5",
                                "ISO/IEC 27017:2015-5.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-12.1.2",
                                "ISO/IEC 27018:2019-18.2.1",
                                "NIST 800",
                                "NIST 800-53 Rev4-SA-11 (2)",
                                "NIST 800-53 Rev4-SA-15 (4)",
                                "NIST CSF",
                                "NIST CSF-DE.AE-4",
                                "NIST CSF-DE.CM-8",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-ID.RA-3",
                                "NIST CSF-ID.RA-4",
                                "NIST CSF-ID.RA-5",
                                "NIST CSF-PR.IP-1",
                                "NIST CSF-RS.AN-2",
                                "NIST CSF-RS.MI-3",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.11.1",
                                "NIST SP 800-171 Revision 2-3.11.2",
                                "NIST SP 800-172-3.4.1e",
                                "NIST SP 800-172-3.4.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-2.2",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_263"
                    ],
                    "severity": "High",
                    "title": "SQL Databases should have security alert policies enabled",
                    "description": "SQL Threat Detection provides a new layer of security, which enables customers to detect and respond to potential threats as they occur by providing security alerts on anomalous activities. Users will receive an alert upon suspicious database activities, potential vulnerabilities, and SQL injection attacks, as well as anomalous database access patterns. SQL Threat Detection alerts provide details of suspicious activity and recommend action on how to investigate and mitigate the threat."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-019",
                    "type": "rego",
                    "rule": "file(dbsecurityalertpolicies.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-019",
                            "eval": "data.rule.dbsec_threat_email",
                            "message": "data.rule.dbsec_threat_email_err",
                            "remediationDescription": "Login to Azure Portal. Go to SQL Databases (Left Panel). Choose the reported each DB instance. Click on Auditing & Threat Detection (under 'SETTINGS'). Set Auditing to 'ON'. Set Threat Detection to 'ON'. Set 'Send alerts to' field with a valid email address. Click on save",
                            "remediationFunction": "PR_AZR_CLD_SQL_019.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "APRA (CPS 234) Information Security-CPS234-35",
                                "APRA (CPS 234) Information Security-CPS234-36",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-AIS-01",
                                "CSA CCM v.4.0.1-AIS-02",
                                "CSA CCM v.4.0.1-AIS-04",
                                "CSA CCM v.4.0.1-CCC-01",
                                "CSA CCM v.4.0.1-GRC-03",
                                "CSA CCM v.4.0.1-IVS-04",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-02",
                                "CSA CCM v.4.0.1-TVM-04",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-06",
                                "CSA CCM v.4.0.1-UEM-09",
                                "CSA CCM v3.0.1-IAM-07",
                                "CyberSecurity Law of the People's Republic of China-Article 55",
                                "CyberSecurity Law of the People's Republic of China-Article 56",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-CM.2.062",
                                "HIPAA",
                                "HIPAA-164.312(b)",
                                "HITRUST",
                                "HITRUST CSF v9.3-Control Reference:09.ab",
                                "HITRUST CSF v9.3-Control Reference:09.ae",
                                "ISO 27001:2013",
                                "ISO 27001:2013-A.16.1.2",
                                "ISO 27001:2013-A.18.1.3",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.1.2",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.2.1",
                                "ISO/IEC 27002:2013-14.2.2",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-5.1.2",
                                "ISO/IEC 27002:2013-6.2.1",
                                "ISO/IEC 27002:2013-6.2.2",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.1.2",
                                "ISO/IEC 27017:2015-12.2.1",
                                "ISO/IEC 27017:2015-14.1.1",
                                "ISO/IEC 27017:2015-14.1.2",
                                "ISO/IEC 27017:2015-14.2.1",
                                "ISO/IEC 27017:2015-14.2.5",
                                "ISO/IEC 27017:2015-5.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-12.1.2",
                                "ISO/IEC 27018:2019-18.2.1",
                                "NIST 800",
                                "NIST 800-53 Rev4-AU-5 (2)",
                                "NIST 800-53 Rev4-IR-9 (1)",
                                "NIST 800-53 Rev4-SI-4 (5)",
                                "NIST CSF",
                                "NIST CSF-DE.CM-4",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-ID.RA-2",
                                "NIST CSF-ID.RA-3",
                                "NIST CSF-PR.IP-1",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.1.9",
                                "NIST SP 800-171 Revision 2-3.14.3",
                                "NIST SP 800-172-3.4.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-11.5",
                                "SOC 2",
                                "SOC 2-CC6.1",
                                "SOC 2-CC6.6",
                                "SOC 2-CC6.7"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_263"
                    ],
                    "severity": "Medium",
                    "title": "Azure SQL Databases Security Alert Policy should be configured to send alert to the account administrators and configured email addresses",
                    "description": "Checks to ensure that an valid email address is set for Threat Detection alerts. The alerts are sent to this email address when any anomalous activities are detected on SQL databases."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-020",
                    "type": "rego",
                    "rule": "file(dbsecurityalertpolicies.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-020",
                            "eval": "data.rule.dbsec_threat_alert",
                            "message": "data.rule.dbsec_threat_alert_err",
                            "remediationDescription": "Login to Azure Portal. Go to SQL databases. For each DB instance. Click on Auditing & Threat Detection. Set Threat Detection types to All. Note: In order to Set Threat Detection types to All, Make sure Auditing is set to On.",
                            "remediationFunction": "PR_AZR_CLD_SQL_020.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "APRA (CPS 234) Information Security-CPS234-35",
                                "APRA (CPS 234) Information Security-CPS234-36",
                                "Brazilian Data Protection Law (LGPD)-Article 31",
                                "Brazilian Data Protection Law (LGPD)-Article 48",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CSA CCM",
                                "CSA CCM v3.0.1-BCR-05",
                                "CSA CCM v3.0.1-BCR-09",
                                "CSA CCM v3.0.1-GRM-02",
                                "CSA CCM v3.0.1-GRM-09",
                                "CSA CCM v3.0.1-GRM-10",
                                "CSA CCM v3.0.1-STA-06",
                                "CyberSecurity Law of the People's Republic of China-Article 55",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-RM.4.149",
                                "HITRUST",
                                "HITRUST CSF v9.3-Control Reference:03.b",
                                "HITRUST CSF v9.3-Control Reference:03.d",
                                "HITRUST CSF v9.3-Control Reference:12.b",
                                "ISO 27001:2013",
                                "ISO 27001:2013-A.14.1.2",
                                "ISO 27001:2013-A.16.1.4",
                                "ISO 27001:2013-A.18.1.3",
                                "ISO 27001:2013-A.8.2.3",
                                "NIST 800",
                                "NIST 800-53 Rev4-RA-3e",
                                "NIST 800-53 Rev4-SA-11 (2)",
                                "NIST CSF",
                                "NIST CSF-DE.AE-4",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-ID.RA-3",
                                "NIST CSF-ID.RA-4",
                                "NIST CSF-ID.RA-5",
                                "NIST CSF-PR.IP-12",
                                "NIST CSF-RS.MI-3",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.11.1",
                                "NIST SP 800-171 Revision 2-3.11.2",
                                "NIST SP 800-172-3.4.1e",
                                "NIST SP 800-172-3.4.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-2.2",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_263"
                    ],
                    "severity": "Medium",
                    "title": "Azure SQL database threat detection alerts should be enabled for all threat types",
                    "description": "Advanced data security (ADS) provides a set of advanced SQL security capabilities, including vulnerability assessment, threat detection, and data discovery and classification.<br><br>This policy identifies Azure SQL servers that have disabled the detection of one or more threat types. To protect your SQL Servers, as a best practice, enable ADS detection for all types of threats."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-021",
                    "type": "rego",
                    "rule": "file(dbsecurityalertpolicies.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-021",
                            "eval": "data.rule.sql_alert",
                            "message": "data.rule.sql_alert_err",
                            "remediationDescription": "Log in to Azure Portal. Go to SQL databases (Left Panel). Choose the reported each DB instance. Under Security section, Click on 'Advanced Threat Protection'. Click on Settings. Select 'Enable Advanced Threat Protection at the database level'. Click on 'Threat Detection settings for this database'. On 'Send alerts to' textbox provide email ID on which you would like to receive alert notifications and Click on the checkbox of 'Email service and co-administrators'. Click on 'Ok' for Threat Detection database settings. Click on 'Save'",
                            "remediationFunction": "PR_AZR_CLD_SQL_021.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "APRA (CPS 234) Information Security-CPS234-35", 
                                "APRA (CPS 234) Information Security-CPS234-36", 
                                "LGPD",
                                "Brazilian Data Protection Law (LGPD)-Article 46", 
                                "Brazilian Data Protection Law (LGPD)-Article 6", 
                                "CSA CCM",
                                "CSA CCM v3.0.1-AAC-01", 
                                "CSA CCM v3.0.1-AAC-02", 
                                "CSA CCM v3.0.1-BCR-01", 
                                "CSA CCM v3.0.1-BCR-09", 
                                "CSA CCM v3.0.1-CCC-04", 
                                "CSA CCM v3.0.1-DCS-01", 
                                "CSA CCM v3.0.1-IAM-07", 
                                "CSA CCM v3.0.1-SEF-01", 
                                "CSA CCM v3.0.1-SEF-03", 
                                "CSA CCM v3.0.1-STA-02", 
                                "CyberSecurity Law of the People's Republic of China-Article 55", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AC.1.004", 
                                "GDPR",
                                "GDPR-Article 30", 
                                "GDPR-Article 32", 
                                "GDPR-Article 46", 
                                "HIPAA",
                                "HIPAA-164.308(a)(6)(ii)", 
                                "HITRUST",
                                "HITRUST CSF v9.3-Control Reference:05.h", 
                                "HITRUST CSF v9.3-Control Reference:06.g", 
                                "HITRUST CSF v9.3-Control Reference:06.h", 
                                "HITRUST CSF v9.3-Control Reference:09.ab", 
                                "HITRUST CSF v9.3-Control Reference:09.ae", 
                                "HITRUST CSF v9.3-Control Reference:10.c", 
                                "HITRUST CSF v9.3-Control Reference:10.m", 
                                "HITRUST CSF v9.3-Control Reference:11.b", 
                                "ISO 27001:2013",
                                "ISO 27001:2013-A.12.4.3", 
                                "ISO 27001:2013-A.16.1.2", 
                                "ISO 27001:2013-A.18.1.3", 
                                "NIST 800",
                                "NIST 800-53 Rev4-AU-5 (2)", 
                                "NIST 800-53 Rev4-CA-7g", 
                                "NIST 800-53 Rev4-CP-2a.3", 
                                "NIST 800-53 Rev4-IR-6 (2)", 
                                "NIST 800-53 Rev4-IR-9 (1)", 
                                "NIST 800-53 Rev4-SI-4 (5)", 
                                "NIST 800-53 Rev4-SI-7 (2)", 
                                "NIST CSF",
                                "NIST CSF-DE.AE-2", 
                                "NIST CSF-DE.AE-3", 
                                "NIST CSF-DE.CM-1", 
                                "NIST CSF-DE.CM-2", 
                                "NIST CSF-DE.CM-3", 
                                "NIST CSF-DE.CM-6", 
                                "NIST CSF-DE.CM-7", 
                                "NIST CSF-DE.DP-1", 
                                "NIST CSF-DE.DP-2", 
                                "NIST CSF-DE.DP-3", 
                                "NIST CSF-DE.DP-4", 
                                "NIST CSF-DE.DP-5", 
                                "NIST CSF-ID.RA-1", 
                                "NIST CSF-ID.RA-3", 
                                "NIST CSF-ID.RA-5", 
                                "NIST CSF-PR.IP-7", 
                                "NIST CSF-PR.IP-8", 
                                "NIST CSF-RS.AN-1", 
                                "NIST CSF-RS.CO-3", 
                                "NIST CSF-RS.MI-3", 
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.1.9", 
                                "NIST SP 800-171 Revision 2-3.14.3", 
                                "NIST SP 800-172-3.4.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-12.10.1", 
                                "SOC 2",
                                "SOC 2-CC6.1", 
                                "SOC 2-CC6.6", 
                                "SOC 2-CC6.7", 
                                "SOC 2-CC7.2", 
                                "SOC 2-CC7.3", 
                                "SOC 2-CC7.4", 
                                "SOC 2-CC7.5", 
                                "SOC 2-CC8.1"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_263"
                    ],
                    "severity": "Medium",
                    "title": "Threat Detection alert should be configured to send notifications to the SQL server account administrators",
                    "description": "Ensure that threat detection alert is configured to send notifications to the sql server account administrators"
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-022",
                    "type": "rego",
                    "rule": "file(dbvulnerabilityassessments.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-022",
                            "eval": "data.rule.db_ads_scan",
                            "message": "data.rule.db_ads_scan_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/azure-sql/database/sql-vulnerability-assessment?tabs=azure-powershell' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_SQL_022.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "Low",
                    "title": "Azure SQL Server advanced data security recurring scans should be enabled",
                    "description": "Advanced data security (ADS) provides a set of advanced SQL security capabilities, including vulnerability assessment, threat detection, and data discovery and classification.<br><br>This policy identifies Azure SQL servers that do not have ADS enabled. As a best practice, enable ADS on mission-critical SQL servers."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-024",
                    "type": "rego",
                    "rule": "file(dbvulnerabilityassessments.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-024",
                            "eval": "data.rule.db_ads_mail",
                            "message": "data.rule.db_ads_mail_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/azure-sql/database/sql-vulnerability-assessment?tabs=azure-powershell' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_SQL_024.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Azure Security Benchmark (v2)-GS-7",
                                "Azure Security Benchmark (v2)-IR-1",
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-IR-4",
                                "Azure Security Benchmark (v2)-IR-6",
                                "Azure Security Benchmark (v3)-DS-6",
                                "Azure Security Benchmark (v3)-PV-5",
                                "CIS",
                                "CIS v1.2.0 (Azure)-4.2.7",
                                "CIS v1.3.0 (Azure)-4.2.4",
                                "CIS v1.3.1 (Azure)-4.2.4",
                                "CIS v1.4.0 (Azure)-4.2.4",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-AIS-01",
                                "CSA CCM v.4.0.1-AIS-02",
                                "CSA CCM v.4.0.1-AIS-04",
                                "CSA CCM v.4.0.1-CCC-01",
                                "CSA CCM v.4.0.1-GRC-03",
                                "CSA CCM v.4.0.1-IVS-04",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-02",
                                "CSA CCM v.4.0.1-TVM-04",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-06",
                                "CSA CCM v.4.0.1-UEM-09",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.1.2",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.2.1",
                                "ISO/IEC 27002:2013-14.2.2",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-5.1.2",
                                "ISO/IEC 27002:2013-6.2.1",
                                "ISO/IEC 27002:2013-6.2.2",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.1.2",
                                "ISO/IEC 27017:2015-12.2.1",
                                "ISO/IEC 27017:2015-14.1.1",
                                "ISO/IEC 27017:2015-14.1.2",
                                "ISO/IEC 27017:2015-14.2.1",
                                "ISO/IEC 27017:2015-14.2.5",
                                "ISO/IEC 27017:2015-5.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-12.1.2",
                                "ISO/IEC 27018:2019-18.2.1",
                                "NIST CSF",
                                "NIST CSF-DE.CM-4",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-ID.RA-2",
                                "NIST CSF-ID.RA-3",
                                "NIST CSF-PR.IP-1",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.1.9",
                                "NIST SP 800-171 Revision 2-3.14.3",
                                "NIST SP 800-172-3.4.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-A3.3.1"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "Medium",
                    "title": "Azure SQL Server advanced data security should have email alert recipient to get scan notification",
                    "description": "Advanced data security (ADS) provides a set of advanced SQL security capabilities, including vulnerability assessment, threat detection, and data discovery and classification.<br><br>This policy identifies Azure SQL Servers that do not have an email address configured for ADS alert notifications. As a best practice, provide one or more email addresses where you want to receive alerts for any anomalous activities detected on SQL Servers."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-026",
                    "type": "rego",
                    "rule": "file(dbvulnerabilityassessments.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-026",
                            "eval": "data.rule.db_ads_alert",
                            "message": "data.rule.db_ads_alert_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/azure-sql/database/sql-vulnerability-assessment?tabs=azure-powershell' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_SQL_026.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-PV-6",
                                "Azure Security Benchmark (v3)-DS-6",
                                "Azure Security Benchmark (v3)-PV-5",
                                "CIS",
                                "CIS v1.2.0 (Azure)-4.2.8",
                                "CIS v1.3.0 (Azure)-4.2.5",
                                "CIS v1.3.1 (Azure)-4.2.5",
                                "CIS v1.4.0 (Azure)-4.2.5",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-AIS-01",
                                "CSA CCM v.4.0.1-AIS-02",
                                "CSA CCM v.4.0.1-AIS-04",
                                "CSA CCM v.4.0.1-CCC-01",
                                "CSA CCM v.4.0.1-GRC-03",
                                "CSA CCM v.4.0.1-IVS-04",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-02",
                                "CSA CCM v.4.0.1-TVM-04",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-06",
                                "CSA CCM v.4.0.1-UEM-09",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.1.2",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.2.1",
                                "ISO/IEC 27002:2013-14.2.2",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-5.1.2",
                                "ISO/IEC 27002:2013-6.2.1",
                                "ISO/IEC 27002:2013-6.2.2",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.1.2",
                                "ISO/IEC 27017:2015-12.2.1",
                                "ISO/IEC 27017:2015-14.1.1",
                                "ISO/IEC 27017:2015-14.1.2",
                                "ISO/IEC 27017:2015-14.2.1",
                                "ISO/IEC 27017:2015-14.2.5",
                                "ISO/IEC 27017:2015-5.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-12.1.2",
                                "ISO/IEC 27018:2019-18.2.1",
                                "NIST CSF",
                                "NIST CSF-DE.CM-4",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-ID.RA-2",
                                "NIST CSF-ID.RA-3",
                                "NIST CSF-PR.IP-1",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.1.9",
                                "NIST SP 800-171 Revision 2-3.14.3",
                                "NIST SP 800-172-3.4.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-A3.3.1"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "Medium",
                    "title": "Azure SQL Server advanced data security should send alerts to subscription administrators",
                    "description": "Advanced data security (ADS) provides a set of advanced SQL security capabilities, including vulnerability assessment, threat detection, and data discovery and classification.<br><br>This policy identifies Azure SQL Servers that are not enabled with ADS. As a best practice, enable ADS so that the subscription admin can receive email alerts when anomalous activities are detected on the SQL Servers."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-060",
                    "type": "rego",
                    "rule": "file(dbforMySQL.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-060",
                            "eval": "data.rule.mysql_public_access_disabled",
                            "message": "data.rule.mysql_public_access_disabled_err",
                            "remediationDescription": "Follow these steps to set MySQL server Deny Public Network Access:<br><br>1. In the Azure portal, select your existing Azure Database for MySQL server.<br>2. On the MySQL server page, under Settings, click Connection security to open the connection security configuration page.<br>3. In Deny Public Network Access, select Yes to enable deny public access for your MySQL server.<br>4. Click Save to save the changes.<br>5. A notification will confirm that connection security setting was successfully enabled.",
                            "remediationFunction": "PR_AZR_CLD_SQL_060.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_411"
                    ],
                    "severity": "High",
                    "title": "Ensure MySQL servers don't have public network access enabled",
                    "description": "Always use Private Endpoint for Azure MySQL Database Server"
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-061",
                    "type": "rego",
                    "rule": "file(dbforMySQL.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-061",
                            "eval": "data.rule.mysql_server_latest_tls_configured",
                            "message": "data.rule.mysql_server_latest_tls_configured_err",
                            "remediationDescription": "Follow these steps to set MySQL server minimum TLS version:<br><br>1. In the Azure portal, select your existing Azure Database for MySQL server.<br>2. On the MySQL server page, under Settings, click Connection security to open the connection security configuration page.<br>3. In Minimum TLS version, select 1.2 to deny connections with TLS version less than TLS 1.2 for your MySQL server.<br>4. Click Save to save the changes.<br>5. A notification will confirm that connection security setting was successfully enabled and in effect immediately. There is no restart of the server required or performed. After the changes are saved, all new connections to the server are accepted only if the TLS version is greater than or equal to the minimum TLS version set on the portal.",
                            "remediationFunction": "PR_AZR_CLD_SQL_061.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_411"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Azure MySQL Server has latest version of tls configured",
                    "description": "This policy will identify the Azure MySQL Server which doesn't have the latest version of tls configured and give the alert"
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-056",
                    "type": "rego",
                    "rule": "file(dbforMariaDB.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-056",
                            "eval": "data.rule.mairadb_ssl_enforcement_enabled",
                            "message": "data.rule.mairadb_ssl_enforcement_enabled_err",
                            "remediationDescription": "Using the Azure portal, visit your Azure Database for MariaDB server, and then click Connection security. Use the toggle button to enable or disable the Enforce SSL connection setting, and then click Save. Microsoft recommends to always enable the Enforce SSL connection setting for enhanced security.",
                            "remediationFunction": "PR_AZR_CLD_SQL_056.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_409"
                    ],
                    "severity": "High",
                    "title": "Ensure ssl enforcement is enabled on MariaDB Server.",
                    "description": "Enable SSL connection on MariaDB Servers. Rationale: SSL connectivity helps to provide a new layer of security, by connecting database server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between database server and client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and application."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-057",
                    "type": "rego",
                    "rule": "file(dbforMariaDB.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-057",
                            "eval": "data.rule.mairadb_public_access_disabled",
                            "message": "data.rule.mairadb_public_access_disabled_err",
                            "remediationDescription": "Follow these steps to set MariaDB server Deny Public Network Access:<br><br>1. In the Azure portal, select your existing Azure Database for MariaDB server.<br>2. On the MariaDB server page, under Settings, click Connection security to open the connection security configuration page.<br>3. In Deny Public Network Access, select Yes to enable deny public access for your MariaDB server.<br>4. Click Save to save the changes.<br>5. A notification will confirm that connection security setting was successfully enabled.",
                            "remediationFunction": "PR_AZR_CLD_SQL_057.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_409"
                    ],
                    "severity": "High",
                    "title": "Ensure MariaDB servers don't have public network access enabled",
                    "description": "Always use Private Endpoint for MariaDB Server"
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-058",
                    "type": "rego",
                    "rule": "file(dbforMariaDB.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-058",
                            "eval": "data.rule.mariadb_geo_redundant_backup_enabled",
                            "message": "data.rule.mariadb_geo_redundant_backup_enabled_err",
                            "remediationDescription": "1. Sign in to Azure Management Console.<br>2. Navigate to All resources blade at https://portal.azure.com/#blade/HubsExtension/BrowseAll to access all your Microsoft Azure resources.<br>3. From the Type filter box, select Azure Database for MariaDB server to list the MariaDB servers provisioned within your Azure account.<br>4. Click on the name of the MariaDB database server that you want to examine.<br>5. In the navigation panel, under Settings, select Pricing tier to access the pricing tier settings available for the selected MariaDB server.<br>6. On the Pricing tier page, in the Backup Redundancy Options section, check the backup redundancy tier configured for the database server. If the selected tier is Locally Redundant, the data can be recovered from within the current region only, therefore the Geo-Redundant backup feature is not enabled for the selected Microsoft Azure MariaDB database server.<br>7. Repeat steps no. 4 – 6 for each MariaDB database server available in the current Azure subscription.<br>8. Repeat steps no. 3 – 7 for each subscription created in your Microsoft Azure cloud account.",
                            "remediationFunction": "PR_AZR_CLD_SQL_058.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_409"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Geo-redundant backup is enabled on MariaDB server.",
                    "description": "Azure Database for MariaDB provides the flexibility to choose between locally redundant or geo-redundant backup storage in the General Purpose and Memory Optimized tiers. When the backups are stored in geo-redundant backup storage, they are not only stored within the region in which your server is hosted, but are also replicated to a paired data center. This provides better protection and ability to restore your server in a different region in the event of a disaster. The Basic tier only offers locally redundant backup storage."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-064",
                    "type": "rego",
                    "rule": "file(dbforMariaDB.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-064",
                            "eval": "data.rule.mairadb_usage_latest_tls",
                            "message": "data.rule.mairadb_usage_latest_tls_err",
                            "remediationDescription": "Using the Azure portal, visit your Azure Database for MariaDB server, and then click Connection security. In Minimum TLS version, select 1.2 to deny connections with TLS version less than TLS 1.2 for your MariaDB server, and then click Save.",
                            "remediationFunction": "PR_AZR_CLD_SQL_064.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_409"
                    ],
                    "severity": "Low",
                    "title": "Ensure MariaDB Server is using latest TLS version.",
                    "description": "This policy identifies Azure MariaDB database servers that are not using the latest TLS version for SSL enforcement. Azure Database for MariaDB uses Transport Layer Security (TLS) from communication with client applications. As a best security practice, use the newer TLS version as the minimum TLS version for the MariaDB database server. Currently, Azure MariaDB supports TLS 1.2 version which resolves the security gap from its preceding versions."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-031",
                    "type": "rego",
                    "rule": "file(sql_alert_policy.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-031",
                            "eval": "data.rule.sql_server_alert",
                            "message": "data.rule.sql_server_alert_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/servers/securityalertpolicies' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_SQL_031.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15",
                                "APRA (CPS 234) Information Security-CPS234-16",
                                "APRA (CPS 234) Information Security-CPS234-17",
                                "APRA (CPS 234) Information Security-CPS234-21",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-DP-3",
                                "Azure Security Benchmark (v3)-DS-6",
                                "Azure Security Benchmark (v3)-PV-5",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CIS",
                                "CIS v1.1 (Azure)-4.4",
                                "CIS v1.2.0 (Azure)-4.2.1",
                                "CIS v1.3.0 (Azure)-4.2.1",
                                "CIS v1.3.1 (Azure)-4.2.1",
                                "CIS v1.4.0 (Azure)-4.2.1",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-AIS-01",
                                "CSA CCM v.4.0.1-AIS-02",
                                "CSA CCM v.4.0.1-AIS-04",
                                "CSA CCM v.4.0.1-CCC-01",
                                "CSA CCM v.4.0.1-GRC-03",
                                "CSA CCM v.4.0.1-IVS-04",
                                "CSA CCM v.4.0.1-UEM-06",
                                "CyberSecurity Law of the People's Republic of China-Article 55",
                                "CyberSecurity Law of the People's Republic of China-Article 56",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AM.4.226",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:10.a",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.1.2",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.2.1",
                                "ISO/IEC 27002:2013-14.2.2",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.1.2",
                                "ISO/IEC 27017:2015-14.1.1",
                                "ISO/IEC 27017:2015-14.1.2",
                                "ISO/IEC 27017:2015-14.2.1",
                                "ISO/IEC 27017:2015-14.2.5",
                                "ISO/IEC 27017:2015-5.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-12.1.2",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Developer Testing and Evaluation | Threat Modeling and Vulnerability Analyses",
                                "NIST 800-53 Rev4-SA-11 (2)",
                                "NIST CSF",
                                "NIST CSF-PR.IP-1",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.4.2",
                                "NIST SP 800-172-3.4.1e",
                                "NIST SP 800-172-3.4.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-6.3",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Security Alert is enabled on Azure SQL Server",
                    "description": "Advanced data security should be enabled on your SQL servers."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-032",
                    "type": "rego",
                    "rule": "file(sql_alert_policy.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-032",
                            "eval": "data.rule.sql_managed_instance_alert",
                            "message": "data.rule.sql_managed_instance_alert_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/azure-sql/managed-instance/threat-detection-configure' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_SQL_032.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_401"
                    ],
                    "severity": "Medium",
                    "title": "Advanced data security should be enabled on your SQL managed instance.",
                    "description": "Advanced data security should be enabled on your SQL managed instance."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-034",
                    "type": "rego",
                    "rule": "file(sql_alert_policy.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-034",
                            "eval": "data.rule.sql_server_email_account",
                            "message": "data.rule.sql_server_email_account_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/servers/securityalertpolicies?tabs=json' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_SQL_034.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "High",
                    "title": "Ensure that VA setting 'Also send email notifications to admins and subscription owners' is set for a SQL server",
                    "description": "VA scan reports and alerts will be sent to admins and subscription owners by enabling the setting 'Also send email notifications to admins and subscription owners'. This may help in reducing the time required for identifying risks and taking corrective measures."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-036",
                    "type": "rego",
                    "rule": "file(sql_alert_policy.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-036",
                            "eval": "data.rule.sql_server_email_addressess",
                            "message": "data.rule.sql_server_email_addressess_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/defender-for-cloud/configure-email-notifications' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_SQL_036.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "High",
                    "title": "Azure SQL Security Alert Policy should be configured to send alerts to the account administrators and configured email addresses",
                    "description": "Provide the email address where alerts will be sent when anomalous activities are detected on SQL servers."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-038",
                    "type": "rego",
                    "rule": "file(sql_alert_policy.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-038",
                            "eval": "data.rule.sql_server_retention_days",
                            "message": "data.rule.sql_server_retention_days_err",
                            "remediationDescription": "To change the policy using the Azure Portal, follow these steps:<br><br>1. Log in to the Azure Portal at https://portal.azure.com.<br>2. Navigate to SQL servers.<br>2. For each server instance:<br>a) Click Auditing.<br>b) Select Storage Details.<br>c) Set Retention (days) to equal or greater than 90 days.<br>d) Click OK.<br>e) Click Save.",
                            "remediationFunction": "PR_AZR_CLD_SQL_038.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "APRA (CPS 234) Information Security-CPS234-35",
                                "APRA (CPS 234) Information Security-CPS234-36",
                                "Brazilian Data Protection Law (LGPD)-Article 16",
                                "Brazilian Data Protection Law (LGPD)-Article 40",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CSA CCM",
                                "CSA CCM v3.0.1-BCR-11",
                                "CSA CCM v3.0.1-GRM-01",
                                "CSA CCM v3.0.1-MOS-19",
                                "CyberSecurity Law of the People's Republic of China-Article 34",
                                "CyberSecurity Law of the People's Republic of China-Article 55",
                                "CyberSecurity Law of the People's Republic of China-Article 56",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AU.2.042",
                                "HIPAA",
                                "HIPAA-164.312(b)",
                                "HITRUST",
                                "HITRUST CSF v9.3-Control Reference:06.c",
                                "HITRUST CSF v9.3-Control Reference:06.d",
                                "HITRUST CSF v9.3-Control Reference:09.aa",
                                "HITRUST CSF v9.3-Control Reference:09.q",
                                "HITRUST CSF v9.3-Control Reference:10.k",
                                "HITRUST CSF v9.3-Control Reference:11.e",
                                "ISO 27001:2013",
                                "ISO 27001:2013-A.12.4.2",
                                "ISO 27001:2013-A.18.1.3",
                                "NIST 800",
                                "NIST 800-53 Rev4-AU-11",
                                "NIST 800-53 Rev4-CM-2 (3)",
                                "NIST 800-53 Rev4-SI-12",
                                "NIST CSF",
                                "NIST CSF-PR.IP-2",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.3.2",
                                "NIST SP 800-172-3.1.1e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-10.7",
                                "PIPEDA",
                                "PIPEDA-4.5.2",
                                "SOC 2",
                                "SOC 2-CC6.1",
                                "SOC 2-CC6.6",
                                "SOC 2-CC7.2",
                                "SOC 2-CC7.3",
                                "SOC 2-CC7.4",
                                "SOC 2-CC7.5",
                                "SOC 2-CC8.1"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "Medium",
                    "title": "Ensure SQL Server Threat Detection is Enabled and Retention Logs are equal or greater than 90 days",
                    "description": "Azure SQL Database Threat Detection is a security intelligence feature built into the Azure SQL Database service. Working around the clock to learn, profile and detect anomalous database activities, Azure SQL Database Threat Detection identifies potential threats to the database. Security officers or other designated administrators can get an immediate notification about suspicious database activities as they occur. Each notification provides details of the suspicious activity and recommends how to further investigate and mitigate the threat."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-040",
                    "type": "rego",
                    "rule": "file(sql_alert_policy.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-040",
                            "eval": "data.rule.sql_server_disabled_alerts",
                            "message": "data.rule.sql_server_disabled_alerts_err",
                            "remediationDescription": "1. Sign into the Azure portal.<br>2. Navigate to the configuration page of the server you want to protect. In the security settings, select Defender for Cloud.<br>3.On the Microsoft Defender for SQL configuration page:<br>a) Enable Microsoft Defender for SQL on the server.<br>b) In Advanced Threat Protection Settings, provide the list of emails to receive security alerts upon detection of anomalous database activities in the Send alerts to text box.",
                            "remediationFunction": "PR_AZR_CLD_SQL_040.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "APRA (CPS 234) Information Security-CPS234-35", 
                                "APRA (CPS 234) Information Security-CPS234-36", 
                                "Brazilian Data Protection Law (LGPD)-Article 31", 
                                "Brazilian Data Protection Law (LGPD)-Article 48", 
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CIS",
                                "CIS v1.1 (Azure)-4.5", 
                                "CIS v1.2.0 (Azure)-4.2.2", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-LOG-05", 
                                "CSA CCM v.4.0.1-LOG-06", 
                                "CSA CCM v.4.0.1-LOG-08", 
                                "CSA CCM v.4.0.1-LOG-13", 
                                "CyberSecurity Law of the People's Republic of China-Article 55", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AU.3.046",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.4.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.4.4",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.4.1",
                                "ISO/IEC 27017:2015-12.4.4",
                                "ISO/IEC 27017:2015-16.1.2",
                                "NIST 800",
                                "NIST 800-53 Rev 5-System Monitoring | Automated Organization-generated Alerts",
                                "NIST 800-53 Rev4-SI-4 (12)",
                                "NIST CSF",
                                "NIST CSF-PR.PT-1",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.3.4",
                                "NIST SP 800-172-3.11.3e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-A3.3.1",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "Medium",
                    "title": "Azure SQL Server threat detection alerts should be enabled for all threat types",
                    "description": "Advanced data security (ADS) provides a set of advanced SQL security capabilities, including vulnerability assessment, threat detection, and data discovery and classification.<br><br>This policy identifies Azure SQL servers that have disabled the detection of one or more threat types. To protect your SQL Servers, as a best practice, enable ADS detection for all types of threats."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-041",
                    "type": "rego",
                    "rule": "file(sql_managedinstance.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-041",
                            "eval": "data.rule.sql_mi_public_endpoint_disabled",
                            "message": "data.rule.sql_mi_public_endpoint_disabled_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/azure-sql/managed-instance/public-endpoint-configure' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_SQL_041.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_401"
                    ],
                    "severity": "Medium",
                    "title": "SQL Managed Instance should have public endpoint access disabled",
                    "description": "Always use Private Endpoint for Azure SQL Database and SQL Managed Instance"
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-042",
                    "type": "rego",
                    "rule": "file(sql_servers_auditing.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-042",
                            "eval": "data.rule.sql_server_log_audit",
                            "message": "data.rule.sql_server_log_audit_err",
                            "remediationDescription": "az sql server audit-policy update [--name] [--resource-group] [--state {Enabled}]<br><br>References:<br><a href='https://docs.azure.cn/zh-cn/cli/sql/server/audit-policy?view=azure-cli-latest#az-sql-server-audit-policy-update' target='_blank'>https://docs.azure.cn/zh-cn/cli/sql/server/audit-policy?view=azure-cli-latest#az-sql-server-audit-policy-update</a>",
                            "remediationFunction": "PR_AZR_CLD_SQL_042.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-LT-4",
                                "Azure Security Benchmark (v3)-DS-7",
                                "Azure Security Benchmark (v3)-LT-3",
                                "Azure Security Benchmark (v3)-LT-4",
                                "Brazilian Data Protection Law (LGPD)-Article 31",
                                "Brazilian Data Protection Law (LGPD)-Article 48",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CIS",
                                "CIS v1.1 (Azure)-4.1",
                                "CIS v1.2.0 (Azure)-4.1.1",
                                "CIS v1.3.0 (Azure)-4.1.1",
                                "CIS v1.3.1 (Azure)-4.1.1",
                                "CIS v1.4.0 (Azure)-4.1.1",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-06",
                                "CSA CCM v.4.0.1-LOG-08",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CyberSecurity Law of the People's Republic of China-Article 55",
                                "CyberSecurity Law of the People's Republic of China-Article 56",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AU.3.046",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.4.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.4.4",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.4.1",
                                "ISO/IEC 27017:2015-12.4.4",
                                "ISO/IEC 27017:2015-16.1.2",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1562.008 - Impair Defenses:Disable Cloud Logs",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Vulnerability Monitoring and Scanning | Review Historic Audit Logs",
                                "NIST 800-53 Rev4-RA-5 (8)",
                                "NIST CSF",
                                "NIST CSF-PR.PT-1",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.3.4",
                                "NIST SP 800-172-3.14.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-A3.3.1",
                                "PIPEDA",
                                "PIPEDA-4.1.4"
 
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "High",
                    "title": "Ensure that SQL Server Auditing is Enabled",
                    "description": "Ensure that SQL Server Auditing is enabled in order to keep track of Audit events."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-044",
                    "type": "rego",
                    "rule": "file(sql_servers_auditing.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-044",
                            "eval": "data.rule.sql_server_audit_log_retention",
                            "message": "data.rule.sql_server_audit_log_retention_err",
                            "remediationDescription": "az sql server audit-policy update -g -n --state Enabled --storage-account --retention-days 90<br><br>References:<br><a href='https://docs.microsoft.com/en-us/cli/azure/sql/server/audit-policy?view=azure-cli-latest#az_sql_server_audit_policy_show' target='_blank'>https://docs.microsoft.com/en-us/cli/azure/sql/server/audit-policy?view=azure-cli-latest#az_sql_server_audit_policy_show</a>",
                            "remediationFunction": "PR_AZR_CLD_SQL_044.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "APRA (CPS 234) Information Security-CPS234-35",
                                "APRA (CPS 234) Information Security-CPS234-36",
                                "Azure Security Benchmark ",
                                "Azure Security Benchmark (v2)-LT-6",
                                "Azure Security Benchmark (v3)-LT-6",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CIS",
                                "CIS v1.1 (Azure)-4.3",
                                "CIS v1.2.0 (Azure)-4.1.3",
                                "CIS v1.3.0 (Azure)-4.1.3",
                                "CIS v1.3.1 (Azure)-4.1.3",
                                "CIS v1.4.0 (Azure)-4.1.3",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-06",
                                "CSA CCM v.4.0.1-LOG-08",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CyberSecurity Law of the People's Republic of China-Article 34",
                                "CyberSecurity Law of the People's Republic of China-Article 55",
                                "CyberSecurity Law of the People's Republic of China-Article 56",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.177",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.185",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:06.c",
                                "HITRUST v.9.4.2-Control Reference:06.d",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.4.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.4.4",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.4.1",
                                "ISO/IEC 27017:2015-12.4.4",
                                "ISO/IEC 27017:2015-16.1.2",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Audit Record Retention",
                                "NIST 800-53 Rev4-AU-11",
                                "NIST CSF",
                                "NIST CSF-DE.AE-2",
                                "NIST CSF-DE.CM-3",
                                "NIST CSF-PR.PT-1",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.3.2",
                                "NIST SP 800-172-3.1.1e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-3.1",
                                "PIPEDA",
                                "PIPEDA-4.5.2"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "High",
                    "title": "Azure SQL server audit log retention should be 90 days or higher",
                    "description": "Audit Logs can be used to check for anomalies and give insight into suspected breaches or misuse of information and access. We recommend you configure SQL server audit retention to be 90 days or higher."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-046",
                    "type": "rego",
                    "rule": "file(sql_servers_encryption.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-046",
                            "eval": "data.rule.serverKeyType",
                            "message": "data.rule.serverKeyType_err",
                            "remediationDescription": "Using Azure CLI:<br><br>Use the below command to encrypt SQL server's TDE protector with a Customer-managed key<br><br>az sql server tde-key >> Set --resource-group --server --server-key-type {AzureKeyVault} [--kid ]<br><br>References:<br><a href='https://docs.microsoft.com/en-us/sql/relational-databases/security/encryption/transparent-data-encryption-byok-azure-sql' target='_blank'>https://docs.microsoft.com/en-us/sql/relational-databases/security/encryption/transparent-data-encryption-byok-azure-sql</a>",
                            "remediationFunction": "PR_AZR_CLD_SQL_046.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15",
                                "APRA (CPS 234) Information Security-CPS234-16",
                                "APRA (CPS 234) Information Security-CPS234-17",
                                "APRA (CPS 234) Information Security-CPS234-21",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-DP-5",
                                "Azure Security Benchmark (v3)-DP-4",
                                "Azure Security Benchmark (v3)-DP-5",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CIS",
                                "CIS v1.1 (Azure)-4.10",
                                "CIS v1.2.0 (Azure)-4.5",
                                "CIS v1.3.0 (Azure)-4.5",
                                "CIS v1.3.1 (Azure)-4.5",
                                "CIS v1.4.0 (Azure)-4.6",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-UEM-11",
                                "CyberSecurity Law of the People's Republic of China-Article 30",
                                "CyberSecurity Law of the People's Republic of China-Article 31",
                                "CyberSecurity Law of the People's Republic of China-Article 40",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.177",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:06.d",
                                "HITRUST v.9.4.2-Control Reference:09.s",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1",
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2",
                                "ISO/IEC 27018:2019-12.3.1",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Cryptographic Key Establishment and Management",
                                "NIST 800-53 Rev 5-Remote Access | Protection of Confidentiality and Integrity Using Encryption",
                                "NIST 800-53 Rev 5-Transmission Confidentiality and Integrity | Cryptographic Protection",
                                "NIST 800-53 Rev4-AC-17 (2)",
                                "NIST 800-53 Rev4-SC-12",
                                "NIST 800-53 Rev4-SC-8 (1)",
                                "NIST CSF",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.16",
                                "NIST SP 800-172-3.1.3e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-3.4.1",
                                "PCI DSS v3.2.1-4.1"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "High",
                    "title": "Ensure SQL server's TDE protector is encrypted with Customer-managed key",
                    "description": "Customer-managed key support for Transparent Data Encryption (TDE) allows user control of TDE encryption keys and restricts who can access them and when. Azure Key Vault, Azure’s cloud-based external key management system is the first key management service where TDE has integrated support for Customer-managed keys. With Customer-managed key support, the database encryption key is protected by an asymmetric key stored in the Key Vault. The asymmetric key is set at the server level and inherited by all databases under that server."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-049",
                    "type": "rego",
                    "rule": "file(sql_servers.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-049",
                            "eval": "data.rule.sql_logical_server_login",
                            "message": "data.rule.sql_logical_server_login_err",
                            "remediationDescription": "In Azure Portal<br>1. Go to SQL Servers<br>2. For each SQL Server<br>3. Select Active Directory admin<br>4. Press the Set Admin at the top of the page<br>5. Select the active directory user you want to set as AD Admin for the SQL server.<br>6. Press the Remove admin if not needed.<br><br>Default Value: By default no AD Administrator is set for SQL server<br><br>Please visit <a href='https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/2014-04-01/servers/administrators' target='_blank'>here</a> for more details.",
                            "remediationFunction": "PR_AZR_CLD_SQL_049.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "PCI-DSS",
                                "GDPR",
                                "ISO 27001",
                                "NIST CSF",
                                "HIPAA",
                                "Best Practice"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "Medium",
                    "title": "Ensure SQL Server administrator login does not contain 'Admin/Administrator' as name",
                    "description": "You must designate a Server admin login when you create an Azure SQL server. SQL server creates this account as a login in the master database. Only one such account can exist. This account connects using SQL Server authentication (username and password). It is recommended to avoid using names like 'admin' or 'administrator', which are targeted in brute force dictionary attacks."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-069",
                    "type": "rego",
                    "rule": "file(sql_servers.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-069",
                            "eval": "data.rule.sql_server_latest_tls_configured",
                            "message": "data.rule.sql_server_latest_tls_configured_err",
                            "remediationDescription": "Please Visit <a href='https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/servers' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_CLD_SQL_069.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "High",
                    "title": "Ensure Azure SQL Server has latest version of tls configured",
                    "description": "This policy will identify the Azure SQL Server which doesn't have the latest version of tls configured and give the alert"
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-047",
                    "type": "rego",
                    "rule": "file(sql_servers.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-047",
                            "eval": "data.rule.sql_public_access",
                            "message": "data.rule.sql_public_access_err",
                            "remediationDescription": "Please Visit <a href='https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/servers' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_CLD_SQL_047.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "High",
                    "title": "Ensure SQL servers don't have public network access enabled",
                    "description": "Always use Private Endpoint for Azure SQL Database and SQL Managed Instance"
                },
                {
                    "masterTestId": "PR-AZR-CLD-AKS-001",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AKS-001",
                            "eval": "data.rule.aks_cni_net",
                            "message": "data.rule.aks_cni_net_err",
                            "remediationDescription": "To configure Azure CNI Networking in AKS please refer to the following guide - <br><a href='https://docs.microsoft.com/en-us/azure/aks/configure-azure-cni' target='_blank'>https://docs.microsoft.com/en-us/azure/aks/configure-azure-cni</a>",
                            "remediationFunction": "PR_AZR_CLD_AKS_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-AIS-01", 
                                "CSA CCM v.4.0.1-AIS-02", 
                                "CSA CCM v.4.0.1-AIS-04", 
                                "CSA CCM v.4.0.1-CCC-01", 
                                "CSA CCM v.4.0.1-GRC-03", 
                                "CSA CCM v.4.0.1-IVS-04", 
                                "CSA CCM v.4.0.1-UEM-06", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.2.179", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:10.a", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.1.2", 
                                "ISO/IEC 27002:2013-14.1.1", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.2.1", 
                                "ISO/IEC 27002:2013-14.2.2", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.1.2", 
                                "ISO/IEC 27017:2015-14.1.1", 
                                "ISO/IEC 27017:2015-14.1.2", 
                                "ISO/IEC 27017:2015-14.2.1", 
                                "ISO/IEC 27017:2015-14.2.5", 
                                "ISO/IEC 27017:2015-5.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-12.1.2", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Boundary Protection | Connections to Public Networks", 
                                "NIST 800-53 Rev4-CA-3 (4)", 
                                "NIST CSF",
                                "NIST CSF-PR.IP-1",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.4.2", 
                                "NIST SP 800-172-3.4.1e", 
                                "NIST SP 800-172-3.4.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-6.3"

                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "Medium",
                    "title": "Azure CNI networking should be enabled in Azure AKS cluster",
                    "description": "Azure CNI provides the following features over kubenet networking:<br><br>- Every pod in the cluster is assigned an IP address in the virtual network. The pods can directly communicate with other pods in the cluster, and other nodes in the virtual network.<br>- Pods in a subnet that have service endpoints enabled can securely connect to Azure services, such as Azure Storage and SQL DB.<br>- You can create user-defined routes (UDR) to route traffic from pods to a Network Virtual Appliance.<br>- Support for Network Policies securing communication between pods.<br><br>This policy checks your AKS cluster for the Azure CNI network plugin and generates an alert if not found."
                },
                {
                    "masterTestId": "PR-AZR-CLD-AKS-002",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AKS-002",
                            "eval": "data.rule.aks_http_routing",
                            "message": "data.rule.aks_http_routing_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/aks/http-application-routing' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_AKS_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15", 
                                "APRA (CPS 234) Information Security-CPS234-16", 
                                "APRA (CPS 234) Information Security-CPS234-17", 
                                "APRA (CPS 234) Information Security-CPS234-21", 
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03", 
                                "CSA CCM v.4.0.1-DSP-10", 
                                "CSA CCM v.4.0.1-IVS-03", 
                                "CSA CCM v.4.0.1-UEM-11", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183", 
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.s", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1", 
                                "ISO/IEC 27002:2013-12.2.1", 
                                "ISO/IEC 27002:2013-12.3.1", 
                                "ISO/IEC 27002:2013-13.1.1", 
                                "ISO/IEC 27002:2013-13.1.2", 
                                "ISO/IEC 27002:2013-13.1.3", 
                                "ISO/IEC 27002:2013-13.2.1", 
                                "ISO/IEC 27002:2013-13.2.3", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.1.3", 
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-8.3.1", 
                                "ISO/IEC 27002:2013-8.3.3", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2", 
                                "ISO/IEC 27017:2015-6.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2", 
                                "ISO/IEC 27018:2019-12.3.1", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Transmission Confidentiality and Integrity | Cryptographic Protection", 
                                "NIST 800-53 Rev4-SC-8 (1)",
                                "NIST CSF", 
                                "NIST CSF-PR.DS-2", 
                                "NIST CSF-PR.DS-5", 
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.8", 
                                "NIST SP 800-172-3.4.1e", 
                                "NIST SP 800-172-3.4.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-2.3", 
                                "PCI DSS v3.2.1-4.1"

                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "Low",
                    "title": "Azure AKS cluster HTTP application routing should be disabled",
                    "description": "The HTTP application routing add-on is designed to let you quickly create an ingress controller and access your applications. This add-on is not currently designed for use in a production environment and is not recommended for production use. For production-ready ingress deployments that include multiple replicas and TLS support, see Create an HTTPS ingress controller."
                },
                {
                    "masterTestId": "PR-AZR-CLD-AKS-003",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AKS-003",
                            "eval": "data.rule.aks_monitoring",
                            "message": "data.rule.aks_monitoring_err",
                            "remediationDescription": "Use CLI Command<br><br>To enable Azure Monitor for an existing AKS cluster, use the following command:<br><br>az aks enable-addons -a monitoring -n rg-weu-my-cluster -g rg-weu-my-cluster-group",
                            "remediationFunction": "PR_AZR_CLD_AKS_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "APRA (CPS 234) Information Security-CPS234-35", 
                                "APRA (CPS 234) Information Security-CPS234-36", 
                                "Brazilian Data Protection Law (LGPD)-Article 31", 
                                "Brazilian Data Protection Law (LGPD)-Article 48", 
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CSA CCM", 
                                "CSA CCM v.4.0.1-LOG-05", 
                                "CSA CCM v.4.0.1-LOG-06", 
                                "CSA CCM v.4.0.1-LOG-08", 
                                "CSA CCM v.4.0.1-LOG-13", 
                                "CyberSecurity Law of the People's Republic of China-Article 41", 
                                "CyberSecurity Law of the People's Republic of China-Article 43", 
                                "CyberSecurity Law of the People's Republic of China-Article 44", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AU.3.046", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:10.a", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.4.1", 
                                "ISO/IEC 27002:2013-12.4.3", 
                                "ISO/IEC 27002:2013-12.4.4", 
                                "ISO/IEC 27002:2013-16.1.1", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.4.1", 
                                "ISO/IEC 27017:2015-12.4.4", 
                                "ISO/IEC 27017:2015-16.1.2", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Continuous Monitoring", 
                                "NIST 800-53 Rev4-CA-7e",
                                "NIST CSF", 
                                "NIST CSF-PR.PT-1", 
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.3.4", 
                                "NIST SP 800-172-3.4.1e", 
                                "NIST SP 800-172-3.4.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-6.3", 
                                "PIPEDA",
                                "PIPEDA-4.1.4"

                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "Medium",
                    "title": "Azure AKS cluster monitoring not enabled",
                    "description": "Azure Monitor for containers gives you performance visibility by collecting memory and processor metrics from controllers, nodes, and containers that are available in Kubernetes through the Metrics API. Container logs are also collected. After you enable monitoring from Kubernetes clusters, metrics and logs are automatically collected for you through a containerized version of the Log Analytics agent for Linux. Metrics are written to the metrics store and log data is written to the logs store associated with your Log Analytics workspace."
                },
                {
                    "masterTestId": "PR-AZR-CLD-AKS-004",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AKS-004",
                            "eval": "data.rule.aks_nodes",
                            "message": "data.rule.aks_nodes_err",
                            "remediationDescription": "In order to add additional worker nodes to your cluster pool, run the following CLI command: <br>az aks nodepool add --cluster-name --name --resource-group",
                            "remediationFunction": "PR_AZR_CLD_AKS_004.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "Medium",
                    "title": "Azure AKS cluster pool profile count should contain 3 nodes or more",
                    "description": "Ensure your AKS cluster pool profile count contains 3 or more nodes. This is recommended for a more resilient cluster. (Clusters smaller than 3 may experience downtime during upgrades.)<br><br>This policy checks the size of your cluster pool profiles and alerts if there are fewer than 3 nodes."
                },
                {
                    "masterTestId": "PR-AZR-CLD-AKS-005",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AKS-005",
                            "eval": "data.rule.aks_rbac",
                            "message": "data.rule.aks_rbac_err",
                            "remediationDescription": "To enable Azure RBAC for Kubernetes Authorization please refer to the following guide -<br><a href='https://docs.microsoft.com/en-us/azure/aks/manage-azure-rbac' target='_blank'>https://docs.microsoft.com/en-us/azure/aks/manage-azure-rbac</a>",
                            "remediationFunction": "PR_AZR_CLD_AKS_005.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-14", 
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark (v2)-PA-7", 
                                "Azure Security Benchmark (v3)-PA-1", 
                                "Azure Security Benchmark (v3)-PA-7", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CIS",
                                "CIS v1.1 (Azure)-8.5", 
                                "CIS v1.2.0 (Azure)-8.5", 
                                "CIS v1.3.0 (Azure)-8.5", 
                                "CIS v1.3.1 (Azure)-8.5", 
                                "CIS v1.4.0 (Azure)-8.7", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-DSP-17", 
                                "CSA CCM v.4.0.1-IAM-04", 
                                "CSA CCM v.4.0.1-IAM-05", 
                                "CSA CCM v.4.0.1-IAM-09", 
                                "CSA CCM v.4.0.1-IAM-16", 
                                "CyberSecurity Law of the People's Republic of China-Article 21", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183", 
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.c", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-18.1.4", 
                                "ISO/IEC 27002:2013-6.1.2", 
                                "ISO/IEC 27002:2013-9.1.1", 
                                "ISO/IEC 27002:2013-9.1.2", 
                                "ISO/IEC 27002:2013-9.2.3", 
                                "ISO/IEC 27002:2013-9.2.5", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-9.2.3", 
                                "ISO/IEC 27017:2015-9.2.5", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-9.2.3", 
                                "ISO/IEC 27018:2019-9.2.5", 
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v6.3-T1078",   
                                "MITRE ATT&CK v8.2-T1078", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Access Enforcement | Role-based Access Control", 
                                "NIST 800-53 Rev4-AC-3 (7)",
                                "NIST CSF", 
                                "NIST CSF-PR.AC-4",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.1.5", 
                                "NIST SP 800-172-3.1.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-7.1", 
                                "PCI DSS v3.2.1-7.1.2", 
                                "PIPEDA",
                                "PIPEDA-4.7.3"

                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "High",
                    "title": "Azure AKS enable role-based access control (RBAC) should be enforced",
                    "description": "To provide granular filtering of the actions that users can perform, Kubernetes uses role-based access controls (RBAC). This control mechanism lets you assign users, or groups of users, permission to do things like create or modify resources, or view logs from running application workloads. These permissions can be scoped to a single namespace, or granted across the entire AKS cluster.<br><br>This policy checks your AKS cluster RBAC setting and alerts if disabled."
                },
                {
                    "masterTestId": "PR-AZR-CLD-AKS-006",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AKS-006",
                            "eval": "data.rule.aks_aad_azure_rbac",
                            "message": "data.rule.aks_aad_azure_rbac_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/aks/managed-aad' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_AKS_006.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "Medium",
                    "title": "Managed Azure AD RBAC for AKS cluster should be enabled",
                    "description": "Azure Kubernetes Service (AKS) can be configured to use Azure Active Directory (AD) for user authentication. In this configuration, you sign in to an AKS cluster using an Azure AD authentication token. You can also configure Kubernetes role-based access control (Kubernetes RBAC) to limit access to cluster resources based a user's identity or group membership. Visit https://docs.microsoft.com/en-us/azure/aks/azure-ad-rbac for details."
                },
                {
                    "masterTestId": "PR-AZR-CLD-AKS-007",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AKS-007",
                            "eval": "data.rule.aks_authorized_Ip",
                            "message": "data.rule.aks_authorized_Ip_err",
                            "remediationDescription": "API server authorized IP ranges only work for new AKS clusters and are not supported for private AKS clusters.<br><br>To create a cluster with API server authorized IP ranges enabled : <a href='https://docs.microsoft.com/en-us/azure/aks/api-server-authorized-ip-ranges?ocid=AID754288&wt.mc_id=CFID0533#create-an-aks-cluster-with-api-server-authorized-ip-ranges-enabled' target='_blank'>https://docs.microsoft.com/en-us/azure/aks/api-server-authorized-ip-ranges?ocid=AID754288&wt.mc_id=CFID0533#create-an-aks-cluster-with-api-server-authorized-ip-ranges-enabled</a><br><br>To update a cluster's API server authorized IP ranges: <a href='https://docs.microsoft.com/en-us/azure/aks/api-server-authorized-ip-ranges?ocid=AID754288&wt.mc_id=CFID0533#update-a-clusters-api-server-authorized-ip-ranges' target='_blank'>https://docs.microsoft.com/en-us/azure/aks/api-server-authorized-ip-ranges?ocid=AID754288&wt.mc_id=CFID0533#update-a-clusters-api-server-authorized-ip-ranges</a>",
                            "remediationFunction": "PR_AZR_CLD_AKS_007.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "Low",
                    "title": "Ensure AKS API server defines authorized IP ranges",
                    "description": "The AKS API server receives requests to perform actions in the cluster , for example, to create resources, and scale the number of nodes. The API server provides a secure way to manage a cluster."
                },
                {
                    "masterTestId": "PR-AZR-CLD-AKS-008",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AKS-008",
                            "eval": "data.rule.network_policy",
                            "message": "data.rule.network_policy_err",
                            "remediationDescription": "In an AKS cluster, all pods can send and receive traffic without limitations, by default. To improve security, you can define rules that control the flow of traffic.<br>Network Policy is a Kubernetes specification that defines access policies for communication between Pods. These network policy rules are defined as YAML manifests.<br>The network policy feature can only be enabled when the cluster is created. You can't enable network policy on an existing AKS cluster.<br>To create AKS cluster that supports network policy, please refer - <br><a href='https://docs.microsoft.com/en-us/azure/aks/use-network-policies?ocid=AID754288&wt.mc_id=CFID0471#create-an-aks-cluster-and-enable-network-policy' target='_blank'>https://docs.microsoft.com/en-us/azure/aks/use-network-policies?ocid=AID754288&wt.mc_id=CFID0471#create-an-aks-cluster-and-enable-network-policy</a>",
                            "remediationFunction": "PR_AZR_CLD_AKS_008.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "Low",
                    "title": "Ensure AKS cluster network policies are enforced",
                    "description": "Network policy options in AKS include two ways to implement a network policy. You can choose between Azure Network Policies or Calico Network Policies. In both cases, the underlying controlling layer is based on Linux IPTables to enforce the specified policies. Policies are translated into sets of allowed and disallowed IP pairs. These pairs are then programmed as IPTable rules."
                },
                {
                    "masterTestId": "PR-AZR-CLD-AKS-009",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AKS-009",
                            "eval": "data.rule.aks_kub_dashboard_disabled",
                            "message": "data.rule.aks_kub_dashboard_disabled_err",
                            "remediationDescription": "Use CLI Command: <br><br>az aks disable-addons -g myRG -n myAKScluster -a kube-dashboard",
                            "remediationFunction": "PR_AZR_CLD_AKS_009.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Kubernetes Dashboard is disabled",
                    "description": "Disable the Kubernetes dashboard on Azure Kubernetes Service"
                },
                {
                    "masterTestId": "PR-AZR-CLD-AKS-010",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AKS-010",
                            "eval": "data.rule.aks_local_account_disabled",
                            "message": "data.rule.aks_local_account_disabled_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/aks/private-clusters' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_AKS_010.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "Medium",
                    "title": "Azure Kubernetes Service Clusters should have local authentication methods disabled",
                    "description": "Disabling local authentication methods improves security by ensuring that Azure Kubernetes Service Clusters should exclusively require Azure Active Directory identities for authentication."
                },
                {
                    "masterTestId": "PR-AZR-CLD-AGW-001",
                    "type": "rego",
                    "rule": "file(applicationgateways.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AGW-001",
                            "eval": "data.rule.gw_tls",
                            "message": "data.rule.gw_tls_err",
                            "remediationDescription": "az network application-gateway ssl-policy set --min-protocol-version TLSv1_2<br><br>References:<br><a href='https://docs.microsoft.com/en-us/cli/azure/network/application-gateway/ssl-policy?view=azure-cli-latest#az_network_application_gateway_ssl_policy_set' target='_blank'>https://docs.microsoft.com/en-us/cli/azure/network/application-gateway/ssl-policy?view=azure-cli-latest#az_network_application_gateway_ssl_policy_set</a>",
                            "remediationFunction": "PR_AZR_CLD_AGW_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15", 
                                "APRA (CPS 234) Information Security-CPS234-16", 
                                "APRA (CPS 234) Information Security-CPS234-17", 
                                "APRA (CPS 234) Information Security-CPS234-21", 
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03", 
                                "CSA CCM v.4.0.1-DSP-10", 
                                "CSA CCM v.4.0.1-IVS-03", 
                                "CSA CCM v.4.0.1-UEM-11", 
                                "CyberSecurity Law of the People's Republic of China-Article 21", 
                                "CyberSecurity Law of the People's Republic of China-Article 40", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.185", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.s", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1", 
                                "ISO/IEC 27002:2013-12.2.1", 
                                "ISO/IEC 27002:2013-12.3.1", 
                                "ISO/IEC 27002:2013-13.1.1", 
                                "ISO/IEC 27002:2013-13.1.2", 
                                "ISO/IEC 27002:2013-13.1.3", 
                                "ISO/IEC 27002:2013-13.2.1", 
                                "ISO/IEC 27002:2013-13.2.3", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.1.3", 
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-8.3.1", 
                                "ISO/IEC 27002:2013-8.3.3", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2", 
                                "ISO/IEC 27017:2015-6.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2", 
                                "ISO/IEC 27018:2019-12.3.1", 
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1190 - Exploit Public-Facing Application", 
                                "MITRE ATT&CK v6.3-T1190", 
                                "MITRE ATT&CK v8.2-T1190", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Transmission Confidentiality and Integrity | Cryptographic Protection", 
                                "NIST 800-53 Rev4-SC-8 (1)",
                                "NIST CSF", 
                                "NIST CSF-PR.DS-2", 
                                "NIST CSF-PR.DS-5",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.13.8", 
                                "NIST SP 800-172-3.4.1e", 
                                "NIST SP 800-172-3.4.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-2.3", 
                                "PCI DSS v3.2.1-4.1", 
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_221"
                    ],
                    "severity": "High",
                    "title": "Azure Application Gateway should not allow TLSv1.1 or lower",
                    "description": "Transport Layer Security (TLS), previously known as Secure Sockets Layer (SSL), is the standard security technology for establishing an encrypted link between a web server and a browser. This link ensures that all data passed between the web server and browsers remain private and encrypted. Application gateway supports both TLS termination at the gateway as well as end to end TLS encryption. The minimum allowed TLS version should be 1.2"
                },
                {
                    "masterTestId": "PR-AZR-CLD-AGW-002",
                    "type": "rego",
                    "rule": "file(applicationgateways.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AGW-002",
                            "eval": "data.rule.gw_waf",
                            "message": "data.rule.gw_waf_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/web-application-firewall/ag/ag-overview#application-gateway-waf-sku-pricing' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_AGW_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15", 
                                "APRA (CPS 234) Information Security-CPS234-16", 
                                "APRA (CPS 234) Information Security-CPS234-17", 
                                "APRA (CPS 234) Information Security-CPS234-21", 
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03", 
                                "CSA CCM v.4.0.1-DSP-10", 
                                "CSA CCM v.4.0.1-IVS-03", 
                                "CSA CCM v.4.0.1-UEM-11", 
                                "CyberSecurity Law of the People's Republic of China-Article 21", 
                                "CyberSecurity Law of the People's Republic of China-Article 40", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.185", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.s", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1", 
                                "ISO/IEC 27002:2013-12.2.1", 
                                "ISO/IEC 27002:2013-12.3.1", 
                                "ISO/IEC 27002:2013-13.1.1", 
                                "ISO/IEC 27002:2013-13.1.2", 
                                "ISO/IEC 27002:2013-13.1.3", 
                                "ISO/IEC 27002:2013-13.2.1", 
                                "ISO/IEC 27002:2013-13.2.3", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.1.3", 
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-8.3.1", 
                                "ISO/IEC 27002:2013-8.3.3", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2", 
                                "ISO/IEC 27017:2015-6.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2", 
                                "ISO/IEC 27018:2019-12.3.1", 
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1190 - Exploit Public-Facing Application", 
                                "MITRE ATT&CK v6.3-T1190", 
                                "MITRE ATT&CK v8.2-T1190", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Transmission Confidentiality and Integrity | Cryptographic Protection", 
                                "NIST 800-53 Rev4-SC-8 (1)",
                                "NIST CSF", 
                                "NIST CSF-PR.DS-2", 
                                "NIST CSF-PR.DS-5",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.13.8", 
                                "NIST SP 800-172-3.4.1e", 
                                "NIST SP 800-172-3.4.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-2.3", 
                                "PCI DSS v3.2.1-4.1", 
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_221"
                    ],
                    "severity": "Medium",
                    "title": "Azure Application Gateway should have the Web application firewall (WAF) enabled",
                    "description": "Azure Web Application Firewall (WAF) on Azure Application Gateway provides centralized protection of your web applications from common exploits and vulnerabilities. Web applications are increasingly targeted by malicious attacks that exploit commonly known vulnerabilities. SQL injection and cross-site scripting are among the most common attacks."
                },
                {
                    "masterTestId": "PR-AZR-CLD-AGW-003",
                    "type": "rego",
                    "rule": "file(applicationgateways.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AGW-003",
                            "eval": "data.rule.protocol",
                            "message": "data.rule.protocol_err",
                            "remediationDescription": "Use following az cli command to configure https protocol on azure application gateway: az network application-gateway create --name --resource-group --http-settings-protocol Https<br><br>References:<br><a href='https://docs.microsoft.com/en-us/cli/azure/network/application-gateway?view=azure-cli-latest' target='_blank'>https://docs.microsoft.com/en-us/cli/azure/network/application-gateway?view=azure-cli-latest</a>",
                            "remediationFunction": "PR_AZR_CLD_AGW_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15", 
                                "APRA (CPS 234) Information Security-CPS234-16", 
                                "APRA (CPS 234) Information Security-CPS234-17", 
                                "APRA (CPS 234) Information Security-CPS234-21", 
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03", 
                                "CSA CCM v.4.0.1-DSP-10", 
                                "CSA CCM v.4.0.1-IVS-03", 
                                "CSA CCM v.4.0.1-UEM-11", 
                                "CyberSecurity Law of the People's Republic of China-Article 21", 
                                "CyberSecurity Law of the People's Republic of China-Article 40", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.185", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.s", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1", 
                                "ISO/IEC 27002:2013-12.2.1", 
                                "ISO/IEC 27002:2013-12.3.1", 
                                "ISO/IEC 27002:2013-13.1.1", 
                                "ISO/IEC 27002:2013-13.1.2", 
                                "ISO/IEC 27002:2013-13.1.3", 
                                "ISO/IEC 27002:2013-13.2.1", 
                                "ISO/IEC 27002:2013-13.2.3", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.1.3", 
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-8.3.1", 
                                "ISO/IEC 27002:2013-8.3.3", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2", 
                                "ISO/IEC 27017:2015-6.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2", 
                                "ISO/IEC 27018:2019-12.3.1", 
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1190 - Exploit Public-Facing Application", 
                                "MITRE ATT&CK v6.3-T1190", 
                                "MITRE ATT&CK v8.2-T1190", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Transmission Confidentiality and Integrity | Cryptographic Protection", 
                                "NIST 800-53 Rev4-SC-8 (1)",
                                "NIST CSF", 
                                "NIST CSF-PR.DS-2", 
                                "NIST CSF-PR.DS-5",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.13.8", 
                                "NIST SP 800-172-3.4.1e", 
                                "NIST SP 800-172-3.4.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-2.3", 
                                "PCI DSS v3.2.1-4.1", 
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_221"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Application Gateway is using Https protocol",
                    "description": "Application Gateway allows setting network protocols Http and Https. It is highly recommended to use Https protocol for secure connections."
                },
                {
                    "masterTestId": "PR-AZR-CLD-AGW-004",
                    "type": "rego",
                    "rule": "file(applicationgateways.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AGW-004",
                            "eval": "data.rule.frontendPublicIPConfigurationsDisabled",
                            "message": "data.rule.frontendPublicIPConfigurationsDisabled_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/application-gateway/configuration-front-end-ip' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_AGW_004.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_221"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Application Gateway frontendIPConfigurations does not have public ip configured",
                    "description": "Application Gateway allows setting public or private ip in frontendIPConfigurations. It is highly recommended to only configure private ip in frontendIPConfigurations."
                },
                {
                    "masterTestId": "PR-AZR-CLD-AGW-005",
                    "type": "rego",
                    "rule": "file(applicationgateways.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AGW-005",
                            "eval": "data.rule.backend_https_protocol_enabled",
                            "message": "data.rule.backend_https_protocol_enabled_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/application-gateway/end-to-end-ssl-portal' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_AGW_005.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_221"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Application Gateway Backend is using Https protocol",
                    "description": "Application Gateway allows setting backend network protocols Http and Https. It is highly recommended to use Https protocol for secure connections."
                },
                {
                    "masterTestId": "PR-AZR-CLD-AGW-006",
                    "type": "rego",
                    "rule": "file(applicationgateways.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AGW-006",
                            "eval": "data.rule.secret_certificate_is_in_keyvalut",
                            "message": "data.rule.secret_certificate_is_in_keyvalut_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/application-gateway/key-vault-certs' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_AGW_006.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_221"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Application Gateway secret certificates stores in keyvault",
                    "description": "This policy will identify application gateways that don't have SSL certificates stored in keyVault and alert"
                },
                {
                    "masterTestId": "PR-AZR-CLD-AGW-007",
                    "type": "rego",
                    "rule": "file(applicationgateways.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AGW-007",
                            "eval": "data.rule.application_gateways_v2_waf_ruleset_OWASP_active",
                            "message": "data.rule.application_gateways_v2_waf_ruleset_OWASP_active_err",
                            "remediationDescription": "In Azure Portal:<br>1. Navigate to the Application gateways<br>2. For each Application gateway:<br>3. Select Web application firewall from the menu<br>4. Make sure that Firewall Status is enabled and that tier is WAF.<br>Note: Choosing the WAF tier allows you to enable a web application firewall for enhanced security on your web applications. Changing from the WAF tier to the standard tier is not supported.",
                            "remediationFunction": "PR_AZR_CLD_AGW_007.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_221"
                    ],
                    "severity": "High",
                    "title": "Azure Application Gateway V2 should have the Web application firewall (WAF) enabled with minimum OWASP ModSecurity Core Rule Set (CRS) version 3.1 for proactive protection against CVE-2021-44228 exploit",
                    "description": "It is recommended to enable WAF policy with minimum OWASP ModSecurity Core Rule Set (CRS) version 3.1 on Application Gateway V2 to immediately avail of additional protection from log4j Remote Command Execution. details at <a href='https://www.microsoft.com/security/blog/2021/12/11/guidance-for-preventing-detecting-and-hunting-for-cve-2021-44228-log4j-2-exploitation/' target='_blank'>here</a>"
                },
                {
                    "masterTestId": "PR-AZR-CLD-ARC-001",
                    "type": "rego",
                    "rule": "file(Redis.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ARC-001",
                            "eval": "data.rule.enableSslPort",
                            "message": "data.rule.enableSslPort_err",
                            "remediationDescription": "In Azure Portal:<br>1. Go to Redis Caches.<br>2. For each Redis Cache:<br>3. Click on Advanced settings<br>4. Set the Allow access only via SSL to 'Yes'<br>5. Select Save<br><br>Default Value:<br>By default, non-SSL access is disabled for new caches.<br><br>References:<br><a href='https://docs.microsoft.com/en-us/azure/redis-cache/cache-configure#advanced-settings' target='_blank'>https://docs.microsoft.com/en-us/azure/redis-cache/cache-configure#advanced-settings</a>",
                            "remediationFunction": "PR_AZR_CLD_ARC_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "PCI-DSS",
                                "GDPR",
                                "ISO 27001",
                                "NIST CSF",
                                "HIPAA",
                                "Best Practice"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_420"
                    ],
                    "severity": "High",
                    "title": "Ensure that the Redis Cache accepts only SSL connections",
                    "description": "It is recommended that Redis Cache should allow only SSL connections. Note: some Redis tools (like redis-cli) do not support SSL. When using such tools plain connection ports should be enabled."
                },
                {
                    "masterTestId": "PR-AZR-CLD-ARC-002",
                    "type": "rego",
                    "rule": "file(Redis.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ARC-002",
                            "eval": "data.rule.serverRole",
                            "message": "data.rule.serverRole_err",
                            "remediationDescription": "In Azure Portal:<br>1. Go to Redis Caches.<br>2. For each Redis Cache:<br>3. Make sure you have at least 2 Redis Caches in Premium tier.<br>4. Click on Geo-replication<br>5. Click Add cache replication link<br>6. Click the name of the desired secondary cache from the Compatible caches list.<br>7. Click the 3 dots on the right to open the context menu.<br>8. Select Link as secondary.<br>8. Select Link.<br><br>Default Value:<br>No linked<br><br>References:<br><a href='https://docs.microsoft.com/en-us/azure/redis-cache/cache-how-to-geo-replication' target='_blank'>https://docs.microsoft.com/en-us/azure/redis-cache/cache-how-to-geo-replication</a>",
                            "remediationFunction": "PR_AZR_CLD_ARC_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "PCI-DSS",
                                "ISO 27001",
                                "NIST CSF",
                                "HIPAA",
                                "Best Practice"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_420"
                    ],
                    "severity": "Medium",
                    "title": "Redis cache should have a backup",
                    "description": "Replicate Redis Cache server data to another Redis Cache server using geo replication. This feature is only available for Premium tier Redis Cache. From performance point of view, Microsoft recommends that both Redis Caches (Primary and the linked secondary) reside in the same region."
                },
                {
                    "masterTestId": "PR-AZR-CLD-ARC-003",
                    "type": "rego",
                    "rule": "file(Redis.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ARC-003",
                            "eval": "data.rule.redis_public_access",
                            "message": "data.rule.redis_public_access_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/azure-cache-for-redis/cache-private-link' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_ARC_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_420"
                    ],
                    "severity": "Medium",
                    "title": "Azure Cache for Redis should disable public network access",
                    "description": "Disabling public network access improves security by ensuring that the Azure Cache for Redis isn't exposed on the public internet. You can limit exposure of your Azure Cache for Redis by creating private endpoints instead. Learn more at: https://docs.microsoft.com/azure/azure-cache-for-redis/cache-private-link."
                },
                {
                    "masterTestId": "PR-AZR-CLD-ARC-004",
                    "type": "rego",
                    "rule": "file(Redis.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ARC-004",
                            "eval": "data.rule.arc_subnet_id",
                            "message": "data.rule.arc_subnet_id_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/azure-cache-for-redis/cache-how-to-premium-vnet' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_ARC_004.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_420"
                    ],
                    "severity": "Medium",
                    "title": "Azure Cache for Redis should reside within a virtual network",
                    "description": "Azure Virtual Network deployment provides enhanced security and isolation for your Azure Cache for Redis, as well as subnets, access control policies, and other features to further restrict access.When an Azure Cache for Redis instance is configured with a virtual network, it is not publicly addressable and can only be accessed from virtual machines and applications within the virtual network."
                },
                {
                    "masterTestId": "PR-AZR-CLD-ARC-005",
                    "type": "rego",
                    "rule": "file(Redis.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ARC-005",
                            "eval": "data.rule.arc_private_endpoint",
                            "message": "data.rule.arc_private_endpoint_err",
                            "remediationDescription": "To create a private endpoint, follow these steps:<br><br>1. In the Azure portal, search for Azure Cache for Redis. Then, press enter or select it from the search suggestions.<br>2. Select the cache instance you want to add a private endpoint to.<br>3. On the left side of the screen, select Private Endpoint.<br>4. Select the Private Endpoint button to create your private endpoint.<br>5. On the Create a private endpoint page, configure the settings for your private endpoint.<br>6. Select the Next: Resource button at the bottom of the page.<br>7. In the Resource tab, select your subscription, choose the resource type as Microsoft.Cache/Redis, and then select the cache you want to connect the private endpoint to.<br>8. Select the Next: Configuration button at the bottom of the page.<br>9. In the Configuration tab, select the virtual network and subnet you created in the previous section.<br>10. Select the Next: Tags button at the bottom of the page.<br>11. Optionally, in the Tags tab, enter the name and value if you wish to categorize the resource.<br>12. Select Review + create. You're taken to the Review + create tab where Azure validates your configuration.<br>13. After the green Validation passed message appears, select Create.",
                            "remediationFunction": "PR_AZR_CLD_ARC_005.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_420",
                        "AZRSNP_500"
                    ],
                    "severity": "Medium",
                    "title": "Configure Azure Cache for redis with private endpoints",
                    "description": "Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your cache for redis, data leakage risks are reduced. Learn more about private links at - https://aka.ms/azureprivatelinkoverview"
                },
                {
                    "masterTestId": "PR-AZR-CLD-ARC-007",
                    "masterSnapshotId": [
                        "AZRSNP_420"
                    ],
                    "type": "rego",
                    "rule": "file(Redis.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ARC-007",
                            "eval": "data.rule.min_tls_version_redis",
                            "message": "data.rule.min_tls_version_redis_err",
                            "remediationDescription": "In Resource of type 'Microsoft.Cache/redis' make sure properties.minimumTlsVersion exists and value is set to '1.2'.<br>Please visit <a href='https://docs.microsoft.com/en-us/azure/templates/microsoft.cache/redis' target='_blank'>here</a> for more details.",
                            "remediationFunction": "PR_AZR_CLD_ARC_007.py"
                        }
                    ],
                    "severity": "High",
                    "title": "Ensure Azure Redis Cache has latest version of tls configured",
                    "description": "This policy will identify the Azure Redis Cache which doesn't have the latest version of tls configured and give the alert",
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ]
                },
                {
                    "masterTestId": "PR-AZR-CLD-ARC-008",
                    "masterSnapshotId": [
                        "AZRSNP_420",
                        "AZRSNP_422"
                    ],
                    "type": "rego",
                    "rule": "file(Redis.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ARC-008",
                            "eval": "data.rule.redis_cache_firewall_not_allowing_full_inbound_access",
                            "message": "data.rule.redis_cache_firewall_not_allowing_full_inbound_access_err",
                            "remediationDescription": "In 'Microsoft.Cache/redis' resource, set valid ip range other then '0.0.0.0' between 'start_ip' and 'end_ip' to fix the issue.<br>Please visit <a href='https://docs.microsoft.com/en-us/azure/templates/microsoft.cache/redis' target='_blank'>here</a> for more details.",
                            "remediationFunction": "PR_AZR_CLD_ARC_008.py"
                        }
                    ],
                    "severity": "High",
                    "title": "Redis Cache Firewall rules should not configure to allow full inbound access to everyone",
                    "description": "Firewalls grant access to redis cache based on the originating IP address of each request and should be within the range of START IP and END IP. Firewall settings with START IP and END IP both with 0.0.0.0 represents access to all Azure internal network. This setting needs to be turned-off to remove blanket access.",
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ]
                },
                {
                    "masterTestId": "PR-AZR-CLD-VM-001",
                    "type": "rego",
                    "rule": "file(vm.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-VM-001",
                            "eval": "data.rule.vm_aset",
                            "message": "data.rule.vm_aset_err",
                            "remediationDescription": "To assign Azure Virtual Machine to an availability set please refer to the following document:<br><br><a href='https://docs.microsoft.com/en-us/azure/virtual-machines/windows/manage-availability#configure-multiple-virtual-machines-in-an-availability-set-for-redundancy' target='_blank'>https://docs.microsoft.com/en-us/azure/virtual-machines/windows/manage-availability#configure-multiple-virtual-machines-in-an-availability-set-for-redundancy</a>",
                            "remediationFunction": "PR_AZR_CLD_VM_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_274"
                    ],
                    "severity": "Medium",
                    "title": "Azure Virtual Machine should be assigned to an availability set",
                    "description": "To provide application redundancy during planned or unplanned maintenance events, you can group two or more virtual machines (VMs) in an availability set. An availability set ensures that the VMs are distributed across multiple isolated hardware nodes in a cluster so that only a subset of your VMs are impacted should a hardware or software failure occur on Azure.<br><br>This policy identifies Azure VMs that are not deployed in an availability set. As a high availability (Ha) best practice, deploy your VMs in an availability set."
                },
                {
                    "masterTestId": "PR-AZR-CLD-VM-002",
                    "type": "rego",
                    "rule": "file(vm.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-VM-002",
                            "eval": "data.rule.linux_configuration",
                            "message": "data.rule.linux_configuration_err",
                            "remediationDescription": "To change the policy using the Azure Portal, follow these steps:<br><br><br>1. Log in to the Azure Portal at https://portal.azure.com.<br>2. Enter virtual machines in the search bar.<br>3. Under Services, select Virtual machines.<br>4. Under Administrator account, select SSH public key.<br>5. For SSH public key source, use the default Generate new key pair, then for Key pair name enter myKey.<br>6. Under Inbound port rules > Public inbound ports, select Allow selected ports, then select SSH (22) and HTTP (80) from the drop-down.<br>7. Leave the remaining defaults settings. At the bottom of the page click Review + create.",
                            "remediationFunction": "PR_AZR_CLD_VM_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_274"
                    ],
                    "severity": "High",
                    "title": "Azure Linux Instance should not use basic authentication(Use SSH Key Instead)",
                    "description": "SSH is an encrypted connection protocol that allows secure sign-ins over unsecured connections. SSH is the default connection protocol for Linux VMs hosted in Azure. Using secure shell (SSH) key pair, it is possible to spin up a Linux virtual machine on Azure that defaults to using SSH keys for authentication, eliminating the need for passwords to sign in. We recommend connecting to a VM using SSH keys. Using basic authentication with SSH connections leaves VMs vulnerable to brute-force attacks or guessing of passwords."
                },
                {
                    "masterTestId": "PR-AZR-CLD-VM-003",
                    "type": "rego",
                    "rule": "file(vmextensions.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-VM-003",
                            "eval": "data.rule.vm_protection",
                            "message": "data.rule.vm_protection_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/antimalware' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_VM_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_274"
                    ],
                    "severity": "Medium",
                    "title": "Azure Virtual Machine should have endpoint protection installed",
                    "description": "This policy identifies Azure Virtual Machines (VMs) that do not have endpoint protection installed. Installing endpoint protection systems (like Antimalware for Azure) provides for real-time protection capability that helps identify and remove viruses, spyware, and other malicious software. As a best practice, install endpoint protection on all VMs and computers to help identify and remove viruses, spyware, and other malicious software."
                },
                {
                    "masterTestId": "PR-AZR-CLD-DSK-001",
                    "type": "rego",
                    "rule": "file(disks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-DSK-001",
                            "eval": "data.rule.disk_encrypt",
                            "message": "data.rule.disk_encrypt_err",
                            "remediationDescription": "1. Attach the disk to the VM:<br>az vm disk attach --disk --new --resource-group --size-gb 128 --sku --vm-name<br><br>2. Enable encryption on the VM data disk:<br>az vm encryption enable --resource-group --vm-name --disk-encryption-keyvault --volume-type<br><br>References:<br><a href='https://docs.microsoft.com/en-us/cli/azure/vm/disk?view=azure-cli-latest#az-vm-disk-attach' target='_blank'>1. https://docs.microsoft.com/en-us/cli/azure/vm/disk?view=azure-cli-latest#az-vm-disk-attach</a><a href='https://docs.microsoft.com/en-us/azure/virtual-machines/windows/disk-encryption-windows#enable-encryption-on-a-newly-added-disk-with-azure-cli' target='_blank'>2. https://docs.microsoft.com/en-us/azure/virtual-machines/windows/disk-encryption-windows#enable-encryption-on-a-newly-added-disk-with-azure-cli</a>",
                            "remediationFunction": "PR_AZR_CLD_DSK_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15",
                                "APRA (CPS 234) Information Security-CPS234-16",
                                "APRA (CPS 234) Information Security-CPS234-17",
                                "APRA (CPS 234) Information Security-CPS234-21",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-DP-5",
                                "Azure Security Benchmark (v3)-DP-4",
                                "Azure Security Benchmark (v3)-DP-5",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CIS",
                                "CIS v1.1 (Azure)-7.1",
                                "CIS v1.2.0 (Azure)-7.2",
                                "CIS v1.3.0 (Azure)-7.2",
                                "CIS v1.3.1 (Azure)-7.2",
                                "CIS v1.4.0 (Azure)-7.2",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-UEM-11",
                                "CyberSecurity Law of the People's Republic of China-Article 30",
                                "CyberSecurity Law of the People's Republic of China-Article 31",
                                "CyberSecurity Law of the People's Republic of China-Article 40",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-CM.2.061",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:06.d",
                                "HITRUST v.9.4.2-Control Reference:09.s",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1",
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2",
                                "ISO/IEC 27018:2019-12.3.1",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Protection of Information at Rest",
                                "NIST 800-53 Rev 5-Remote Access | Protection of Confidentiality and Integrity Using Encryption",
                                "NIST 800-53 Rev4-AC-17 (2)",
                                "NIST 800-53 Rev4-SC-28",
                                "NIST CSF",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.16",
                                "NIST SP 800-172-3.1.3e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-3.4.1",
                                "PCI DSS v3.2.1-4.1",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_277"
                    ],
                    "severity": "Medium",
                    "title": "Azure disk should have Azure Disk Encryption (ADE) enabled",
                    "description": "To meet your organizational security or compliance requirement, Azure provides disk encryption at rest using Azure Storage Service Encryption (SSE) and Azure Disk Encryption (ADE). Starting February 2017, SSE is enabled by default for all managed disks. ADE is integrated with Azure Key Vault to help you control, manage, and audit the disk encryption keys and secrets.<br><br>This policy detects Virtual Machine (VM) OS disks that are not encrypted at rest using ADE. As a best practice, enable ADE for provide volume encryption for the OS disk. For more information, see https://docs.microsoft.com/en-us/azure/security/azure-security-disk-encryption-overview."
                },
                {
                    "masterTestId": "PR-AZR-CLD-DSK-002",
                    "type": "rego",
                    "rule": "file(disks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-DSK-002",
                            "eval": "data.rule.disk_encryption_2",
                            "message": "data.rule.disk_encryption_2_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/virtual-machines/disks-enable-customer-managed-keys-portal' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_DSK_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_277"
                    ],
                    "severity": "High",
                    "title": "Enable server-side encryption with customer-managed keys for managed disks",
                    "description": "Azure Disk Storage allows you to manage your own keys when using server-side encryption (SSE) for managed disks, if you choose"
                },
                {
                    "masterTestId": "PR-AZR-CLD-NET-004",
                    "type": "rego",
                    "rule": "file(vnetpeerings.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NET-004",
                            "eval": "data.rule.vnet_peer",
                            "message": "data.rule.vnet_peer_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/virtual-network/tutorial-connect-virtual-networks-portal' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NET_004.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-AIS-01",
                                "CSA CCM v.4.0.1-AIS-02",
                                "CSA CCM v.4.0.1-AIS-04",
                                "CSA CCM v.4.0.1-CCC-01",
                                "CSA CCM v.4.0.1-GRC-03",
                                "CSA CCM v.4.0.1-IVS-04",
                                "CSA CCM v.4.0.1-UEM-06",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.2.179",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.n",
                                "HITRUST v.9.4.2-Control Reference:01.o",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.1.2",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.2.1",
                                "ISO/IEC 27002:2013-14.2.2",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.1.2",
                                "ISO/IEC 27017:2015-14.1.1",
                                "ISO/IEC 27017:2015-14.1.2",
                                "ISO/IEC 27017:2015-14.2.1",
                                "ISO/IEC 27017:2015-14.2.5",
                                "ISO/IEC 27017:2015-5.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-12.1.2",
                                "NIST CSF",
                                "NIST CSF-PR.IP-1",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.4.2",
                                "NIST SP 800-172-3.4.1e",
                                "NIST SP 800-172-3.4.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_430"
                    ],
                    "severity": "Medium",
                    "title": "Azure virtual network peering state should be connected",
                    "description": "Virtual network peering enables you to connect two Azure virtual networks so that the resources in these networks are directly connected.<br><br>This policy identifies Azure virtual network peers that are disconnected. Typically, the disconnection happens when a peering configuration is deleted on one virtual network, and the other virtual network reports the peering status as disconnected."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NET-005",
                    "type": "rego",
                    "rule": "file(vnetsubnets.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NET-005",
                            "eval": "data.rule.vnet_subnet_nsg",
                            "message": "data.rule.vnet_subnet_nsg_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NET-005.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-07",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-DSP-17",
                                "CSA CCM v.4.0.1-HRS-04",
                                "CSA CCM v.4.0.1-IVS-03",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CSA CCM v.4.0.1-STA-14",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-05",
                                "CSA CCM v.4.0.1-UEM-11",
                                "CyberSecurity Law of the People's Republic of China-Article 21",
                                "CyberSecurity Law of the People's Republic of China-Article 25",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AC.1.001",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AC.1.002",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.n",
                                "HITRUST v.9.4.2-Control Reference:01.o",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-12.6.2",
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2",
                                "ISO/IEC 27002:2013-13.1.3",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-14.2.5",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-18.1.4",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-6.2.2",
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1",
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-16.1.2",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2",
                                "ISO/IEC 27018:2019-12.3.1",
                                "ISO/IEC 27018:2019-18.2.1",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Boundary Protection | Separate Subnets for Connecting to Different Security Domains",
                                "NIST 800-53 Rev4-SC-7 (22)",
                                "NIST CSF",
                                "NIST CSF-DE.AE-2",
                                "NIST CSF-DE.CM-6",
                                "NIST CSF-DE.CM-7",
                                "NIST CSF-DE.DP-2",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-PR.AC-5",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5",
                                "NIST CSF-PR.PT-4",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6",
                                "NIST SP 800-171 Revision 2-3.14.6",
                                "NIST SP 800-172-3.14.3e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_275"
                    ],
                    "severity": "Medium",
                    "title": "Azure Virtual Network subnet should be configured with Network Security Group",
                    "description": "This policy identifies Azure Virtual Network (VNet) subnet which doesn't have any association with Network Security Group (NSG). While binding an NSG to a network interface of a Virtual Machine (VM) enables fine-grained control to the VM, associating a NSG to a subnet enables better control over network traffic to all resources within a subnet. As a best practice, associate an NSG with a subnet so that you can protect your VMs on a subnet-level.<br><br>For more information, see https://blogs.msdn.microsoft.com/igorpag/2016/05/14/azure-network-security-groups-nsg-best-practices-and-lessons-learned/"
                },
                {
                    "masterTestId": "PR-AZR-CLD-NET-006",
                    "type": "rego",
                    "rule": "file(vpngateways.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NET-006",
                            "eval": "data.rule.vpn_encrypt",
                            "message": "data.rule.vpn_encrypt_err",
                            "remediationDescription": "With Azure CLI:<br>az network vpn-connection ipsec-policy add -g MyResourceGroup --connection-name MyConnection --dh-group DHGroup14 --ike-encryption AES256 --ike-integrity SHA384 --ipsec-encryption DES3 --ipsec-integrity GCMAES256 --pfs-group PFS2048 --sa-lifetime 27000 --sa-max-size 102400000<br><br>References:<br><a href='https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-about-compliance-crypto' target='_blank'>1. https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-about-compliance-crypto</a><br><a href='https://docs.microsoft.com/en-us/cli/azure/network/vpn-connection/ipsec-policy?view=azure-cli-latest#az_network_vpn_connection_ipsec_policy_add' target='_blank'>2. https://docs.microsoft.com/en-us/cli/azure/network/vpn-connection/ipsec-policy?view=azure-cli-latest#az_network_vpn_connection_ipsec_policy_add</a>",
                            "remediationFunction": "PR_AZR_CLD_NET_006.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15",
                                "APRA (CPS 234) Information Security-CPS234-16",
                                "APRA (CPS 234) Information Security-CPS234-17",
                                "APRA (CPS 234) Information Security-CPS234-21",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-IVS-03",
                                "CSA CCM v.4.0.1-UEM-11",
                                "CyberSecurity Law of the People's Republic of China-Article 30",
                                "CyberSecurity Law of the People's Republic of China-Article 31",
                                "CyberSecurity Law of the People's Republic of China-Article 40",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216",
                                "GDPR-Article 25",
                                "GDPR-Article 32",
                                "HIPAA",
                                "HIPAA-164.312(e)(2)(ii)",
                                "HITRUST",
                                "HITRUST CSF v9.3-Control Reference:01.j",
                                "HITRUST CSF v9.3-Control Reference:01.y",
                                "HITRUST CSF v9.3-Control Reference:05.i",
                                "HITRUST CSF v9.3-Control Reference:09.s",
                                "ISO 27001:2013",
                                "ISO 27001:2013-A.10.1.2",
                                "ISO 27001:2013-A.13.1.1",
                                "ISO 27001:2013-A.14.1.2",
                                "ISO 27001:2013-A.9.2.5",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2",
                                "ISO/IEC 27002:2013-13.1.3",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1",
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2",
                                "ISO/IEC 27018:2019-12.3.1",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v6.3-T1108",
                                "MITRE ATT&CK v6.3-T1108",
                                "NIST 800",
                                "NIST 800-53 Rev4-AC-17 (2)",
                                "NIST CSF",
                                "NIST CSF-PR.DS-2",
                                "NIST CSF-PR.DS-5",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.8",
                                "NIST SP 800-172-3.1.3e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-4.1.1",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_307"
                    ],
                    "severity": "Medium",
                    "title": "Ensure VPN gateways is configured with cryptographic algorithm",
                    "description": "Azure VPN gateways to use a custom IPsec/IKE policy with specific cryptographic algorithms and key strengths, rather than the Azure default policy sets. IPsec and IKE protocol standard supports a wide range of cryptographic algorithms in various combinations. If customers do not request a specific combination of cryptographic algorithms and parameters, Azure VPN gateways use a set of default proposals. Typically due to compliance or security requirements, you can now configure your Azure VPN gateways to use a custom IPsec/IKE policy with specific cryptographic algorithms and key strengths, rather than the Azure default policy sets. It is thus recommended to use custom policy sets and choose strong cryptography."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NTW-001",
                    "type": "rego",
                    "rule": "file(networkwatchersflowlogs.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NTW-001",
                            "eval": "data.rule.netwatchFlowlogs",
                            "message": "data.rule.netwatchFlowlogs_err",
                            "remediationDescription": "With Azure CLI:<br>az network watcher flow-log create --resource-group resourceGroupName --enabled true --nsg nsgName --storage-account storageAccountName --location location<br><br>References: <a href='https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-nsg-flow-logging-cli' target='_blank'>https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-nsg-flow-logging-cli</a>",
                            "remediationFunction": "PR_AZR_CLD_NTW_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "APRA (CPS 234) Information Security-CPS234-35",
                                "APRA (CPS 234) Information Security-CPS234-36",
                                "Brazilian Data Protection Law (LGPD)-Article 31",
                                "Brazilian Data Protection Law (LGPD)-Article 48",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-06",
                                "CSA CCM v.4.0.1-LOG-08",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CyberSecurity Law of the People's Republic of China-Article 55",
                                "CyberSecurity Law of the People's Republic of China-Article 56",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AU.3.046",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.ab",
                                "HITRUST v.9.4.2-Control Reference:09.ac",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.4.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.4.4",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.4.1",
                                "ISO/IEC 27017:2015-12.4.4",
                                "ISO/IEC 27017:2015-16.1.2",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1562.008 - Impair Defenses:Disable Cloud Logs",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Boundary Protection | External Telecommunications Services",
                                "NIST 800-53 Rev 5-System Monitoring | Analyze Communications Traffic Anomalies",
                                "NIST 800-53 Rev 5-System Monitoring | Analyze Traffic and Event Patterns",
                                "NIST 800-53 Rev 5-System Monitoring | System-wide Intrusion Detection System",
                                "NIST 800-53 Rev4-SC-7 (4)(b)",
                                "NIST 800-53 Rev4-SI-4 (1)",
                                "NIST 800-53 Rev4-SI-4 (11)",
                                "NIST 800-53 Rev4-SI-4 (13)",
                                "NIST CSF",
                                "NIST CSF-PR.PT-1",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.3.4",
                                "NIST SP 800-172-3.14.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-10.2.3",
                                "PCI DSS v3.2.1-10.6",
                                "PIPEDA",
                                "PIPEDA-4.1.4"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_431"
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Watcher Network Security Group (NSG) flow logs should be enabled",
                    "description": "This policy identifies Azure Network Security Groups (NSG) for which flow logs are disabled. To perform this check, enable this action on the Azure Service Principal: 'Microsoft.Network/networkWatchers/queryFlowLogStatus/action'.<br><br>NSG flow logs, a feature of the Network Watcher app, enable you to view information about ingress and egress IP traffic through an NSG. The flow logs include information such as:<br>- Outbound and inbound flows on a per-rule basis.<br>- Network interface to which the flow applies.<br>- 5-tuple information about the flow (source/destination IP, source/destination port, protocol).<br>- Whether the traffic was allowed or denied.<br><br>As a best practice, enable NSG flow logs to improve network visibility."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NTW-002",
                    "type": "rego",
                    "rule": "file(networkwatchersflowlogs.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NTW-002",
                            "eval": "data.rule.netwatch_logs",
                            "message": "data.rule.netwatch_logs_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/network-watcher/traffic-analytics' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NTW_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_431"
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Watcher Network Security Group (NSG) traffic analytics should be enabled",
                    "description": "This policy identifies Azure Network Security Groups (NSG) for which flow logs are disabled. To perform this check, enable this action on the Azure Service Principal: 'Microsoft.Network/networkWatchers/queryFlowLogStatus/action'.<br><br>NSG flow logs, a feature of the Network Watcher app, enable you to view information about ingress and egress IP traffic through an NSG. The flow logs include information such as:<br>- Outbound and inbound flows on a per-rule basis.<br>- Network interface to which the flow applies.<br>- 5-tuple information about the flow (source/destination IP, source/destination port, protocol).<br>- Whether the traffic was allowed or denied.<br><br>As a best practice, enable NSG flow logs to improve network visibility."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NTW-003",
                    "type": "rego",
                    "rule": "file(networkwatchersflowlogs.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NTW-003",
                            "eval": "data.rule.netwatch_log_retention",
                            "message": "data.rule.netwatch_log_retention_err",
                            "remediationDescription": "With Azure CLI:<br>Keep Flow-Logs forever:<br>az network watcher flow-log configure -g MyResourceGroup --nsg MyNsg --retention 0<br>Keep Flow-Logs for a specific period of time (100 days):<br>az network watcher flow-log configure -g MyResourceGroup --nsg MyNsg --retention 100<br><br>References: <a href='https://docs.microsoft.com/en-us/cli/azure/network/watcher/flow-log?view=azure-cli-latest#az_network_watcher_flow_log_configure' target='_blank'>https://docs.microsoft.com/en-us/cli/azure/network/watcher/flow-log?view=azure-cli-latest#az_network_watcher_flow_log_configure</a>",
                            "remediationFunction": "PR_AZR_CLD_NTW_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "APRA (CPS 234) Information Security-CPS234-35",
                                "APRA (CPS 234) Information Security-CPS234-36",
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-LT-6",
                                "Azure Security Benchmark (v3)-LT-6",
                                "Brazilian Data Protection Law (LGPD)-Article 16",
                                "Brazilian Data Protection Law (LGPD)-Article 40",
                                "CISs",
                                "CIS v1.1 (Azure)-6.4",
                                "CIS v1.2.0 (Azure)-6.4",
                                "CIS v1.3.0 (Azure)-6.4",
                                "CIS v1.3.1 (Azure)-6.4",
                                "CIS v1.4.0 (Azure)-6.4",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-06",
                                "CSA CCM v.4.0.1-LOG-08",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CyberSecurity Law of the People's Republic of China-Article 34",
                                "CyberSecurity Law of the People's Republic of China-Article 55",
                                "CyberSecurity Law of the People's Republic of China-Article 56",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AU.2.042",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:06.c",
                                "HITRUST v.9.4.2-Control Reference:06.d",
                                "HITRUST v.9.4.2-Control Reference:09.ab",
                                "HITRUST v.9.4.2-Control Reference:09.ac",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.4.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.4.4",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.4.1",
                                "ISO/IEC 27017:2015-12.4.4",
                                "ISO/IEC 27017:2015-16.1.2",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Audit Record Retention",
                                "NIST 800-53 Rev4-AU-11",
                                "NIST CSF",
                                "NIST CSF-DE.AE-2",
                                "NIST CSF-DE.CM-3",
                                "NIST CSF-PR.PT-1",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.3.2",
                                "NIST SP 800-172-3.1.1e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-10.2.3",
                                "PCI DSS v3.2.1-10.6",
                                "PCI DSS v3.2.1-3.1"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_431"
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Watcher Network Security Group (NSG) flow logs retention should be greater than 90 days",
                    "description": "This policy identifies Azure Network Security Groups (NSG) for which flow logs retention period is 90 days or less. To perform this check, enable this action on the Azure Service Principal: 'Microsoft.Network/networkWatchers/queryFlowLogStatus/action'.<br><br>NSG flow logs, a feature of the Network Watcher app, enable you to view information about ingress and egress IP traffic through an NSG. The flow logs include information such as:<br>- Outbound and inbound flows on a per-rule basis.<br>- Network interface to which the flow applies.<br>- 5-tuple information about the flow (source/destination IP, source/destination port, protocol).<br>- Whether the traffic was allowed or denied.<br><br>As a best practice, enable NSG flow logs and set the log retention period to at least 90 days."
                },
                {
                    "masterTestId": "PR-AZR-CLD-DBK-001",
                    "type": "rego",
                    "rule": "file(databricks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-DBK-001",
                            "eval": "data.rule.databrics_workspace_has_public_ip_disabled",
                            "message": "data.rule.databrics_workspace_has_public_ip_disabled_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/databricks/administration-guide/cloud-configurations/azure/vnet-inject' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_DBK_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Analytics"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_440"
                    ],
                    "severity": "High",
                    "title": "Azure Databricks should not use public IP address",
                    "description": "Azure Databricks is a data analytics platform optimized for the Microsoft Azure cloud services platform. This policy will identify Databricks which does not have public ip disabled and warn."
                },
                {
                    "masterTestId": "PR-AZR-CLD-DBK-002",
                    "type": "rego",
                    "rule": "file(databricks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-DBK-002",
                            "eval": "data.rule.databrics_workspace_has_vnet_integration",
                            "message": "data.rule.databrics_workspace_has_vnet_integration_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/databricks/administration-guide/cloud-configurations/azure/vnet-inject' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_DBK_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Analytics"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_440",
                        "AZRSNP_284"
                    ],
                    "severity": "Medium",
                    "title": "Azure Databricks should have vnet integration",
                    "description": "Azure Databricks is a data analytics platform optimized for the Microsoft Azure cloud services platform. This policy will identify Databricks which does not have vnet integration and warn."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-028",
                    "type": "rego",
                    "rule": "file(postgreSQL.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-028",
                            "eval": "data.rule.geoRedundantBackup",
                            "message": "data.rule.geoRedundantBackup_err",
                            "remediationDescription": "Configuring locally redundant or geo-redundant storage for backup is only allowed during server create. Once the server is provisioned, you cannot change the backup storage redundancy option.<br><br>To create an Azure Database for PostgreSQL server, take the following steps:<br>1. Select the Create a resource button (+) in the upper-left corner of the portal<br>2. Select Databases > Azure Database for PostgreSQL<br>3. Select the Single server deployment option<br>4. Fill out the Basics form required information<br>5. Ensure Backup Redundancy option is Geo_redundant<br><br>For More Information:<a href='https://docs.microsoft.com/en-us/azure/postgresql/concepts-backup' target='_blank'>https://docs.microsoft.com/en-us/azure/postgresql/concepts-backup</a>",
                            "remediationFunction": "PR_AZR_CLD_SQL_028.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_412"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Geo-redundant backup is enabled on PostgreSQL database server.",
                    "description": "Azure Database for PostgreSQL provides the flexibility to choose between locally redundant or geo-redundant backup storage in the General Purpose and Memory Optimized tiers. When the backups are stored in geo-redundant backup storage, they are not only stored within the region in which your server is hosted, but are also replicated to a paired data center. This provides better protection and ability to restore your server in a different region in the event of a disaster. The Basic tier only offers locally redundant backup storage."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-029",
                    "type": "rego",
                    "rule": "file(postgreSQL.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-029",
                            "eval": "data.rule.sslEnforcement",
                            "message": "data.rule.sslEnforcement_err",
                            "remediationDescription": "1. Go to 'PostgreSQL server' from Azure Management console and choose your PostgreSQL database server that you want to examine.<br>2. In the navigation panel, under Settings, select Connection security.<br>3. On the Connection security configuration page, under SSL settings section, select ENABLED next to Enforce SSL connection setting.<br>4. Click Save.",
                            "remediationFunction": "PR_AZR_CLD_SQL_029.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15",
                                "APRA (CPS 234) Information Security-CPS234-16",
                                "APRA (CPS 234) Information Security-CPS234-17",
                                "APRA (CPS 234) Information Security-CPS234-21",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-DP-4",
                                "Azure Security Benchmark (v3)-DP-3",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CIS",
                                "CIS v1.1 (Azure)-4.13",
                                "CIS v1.2.0 (Azure)-4.3.1",
                                "CIS v1.3.0 (Azure)-4.3.1",
                                "CIS v1.3.1 (Azure)-4.3.1",
                                "CIS v1.4.0 (Azure)-4.3.1",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-IVS-03",
                                "CSA CCM v.4.0.1-UEM-11",
                                "CyberSecurity Law of the People's Republic of China-Article 21",
                                "CyberSecurity Law of the People's Republic of China-Article 40",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.185",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.s",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2",
                                "ISO/IEC 27002:2013-13.1.3",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1",
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2",
                                "ISO/IEC 27018:2019-12.3.1",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Transmission Confidentiality and Integrity | Cryptographic Protection",
                                "NIST 800-53 Rev4-SC-8 (1)",
                                "NIST CSF",
                                "NIST CSF-PR.DS-2",
                                "NIST CSF-PR.DS-5",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.8",
                                "NIST SP 800-172-3.1.3e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-2.3",
                                "PCI DSS v3.2.1-4.1"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_412"
                    ],
                    "severity": "Medium",
                    "title": "Ensure ssl enforcement is enabled on PostgreSQL Database Server.",
                    "description": "Enable SSL connection on PostgreSQL Servers. Rationale: SSL connectivity helps to provide a new layer of security, by connecting database server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between database server and client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and application."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-066",
                    "type": "rego",
                    "rule": "file(postgreSQL.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-066",
                            "eval": "data.rule.postgresql_public_access_disabled",
                            "message": "data.rule.postgresql_public_access_disabled_err",
                            "remediationDescription": "1. In the Azure portal, select your existing Azure Database for PostgreSQL Single server.<br>2. On the PostgreSQL Single server page, under Settings, click Connection security to open the connection security configuration page.<br>3. In Deny Public Network Access, select Yes to enable deny public access for your PostgreSQL Single server.<br>4. Click Save to save the changes.<br>5. A notification will confirm that connection security setting was successfully enabled.",
                            "remediationFunction": "PR_AZR_CLD_SQL_066.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15",
                                "APRA (CPS 234) Information Security-CPS234-16",
                                "APRA (CPS 234) Information Security-CPS234-17",
                                "APRA (CPS 234) Information Security-CPS234-21",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-LT-6",
                                "Azure Security Benchmark (v3)-GS-9",
                                "Azure Security Benchmark (v3)-NS-1",
                                "Azure Security Benchmark (v3)-NS-2",
                                "Azure Security Benchmark (v3)-NS-3",
                                "Azure Security Benchmark (v3)-NS-4",
                                "Azure Security Benchmark (v3)-NS-5",
                                "Azure Security Benchmark (v3)-NS-6",
                                "Azure Security Benchmark (v3)-NS-7",
                                "Azure Security Benchmark (v3)-NS-8",
                                "CIS",
                                "CIS v1.2.0 (Azure)-4.3.9",
                                "CIS v1.3.0 (Azure)-4.3.8",
                                "CIS v1.3.1 (Azure)-4.3.8",
                                "CIS v1.4.0 (Azure)-4.3.7",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-DSP-17",
                                "CSA CCM v.4.0.1-IAM-04",
                                "CSA CCM v.4.0.1-IAM-05",
                                "CSA CCM v.4.0.1-IAM-09",
                                "CSA CCM v.4.0.1-IAM-16",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.c",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-18.1.4",
                                "ISO/IEC 27002:2013-6.1.2",
                                "ISO/IEC 27002:2013-9.1.1",
                                "ISO/IEC 27002:2013-9.1.2",
                                "ISO/IEC 27002:2013-9.2.3",
                                "ISO/IEC 27002:2013-9.2.5",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-9.2.3",
                                "ISO/IEC 27017:2015-9.2.5",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-9.2.3",
                                "ISO/IEC 27018:2019-9.2.5",
                                "NIST CSF",
                                "NIST CSF-PR.AC-4",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.1.5",
                                "NIST SP 800-172-3.1.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-7.1",
                                "PCI DSS v3.2.1-7.1.2"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_412"
                    ],
                    "severity": "Medium",
                    "title": "Ensure PostgreSQL servers don't have public network access enabled",
                    "description": "Always use Private Endpoint for PostgreSQL Server"
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-067",
                    "type": "rego",
                    "rule": "file(postgreSQL.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-067",
                            "eval": "data.rule.pg_ingress_from_any_ip_disabled",
                            "message": "data.rule.pg_ingress_from_any_ip_disabled_err",
                            "remediationDescription": "1.Login to Azure Portal<br>2.Click on 'All services' on left Navigation<br>3.Click on 'Azure Database for PostgreSQL servers' under Databases<br>4.Click on reported server instance<br>5.Click on 'Connection security' under Settings<br>6.Delete the rule which has 'Start IP' as 0.0.0.0 and 'End IP' as 255.255.255.255 under 'Firewall rule name' section<br>7.Click on 'Save'",
                            "remediationFunction": "PR_AZR_CLD_SQL_067.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-07",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-DSP-17",
                                "CSA CCM v.4.0.1-HRS-04",
                                "CSA CCM v.4.0.1-IVS-03",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CSA CCM v.4.0.1-STA-14",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-05",
                                "CSA CCM v.4.0.1-UEM-11",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.n",
                                "HITRUST v.9.4.2-Control Reference:01.o",
                                "ISO/IEC",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-12.6.2",
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2",
                                "ISO/IEC 27002:2013-13.1.3",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-14.2.5",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-18.1.4",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-6.2.2",
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015-10.1.1",
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-16.1.2",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019-10.1.2",
                                "ISO/IEC 27018:2019-12.3.1",
                                "ISO/IEC 27018:2019-18.2.1",
                                "NIST CSF",
                                "NIST CSF-DE.AE-2",
                                "NIST CSF-DE.CM-6",
                                "NIST CSF-DE.CM-7",
                                "NIST CSF-DE.DP-2",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-PR.AC-5",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5",
                                "NIST CSF-PR.PT-4",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6",
                                "NIST SP 800-171 Revision 2-3.14.6",
                                "NIST SP 800-172-3.14.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_412"
                    ],
                    "severity": "High",
                    "title": "PostgreSQL Database Server should not allow ingress from all Azure-internal IP addresses (0.0.0.0/0)",
                    "description": "This policy will identify PostgreSQL Database Server firewall rule that are currently allowing ingress from all Azure-internal IP addresses"
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-068",
                    "type": "rego",
                    "rule": "file(postgreSQL.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-068",
                            "eval": "data.rule.postgresql_infrastructure_encryption_enabled",
                            "message": "data.rule.postgresql_infrastructure_encryption_enabled_err",
                            "remediationDescription": "Configuring Infrastructure double encryption for Azure Database for PostgreSQL is only allowed during server create. Once the server is provisioned, you cannot change the storage encryption.<br><br>To create an Azure Database for PostgreSQL server with Infrastructure double encryption, follow below URL:<br>https://docs.microsoft.com/en-us/azure/postgresql/howto-double-encryption<br><br>NOTE: Using Infrastructure double encryption will have performance impact on the Azure Database for PostgreSQL server due to the additional encryption process.",
                            "remediationFunction": "PR_AZR_CLD_SQL_068.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v3)-DP-4",
                                "Azure Security Benchmark (v3)-DP-5",
                                "CIS",
                                "CIS v1.4.0 (Azure)-4.3.8"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_412"
                    ],
                    "severity": "Low",
                    "title": "Ensure PostgreSQL database server Infrastructure double encryption is enabled",
                    "description": "This policy identifies PostgreSQL database servers in which Infrastructure double encryption is disabled. Infrastructure double encryption adds a second layer of encryption using service-managed keys. It is recommended to enable infrastructure double encryption on PostgreSQL database servers so that encryption can be implemented at the layer closest to the storage device or network wires. For more details: https://docs.microsoft.com/en-us/azure/postgresql/concepts-infrastructure-double-encryption"
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-070",
                    "type": "rego",
                    "rule": "file(postgreSQL.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-070",
                            "eval": "data.rule.postgresql_log_retention_is_greater_than_three_days",
                            "message": "data.rule.postgresql_log_retention_is_greater_than_three_days_err",
                            "remediationDescription": "1. Login to Azure console.<br>2. Navigate to 'Azure Database for PostgreSQL servers' dashboard<br>3. Click on the alerted database name<br>4. Go to 'Server parameters' under 'Settings' block<br>5. For 'log_retention_days', enter value in range 4-7 (inclusive) and click on 'Save' button.",
                            "remediationFunction": "PR_AZR_CLD_SQL_070.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "APRA (CPS 234) Information Security-CPS234-35",
                                "APRA (CPS 234) Information Security-CPS234-36",
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v3)-LT-6",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CIS",
                                "CIS v1.1 (Azure)-4.18",
                                "CIS v1.2.0 (Azure)-4.3.8",
                                "CIS v1.3.0 (Azure)-4.3.7",
                                "CIS v1.3.1 (Azure)-4.3.7",
                                "CIS v1.4.0 (Azure)-4.3.6",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-06",
                                "CSA CCM v.4.0.1-LOG-08",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CyberSecurity Law of the People's Republic of China-Article 34",
                                "CyberSecurity Law of the People's Republic of China-Article 55",
                                "CyberSecurity Law of the People's Republic of China-Article 56",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:06.c",
                                "HITRUST v.9.4.2-Control Reference:06.d",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.4.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.4.4",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.4.1",
                                "ISO/IEC 27017:2015-12.4.4",
                                "ISO/IEC 27017:2015-16.1.2",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Audit Record Retention",
                                "NIST 800-53 Rev4-DM-2",
                                "NIST CSF",
                                "NIST CSF-DE.AE-2",
                                "NIST CSF-DE.CM-3",
                                "NIST CSF-PR.PT-1",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.3.2",
                                "NIST SP 800-172-3.1.1e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-3.1"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_412"
                    ],
                    "severity": "Medium",
                    "title": "Ensure PostgreSQL database server log retention days is greater than 3 days",
                    "description": "This policy identifies PostgreSQL database servers which have log retention days less than or equals to 3 days. Enabling log_retention_days helps PostgreSQL database server to Sets number of days a log file is retained which in turn generates query and error logs. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-071",
                    "type": "rego",
                    "rule": "file(postgreSQL.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-071",
                            "eval": "data.rule.azurerm_postgresql_configuration_connection_throttling",
                            "message": "data.rule.azurerm_postgresql_configuration_connection_throttling_err",
                            "remediationDescription": "1. Login to Azure console.<br>2. Navigate to 'Azure Database for PostgreSQL servers' dashboard<br>3. Click on the alerted database name<br>4. Go to 'Server parameters' under 'Settings' block<br>5. From the list of parameters find 'connection_throttling' and set it to on<br>6. Click on 'Save' button from top menu to save the change.",
                            "remediationFunction": "PR_AZR_CLD_SQL_071.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-LT-4",
                                "Azure Security Benchmark (v3)-DS-7",
                                "Brazilian Data Protection Law (LGPD)-Article 31",
                                "Brazilian Data Protection Law (LGPD)-Article 48",
                                "CIS",
                                "CIS v1.1 (Azure)-4.17",
                                "CIS v1.2.0 (Azure)-4.3.7",
                                "CIS v1.3.0 (Azure)-4.3.6",
                                "CIS v1.3.1 (Azure)-4.3.6",
                                "CIS v1.4.0 (Azure)-4.3.5",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-06",
                                "CSA CCM v.4.0.1-LOG-08",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AU.3.046",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.ab",
                                "HITRUST v.9.4.2-Control Reference:09.ac",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.4.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.4.4",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.4.1",
                                "ISO/IEC 27017:2015-12.4.4",
                                "ISO/IEC 27017:2015-16.1.2",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Configuration Settings",
                                "NIST 800-53 Rev4-CM-6",
                                "NIST CSF",
                                "NIST CSF-PR.PT-1",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.3.4",
                                "NIST SP 800-172-3.4.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-10.2.3",
                                "PCI DSS v3.2.1-10.6"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_412"
                    ],
                    "severity": "Medium",
                    "title": "PostgreSQL Database Server should have connection_throttling enabled",
                    "description": "This policy identifies PostgreSQL database servers for which server parameter is not set for connection throttling. Enabling connection_throttling helps the PostgreSQL Database to Set the verbosity of logged messages which in turn generates query and error logs with respect to concurrent connections, that could lead to a successful Denial of Service (DoS) attack by exhausting connection resources. A system can also fail or be degraded by an overload of legitimate users. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-072",
                    "type": "rego",
                    "rule": "file(postgreSQL.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-072",
                            "eval": "data.rule.azurerm_postgresql_configuration_log_checkpoints",
                            "message": "data.rule.azurerm_postgresql_configuration_log_checkpoints_err",
                            "remediationDescription": "1. Login to Azure console.<br>2. Navigate to 'Azure Database for PostgreSQL servers' dashboard<br>3. Click on the alerted database name<br>4. Go to 'Server parameters' under 'Settings' block<br>5. From the list of parameters find 'log_checkpoints' and set it to on<br>6. Click on 'Save' button from top menu to save the change.",
                            "remediationFunction": "PR_AZR_CLD_SQL_072.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "APRA (CPS 234) Information Security-CPS234-35",
                                "APRA (CPS 234) Information Security-CPS234-36",
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-LT-4",
                                "Azure Security Benchmark (v3)-DS-7",
                                "Brazilian Data Protection Law (LGPD)-Article 31",
                                "Brazilian Data Protection Law (LGPD)-Article 48",
                                "CIS",
                                "CIS v1.1 (Azure)-4.12",
                                "CIS v1.2.0 (Azure)-4.3.3",
                                "CIS v1.3.0 (Azure)-4.3.3",
                                "CIS v1.3.1 (Azure)-4.3.3",
                                "CIS v1.4.0 (Azure)-4.3.2",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-06",
                                "CSA CCM v.4.0.1-LOG-08",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CyberSecurity Law of the People's Republic of China-Article 55",
                                "CyberSecurity Law of the People's Republic of China-Article 56",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AU.3.046",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.ab",
                                "HITRUST v.9.4.2-Control Reference:09.ac",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.4.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.4.4",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.4.1",
                                "ISO/IEC 27017:2015-12.4.4",
                                "ISO/IEC 27017:2015-16.1.2",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Configuration Settings",
                                "NIST 800-53 Rev4-CM-6",
                                "NIST CSF",
                                "NIST CSF-PR.PT-1",
                                "NIST SP 800",
                                "NIST SP 800-171 Revision 2-3.3.4",
                                "NIST SP 800-172-3.4.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-10.2.3",
                                "PCI DSS v3.2.1-10.6"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_412"
                    ],
                    "severity": "Medium",
                    "title": "PostgreSQL Database Server should have log_checkpoints enabled",
                    "description": "This policy identifies PostgreSQL database servers for which server parameter is not set for log checkpoints. Enabling log_checkpoints helps the PostgreSQL Database to Log each checkpoint in turn generates query and error logs. However, access to transaction logs is not supported. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-073",
                    "type": "rego",
                    "rule": "file(postgreSQL.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-073",
                            "eval": "data.rule.azurerm_postgresql_configuration_log_connections",
                            "message": "data.rule.azurerm_postgresql_configuration_log_connections_err",
                            "remediationDescription": "1. Login to Azure console.<br>2. Navigate to 'Azure Database for PostgreSQL servers' dashboard<br>3. Click on the alerted database name<br>4. Go to 'Server parameters' under 'settings' block<br>5. From the list of parameters find 'log_connections' and set it to 'on'<br>6. Click on 'Save' button from top menu to save the change.",
                            "remediationFunction": "PR_AZR_CLD_SQL_073.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "APRA (CPS 234) Information Security-CPS234-35",
                                "APRA (CPS 234) Information Security-CPS234-36",
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-LT-4",
                                "Azure Security Benchmark (v3)-DS-7",
                                "Brazilian Data Protection Law (LGPD)-Article 31",
                                "Brazilian Data Protection Law (LGPD)-Article 48",
                                "CIS",
                                "CIS v1.1 (Azure)-4.14",
                                "CIS v1.2.0 (Azure)-4.3.4",
                                "CIS v1.3.0 (Azure)-4.3.4",
                                "CIS v1.3.1 (Azure)-4.3.4",
                                "CIS v1.4.0 (Azure)-4.3.3",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-06",
                                "CSA CCM v.4.0.1-LOG-08",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CyberSecurity Law of the People's Republic of China-Article 55",
                                "CyberSecurity Law of the People's Republic of China-Article 56",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AU.3.046",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.ab",
                                "HITRUST v.9.4.2-Control Reference:09.ac",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.4.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.4.4",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.4.1",
                                "ISO/IEC 27017:2015-12.4.4",
                                "ISO/IEC 27017:2015-16.1.2",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Configuration Settings",
                                "NIST 800-53 Rev4-CM-6",
                                "NIST CSF",
                                "NIST CSF-PR.PT-1",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.3.4",
                                "NIST SP 800-172-3.4.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-10.2.3",
                                "PCI DSS v3.2.1-10.6"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_412"
                    ],
                    "severity": "Medium",
                    "title": "PostgreSQL Database Server should have log_connections parameter enabled",
                    "description": "This policy identifies PostgreSQL database servers for which server parameter is not set for log connections. Enabling log_connections helps PostgreSQL Database to log attempted connection to the server, as well as successful completion of client authentication. Log data can be used to identify, troubleshoot, and repair configuration errors and suboptimal performance."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-074",
                    "type": "rego",
                    "rule": "file(postgreSQL.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-074",
                            "eval": "data.rule.azurerm_postgresql_configuration_log_disconnections",
                            "message": "data.rule.azurerm_postgresql_configuration_log_disconnections_err",
                            "remediationDescription": "1. Login to Azure console.<br>2. Navigate to 'Azure Database for PostgreSQL servers' dashboard<br>3. Click on the alerted database name<br>4. Go to 'Server parameters' under 'Settings' block<br>5. From the list of parameters find 'log_disconnections' and set it to on<br>6. Click on 'Save' button from top menu to save the change.",
                            "remediationFunction": "PR_AZR_CLD_SQL_074.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "APRA (CPS 234) Information Security-CPS234-35",
                                "APRA (CPS 234) Information Security-CPS234-36",
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-LT-4",
                                "Azure Security Benchmark (v3)-DS-7",
                                "Brazilian Data Protection Law (LGPD)-Article 31",
                                "Brazilian Data Protection Law (LGPD)-Article 48",
                                "CIS",
                                "CIS v1.1 (Azure)-4.15",
                                "CIS v1.2.0 (Azure)-4.3.5",
                                "CIS v1.3.0 (Azure)-4.3.5",
                                "CIS v1.3.1 (Azure)-4.3.5",
                                "CIS v1.4.0 (Azure)-4.3.4",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-06",
                                "CSA CCM v.4.0.1-LOG-08",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CyberSecurity Law of the People's Republic of China-Article 55",
                                "CyberSecurity Law of the People's Republic of China-Article 56",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AU.3.046",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.ab",
                                "HITRUST v.9.4.2-Control Reference:09.ac",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.4.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.4.4",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.4.1",
                                "ISO/IEC 27017:2015-12.4.4",
                                "ISO/IEC 27017:2015-16.1.2",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Configuration Settings",
                                "NIST 800-53 Rev4-CM-6",
                                "NIST CSF",
                                "NIST CSF-PR.PT-1",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.3.4",
                                "NIST SP 800-172-3.4.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-10.2.3",
                                "PCI DSS v3.2.1-10.6"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_412"
                    ],
                    "severity": "Medium",
                    "title": "PostgreSQL Database Server should have log_disconnections parameter enabled",
                    "description": "This policy identifies PostgreSQL database servers for which server parameter is not set for log disconnections. Enabling log_disconnections helps PostgreSQL Database to Logs end of a session, including duration, which in turn generates query and error logs. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance."
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-075",
                    "type": "rego",
                    "rule": "file(postgreSQL.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-075",
                            "eval": "data.rule.azurerm_postgresql_configuration_log_duration",
                            "message": "data.rule.azurerm_postgresql_configuration_log_duration_err",
                            "remediationDescription": "1. Login to Azure console.<br>2. Navigate to 'Azure Database for PostgreSQL servers' dashboard<br>3. Click on the alerted database name<br>4. Go to 'Server parameters' under 'Settings' block<br>5. From the list of parameters find 'log_duration' and set it to on<br>6. Click on 'Save' button from top menu to save the change.",
                            "remediationFunction": "PR_AZR_CLD_SQL_075.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Brazilian Data Protection Law (LGPD)-Article 31",
                                "Brazilian Data Protection Law (LGPD)-Article 48",
                                "CIS",
                                "CIS v1.1 (Azure)-4.16",
                                "CIS v1.2.0 (Azure)-4.3.6",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-06",
                                "CSA CCM v.4.0.1-LOG-08",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CyberSecurity Law of the People's Republic of China-Article 55",
                                "CyberSecurity Law of the People's Republic of China-Article 56",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AU.3.046",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.ab",
                                "HITRUST v.9.4.2-Control Reference:09.ac",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.4.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.4.4",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.4.1",
                                "ISO/IEC 27017:2015-12.4.4",
                                "ISO/IEC 27017:2015-16.1.2",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Configuration Settings",
                                "NIST 800-53 Rev4-CM-6",
                                "NIST CSF",
                                "NIST CSF-PR.PT-1",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.3.4",
                                "NIST SP 800-172-3.4.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-10.2.3",
                                "PCI DSS v3.2.1-10.6"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_412"
                    ],
                    "severity": "Medium",
                    "title": "PostgreSQL Database Server should have log_duration parameter enabled",
                    "description": "This policy identifies PostgreSQL database servers for which server parameter is not set for log duration. Enabling log_duration helps the PostgreSQL Database to Logs the duration of each completed SQL statement which in turn generates query and error logs. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance."
                },
                {
                    "masterTestId": "PR-AZR-CLD-ACR-001",
                    "type": "rego",
                    "rule": "file(registrieswebhooks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ACR-001",
                            "eval": "data.rule.acr_webhooks",
                            "message": "data.rule.acr_webhooks_err",
                            "remediationDescription": "1. Sign in to the Azure portal.<br>2. Navigate to the container registry in which you want to create a webhook.<br>3. Under Services, select Webhooks.<br>4. Select Add in the webhook toolbar.<br>5. Complete the Create webhook form with the following information: <a href='https://docs.microsoft.com/en-us/azure/container-registry/container-registry-webhook' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_ACR_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15", 
                                "APRA (CPS 234) Information Security-CPS234-16", 
                                "APRA (CPS 234) Information Security-CPS234-17", 
                                "APRA (CPS 234) Information Security-CPS234-21", 
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03", 
                                "CSA CCM v.4.0.1-DSP-10", 
                                "CSA CCM v.4.0.1-IVS-03", 
                                "CSA CCM v.4.0.1-UEM-11", 
                                "CyberSecurity Law of the People's Republic of China-Article 21", 
                                "CyberSecurity Law of the People's Republic of China-Article 40", 
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.185", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.s", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1", 
                                "ISO/IEC 27002:2013-12.2.1", 
                                "ISO/IEC 27002:2013-12.3.1", 
                                "ISO/IEC 27002:2013-13.1.1", 
                                "ISO/IEC 27002:2013-13.1.2", 
                                "ISO/IEC 27002:2013-13.1.3", 
                                "ISO/IEC 27002:2013-13.2.1", 
                                "ISO/IEC 27002:2013-13.2.3", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.1.3", 
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-8.3.1", 
                                "ISO/IEC 27002:2013-8.3.3", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2", 
                                "ISO/IEC 27017:2015-6.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2", 
                                "ISO/IEC 27018:2019-12.3.1", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Transmission Confidentiality and Integrity | Cryptographic Protection", 
                                "NIST 800-53 Rev4-SC-8 (1)", 
                                "NIST CSF",
                                "NIST CSF-PR.DS-2", 
                                "NIST CSF-PR.DS-5",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.13.8", 
                                "NIST SP 800-172-3.1.3e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-2.3", 
                                "PCI DSS v3.2.1-4.1"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_214"
                    ],
                    "severity": "Medium",
                    "title": "Azure ACR should have HTTPS protocol enabled for webhook",
                    "description": "Ensure you send container registry webhooks only to a HTTPS endpoint. This policy checks your container registry webhooks and alerts if it finds a URI with HTTP."
                },
                {
                    "masterTestId": "PR-AZR-CLD-ACR-002",
                    "type": "rego",
                    "rule": "file(registry.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ACR-002",
                            "eval": "data.rule.adminUserDisabled",
                            "message": "data.rule.adminUserDisabled_err",
                            "remediationDescription": "Azure Portal:<br>1. navigating to Azure container registry<br>2. select Access keys under SETTINGS<br>3. Disable under Admin user.",
                            "remediationFunction": "PR_AZR_CLD_ACR_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_224"
                    ],
                    "severity": "Medium",
                    "title": "Ensure that admin user is disabled for Container Registry",
                    "description": "The value that indicates whether the admin user is enabled. Each container registry includes an admin user account, which is disabled by default. You can enable the admin user and manage its credentials in the Azure portal, or by using the Azure CLI or other Azure tools. All users authenticating with the admin account appear as a single user with push and pull access to the registry. Changing or disabling this account disables registry access for all users who use its credentials."
                },
                {
                    "masterTestId": "PR-AZR-CLD-ACR-003",
                    "type": "rego",
                    "rule": "file(registry.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ACR-003",
                            "eval": "data.rule.acr_classic",
                            "message": "data.rule.acr_classic_err",
                            "remediationDescription": "Using Azure CLI:<br>az acr update --name --sku {Basic, Premium, Standard}<br><br>References : <a href='https://docs.microsoft.com/en-us/azure/container-registry/container-registry-skus' target='_blank'>https://docs.microsoft.com/en-us/azure/container-registry/container-registry-skus</a>",
                            "remediationFunction": "PR_AZR_CLD_ACR_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Brazilian Data Protection Law (LGPD)-Article 46", 
                                "Brazilian Data Protection Law (LGPD)-Article 6", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-AIS-01", 
                                "CSA CCM v.4.0.1-AIS-02", 
                                "CSA CCM v.4.0.1-AIS-04", 
                                "CSA CCM v.4.0.1-CCC-01", 
                                "CSA CCM v.4.0.1-GRC-03", 
                                "CSA CCM v.4.0.1-IVS-04", 
                                "CSA CCM v.4.0.1-UEM-06", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-IA.2.078", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:10.a", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.1.2, ISO/IEC 27002:2013-14.1.1", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.2.1", 
                                "ISO/IEC 27002:2013-14.2.2", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.1.2", 
                                "ISO/IEC 27017:2015-14.1.1", 
                                "ISO/IEC 27017:2015-14.1.2", 
                                "ISO/IEC 27017:2015-14.2.1", 
                                "ISO/IEC 27017:2015-14.2.5", 
                                "ISO/IEC 27017:2015-5.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-12.1.2", 
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1525 - Implant Internal Image", 
                                "MITRE ATT&CK v6.3-T1525", 
                                "MITRE ATT&CK v8.2-T1525", 
                                "NIST CSF",
                                "NIST CSF-PR.IP-1", 
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.4.2", 
                                "NIST SP 800-172-3.4.1e", 
                                "NIST SP 800-172-3.4.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-6.3"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_224"
                    ],
                    "severity": "Medium",
                    "title": "Azure Container Registry should not use the deprecated classic registry",
                    "description": "This policy identifies an Azure Container Registry (ACR) that is using the classic SKU. The initial release of the Azure Container Registry (ACR) service that was offered as a classic SKU is being deprecated and will be unavailable after April 2019. As a best practice, upgrade your existing classic registry to a managed registry.<br><br>For more information, visit https://docs.microsoft.com/en-us/azure/container-registry/container-registry-upgrade"
                },
                {
                    "masterTestId": "PR-AZR-CLD-ACR-004",
                    "type": "rego",
                    "rule": "file(registry.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ACR-004",
                            "eval": "data.rule.aci_configured_with_vnet",
                            "message": "data.rule.aci_configured_with_vnet_err",
                            "remediationDescription": "Virtual network can only be configured at the time of container instance creation. Hence, it is suggested to delete an existing container instance having not configured with virtual network and create a new container instance having virtual network configured with secure values.<br>Note: Backup or migrate data from the container instance before deleting it.<br><br>To create a Container Instance within a virtual network; follow below URL:<br>https://docs.microsoft.com/en-us/azure/container-instances/container-instances-vnet<br><br>To delete a reported Container instance; follow below URL:<br>https://docs.microsoft.com/en-us/azure/container-instances/container-instances-quickstart-portal#clean-up-resources",
                            "remediationFunction": "PR_AZR_CLD_ACR_004.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1190 - Exploit Public-Facing Application"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_226"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Azure Container Instance is configured with virtual network",
                    "description": "This policy identifies Azure Container Instances (ACI) that are not configured with a virtual network. Making container instances public makes an internet routable network. By deploying container instances into an Azure virtual network, your containers can communicate securely with other resources in the virtual network. So it is recommended to configure all your container instances within a virtual network.<br><br>For more details:<br>https://docs.microsoft.com/en-us/azure/container-instances/container-instances-vnet"
                },
                {
                    "masterTestId": "PR-AZR-CLD-ACR-005",
                    "type": "rego",
                    "rule": "file(registry.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ACR-005",
                            "eval": "data.rule.aci_configured_with_managed_identity",
                            "message": "data.rule.aci_configured_with_managed_identity_err",
                            "remediationDescription": "To enable managed identity on your container instance, follow below URL:<br>https://docs.microsoft.com/en-us/azure/container-instances/container-instances-managed-identity",
                            "remediationFunction": "PR_AZR_CLD_ACR_005.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1550 - Use Alternate Authentication Material"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_226"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Azure Container Instance is configured with managed identity",
                    "description": "This policy identifies Azure Container Instances (ACI) that are not configured with the managed identity. The managed identity is authenticated with Azure AD, developers don't have to store any credentials in code. So It is recommended to configure managed identity on all your container instances.<br><br>For more details:<br>https://docs.microsoft.com/en-us/azure/container-instances/container-instances-managed-identity"
                },
                {
                    "masterTestId": "PR-AZR-CLD-ACR-006",
                    "type": "rego",
                    "rule": "file(registry.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ACR-006",
                            "eval": "data.rule.acr_public_access_disabled",
                            "message": "data.rule.acr_public_access_disabled_err",
                            "remediationDescription": "1. Log in to the Azure portal<br>2. Select 'All services' > 'Container Registries'<br>3. Select the container registry you need to modify<br>4. Select 'Networking' under 'Settings'<br>5. Click on 'Public access' tab and select 'Selected networks' and provide the IPV4 address for which you want access to ACR or select 'Disabled' to disable Public access<br>6. Click on 'Save'<br><br>Note: 'Public access' setting can be toggled to 'Selected networks' or 'Disabled' state only with Premium SKU. For Standard and Basic SKU Public access setting cannot be updated and these resource will reamin accesiable to public.",
                            "remediationFunction": "PR_AZR_CLD_ACR_006.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1190 - Exploit Public-Facing Application"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_224"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Azure Container registries public access to All networks is disabled",
                    "description": "This policy identifies Azure Container registries which has Public access to All networks enabled. Azure ACR is used to store Docker container images which might contain sensitive information. It is highly recommended to restrict public access from allow access from Selected networks or make it Private by disabling the Public access."
                },
                {
                    "masterTestId": "PR-AZR-CLD-ACR-007",
                    "type": "rego",
                    "rule": "file(registry.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ACR-007",
                            "eval": "data.rule.acr_repository_scoped_access_token_disabled",
                            "message": "data.rule.acr_repository_scoped_access_token_disabled_err",
                            "remediationDescription": "01. In the portal, navigate to your container registry and select Repository permissions > Token (Preview).<br>02. On the Token details tab of each token, in Status, select Disabled.<br>03. Then select Save.",
                            "remediationFunction": "PR_AZR_CLD_ACR_007.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_224"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Azure Container registries repository scoped access token is disabled",
                    "description": "Disable repository scoped access tokens for your registry so that repositories are not accessible by tokens. Disabling local authentication methods like admin user, repository scoped access tokens and anonymous pull improves security by ensuring that container registries exclusively require Azure Active Directory identities for authentication. Learn more at: https://aka.ms/acr/authentication."
                },
                {
                    "masterTestId": "PR-AZR-CLD-ACR-008",
                    "type": "rego",
                    "rule": "file(registry.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ACR-008",
                            "eval": "data.rule.acr_has_premium_sku",
                            "message": "data.rule.acr_has_premium_sku_err",
                            "remediationDescription": "01. In the portal, navigate to your container registry Overview and select Update, then select Premium SKU from SKU drop-down.<br>02. Select Save.",
                            "remediationFunction": "PR_AZR_CLD_ACR_008.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_224"
                    ],
                    "severity": "Medium",
                    "title": "Container registries should have SKUs that support Private Links",
                    "description": "Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The private link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your container registries instead of the entire service, data leakage risks are reduced. Learn more at: https://aka.ms/acr/private-link."
                },
                {
                    "masterTestId": "PR-AZR-CLD-ACR-009",
                    "type": "rego",
                    "rule": "file(registry.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ACR-009",
                            "eval": "data.rule.acr_anonymous_auth_disabled",
                            "message": "data.rule.acr_anonymous_auth_disabled_err",
                            "remediationDescription": "Using Azure CLI, Disable anonymous pull access by running this command: 'az acr update --name <your-registry-name> --anonymous-pull-enabled false'.",
                            "remediationFunction": "PR_AZR_CLD_ACR_009.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_224"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Azure Container registries has anonymous authentication disabled",
                    "description": "Disable anonymous pull for your registry so that data not accessible by unauthenticated user. Disabling local authentication methods like admin user, repository scoped access tokens and anonymous pull improves security by ensuring that container registries exclusively require Azure Active Directory identities for authentication. Learn more at: https://aka.ms/acr/authentication."
                },
                {
                    "masterTestId": "PR-AZR-CLD-ACR-010",
                    "type": "rego",
                    "rule": "file(registry.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ACR-010",
                            "eval": "data.rule.acr_not_allowing_unrestricted_network_access",
                            "message": "data.rule.acr_not_allowing_unrestricted_network_access_err",
                            "remediationDescription": "01. To limit access to a selected public network, first change the default action to deny access. Substitute the name of your registry in the following Azure CLI az acr update command: 'az acr update --name <your-registry-name> --default-action Deny'.<br>02. In the portal, navigate to your container registry and select Settings > Networking.<br>03. On the Public access tab, in Allow public network access, select Disabled. Then select Save.",
                            "remediationFunction": "PR_AZR_CLD_ACR_010.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Azure_Security_Benchmark",
                                "Azure_Security_Benchmark_v2.0_NS-1",
                                "Azure_Security_Benchmark_v3.0_NS-2",
                                "CMMC",
                                "CMMC_2.0_L2_AC.L2-3.1.3",
                                "CMMC_2.0_L2_SC.L1-3.13.1",
                                "CMMC_2.0_L2_SC.L1-3.13.5",
                                "CMMC_2.0_L2_SC.L2-3.13.2",
                                "CMMC_2.0_L2_SC.L2-3.13.6",
                                "CMMC_L3_AC.1.001",
                                "CMMC_L3_AC.1.002",
                                "CMMC_L3_AC.2.016"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_224"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Azure Container registries should not allow unrestricted network access",
                    "description": "Azure container registries by default accept connections over the internet from hosts on any network. To protect your registries from potential threats, allow access from only specific private endpoints, public IP addresses or address ranges. If your registry doesn't have network rules configured, it will appear in the unhealthy resources. Learn more about Container Registry network rules here: https://aka.ms/acr/privatelink, https://aka.ms/acr/portal/public-network and https://aka.ms/acr/vnet."
                },
                {
                    "masterTestId": "PR-AZR-CLD-ACR-011",
                    "type": "rego",
                    "rule": "file(registry.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ACR-011",
                            "eval": "data.rule.acr_configured_with_private_endpoint",
                            "message": "data.rule.acr_configured_with_private_endpoint_err",
                            "remediationDescription": "01. In the portal, navigate to your container registry.<br>02. Under Settings, select Networking.<br>03. On the Private endpoints tab, select + Private endpoint.<br>04. Now visit <a href='https://learn.microsoft.com/en-us/azure/container-registry/container-registry-private-link#set-up-private-endpoint---portal-recommended' target='_blank'>here</a> for further instruction.",
                            "remediationFunction": "PR_AZR_CLD_ACR_011.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_224"
                    ],
                    "severity": "Medium",
                    "title": "Azure Container registries should have private endpoints configured",
                    "description": "Azure container registries by default accept connections over the internet from hosts on any network. To protect your registries from potential threats, allow access from only specific private endpoints, public IP addresses or address ranges. If your registry doesn't have network rules configured, it will appear in the unhealthy resources. Learn more about Container Registry network rules here: https://aka.ms/acr/privatelink, https://aka.ms/acr/portal/public-network and https://aka.ms/acr/vnet."
                },
                {
                    "masterTestId": "PR-AZR-CLD-ACR-012",
                    "type": "rego",
                    "rule": "file(registry.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ACR-012",
                            "eval": "data.rule.acr_has_arm_audience_token_auth_disabled",
                            "message": "data.rule.acr_has_arm_audience_token_auth_disabled_err",
                            "remediationDescription": "Run the Azure CLI command to disable the status of the registry's policy: 'az acr config authentication-as-arm update -r <registry> --status [disabled]'",
                            "remediationFunction": "PR_AZR_CLD_ACR_012.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_224"
                    ],
                    "severity": "Medium",
                    "title": "Container registries should have ARM audience token authentication disabled",
                    "description": "Disable Azure Active Directory ARM audience tokens for authentication to your registry. Only Azure Container Registry (ACR) audience tokens will be used for authentication. This will ensure only tokens meant for usage on the registry can be used for authentication. Disabling ARM audience tokens does not affect admin user's or scoped access tokens' authentication. Learn more at: https://aka.ms/acr/authentication."
                },
                {
                    "masterTestId": "PR-AZR-CLD-ACR-013",
                    "type": "rego",
                    "rule": "file(registry.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ACR-013",
                            "eval": "data.rule.acr_export_disabled",
                            "message": "data.rule.acr_export_disabled_err",
                            "remediationDescription": "01. Run az resource update to set the exportPolicy status in an existing registry to disabled. Substitute the names of your registry and resource group.<br>02. When disabling the exportPolicy property, also set the publicNetworkAccess property to disabled. az resource update --resource-group myResourceGroup --name myregistry --resource-type 'Microsoft.ContainerRegistry/registries' --api-version '2021-06-01-preview' --set 'properties.policies.exportPolicy.status=disabled' --set 'properties.publicNetworkAccess=disabled'",
                            "remediationFunction": "PR_AZR_CLD_ACR_013.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_224"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Azure Container registries should have exports disabled",
                    "description": "Disabling exports improves security by ensuring data in a registry is accessed solely via the dataplane ('docker pull'). Data cannot be moved out of the registry via 'acr import' or via 'acr transfer'. In order to disable exports, public network access must be disabled. Learn more at: https://aka.ms/acr/export-policy."
                },
                {
                    "masterTestId": "PR-AZR-CLD-ACR-014",
                    "type": "rego",
                    "rule": "file(registry.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ACR-014",
                            "eval": "data.rule.acr_usage_custom_managed_key_for_encryption",
                            "message": "data.rule.acr_usage_custom_managed_key_for_encryption_err",
                            "remediationDescription": "Please visit <a href='https://learn.microsoft.com/en-us/azure/container-registry/tutorial-enable-customer-managed-keys#enable-a-customer-managed-key-by-using-the-azure-portal' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_CLD_ACR_014.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Azure_Security_Benchmark",
                                "Azure_Security_Benchmark_v2.0_DP-5",
                                "Azure_Security_Benchmark_v3.0_DP-5",
                                "CMMC",
                                "CMMC_2.0_L2_SC.L2-3.13.10",
                                "CMMC_L3_SC.3.177",
                                "FedRAMP",
                                "FedRAMP_High_R4_SC-12",
                                "FedRAMP_Moderate_R4_SC-12",
                                "NIST_SP",
                                "NIST_SP_800-171_R2_3.13.10",
                                "NIST_SP_800-53_R4_SC-12",
                                "NIST_SP_800-53_R5_SC-12",
                                "NZ_ISM",
                                "NZ_ISM_v3.5_CR-3"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_224"
                    ],
                    "severity": "Medium",
                    "title": "Container registries should be encrypted with a customer-managed key",
                    "description": "Use customer-managed keys to manage the encryption at rest of the contents of your registries. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more at https://aka.ms/acr/CMK.Use customer-managed keys to manage the encryption at rest of the contents of your registries. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more at https://aka.ms/acr/CMK.Use customer-managed keys to manage the encryption at rest of the contents of your registries. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more at https://aka.ms/acr/CMK."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-001",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-001",
                            "eval": "data.rule.nsg_in_tcp_all_src",
                            "message": "data.rule.nsg_in_tcp_all_src_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group (NSG) shouldn't have Inbound rule overly permissive to all TCP traffic from any source",
                    "description": "This policy identifies Azure Network Security Groups (NSGs) which are overly permissive to open TCP traffic from any source. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources, allowing only authorized protocols and ports."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-002",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-002",
                            "eval": "data.rule.nsg_in_udp_all_src",
                            "message": "data.rule.nsg_in_udp_all_src_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group (NSG) shouldn't have Inbound rule overly permissive to all UDP traffic from any source",
                    "description": "This policy identifies Azure Network Security Groups (NSGs) which are overly permissive to open UDP traffic from any source. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources, allowing only authorized protocols and ports."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-003",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-003",
                            "eval": "data.rule.nsg_in_tcp_all",
                            "message": "data.rule.nsg_in_tcp_all_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CIS",
                                "CIS v1.1 (Azure)-6.1",
                                "CIS v1.1 (Azure)-6.2",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-07",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-DSP-17",
                                "CSA CCM v.4.0.1-HRS-04",
                                "CSA CCM v.4.0.1-IVS-03",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CSA CCM v.4.0.1-STA-14",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-05",
                                "CSA CCM v.4.0.1-UEM-11",
                                "CyberSecurity Law of the People's Republic of China-Article 21",
                                "CyberSecurity Law of the People's Republic of China-Article 25",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.n",
                                "HITRUST v.9.4.2-Control Reference:01.o",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-12.6.2",
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2",
                                "ISO/IEC 27002:2013-13.1.3",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-14.2.5",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-18.1.4",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-6.2.2",
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1",
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-16.1.2",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2",
                                "ISO/IEC 27018:2019-12.3.1",
                                "ISO/IEC 27018:2019-18.2.1",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v6.3-T1046",
                                "MITRE ATT&CK v8.2-T1046",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Boundary Protection | Block Communication from Non-organizationally Configured Hosts",
                                "NIST 800-53 Rev 5-Boundary Protection | Deny by Default â Allow by Exception",
                                "NIST 800-53 Rev 5-Boundary Protection | Restrict Incoming Communications Traffic",
                                "NIST 800-53 Rev 5-Remote Access | Protection of Confidentiality and Integrity Using Encryption",
                                "NIST 800-53 Rev 5-System Monitoring | Inbound and Outbound Communications Traffic",
                                "NIST 800-53 Rev4-AC-17 (2)",
                                "NIST 800-53 Rev4-SC-7 (11)",
                                "NIST 800-53 Rev4-SC-7 (19)",
                                "NIST 800-53 Rev4-SC-7 (5)",
                                "NIST 800-53 Rev4-SI-4 (4)",
                                "NIST CSF",
                                "NIST CSF-DE.AE-2",
                                "NIST CSF-DE.CM-6",
                                "NIST CSF-DE.CM-7",
                                "NIST CSF-DE.DP-2",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-PR.AC-5",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5",
                                "NIST CSF-PR.PT-4",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6",
                                "NIST SP 800-171 Revision 2-3.14.6",
                                "NIST SP 800-172-3.14.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group (NSG) shouldn't have Inbound rule overly permissive to all traffic from Internet on TCP protocol",
                    "description": "This policy identifies Azure Network Security Groups (NSGs) which are overly permissive to all traffic from Internet on TCP protocol. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources, allowing only authorized protocols and ports."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-004",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-004",
                            "eval": "data.rule.nsg_in_udp_all",
                            "message": "data.rule.nsg_in_udp_all_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_004.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-LT-3",
                                "Azure Security Benchmark (v3)-GS-9",
                                "Azure Security Benchmark (v3)-NS-1",
                                "Azure Security Benchmark (v3)-NS-2",
                                "Azure Security Benchmark (v3)-NS-3",
                                "Azure Security Benchmark (v3)-NS-7",
                                "Azure Security Benchmark (v3)-NS-8",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CIS",
                                "CIS v1.1 (Azure)-6.1",
                                "CIS v1.1 (Azure)-6.2",
                                "CIS v1.3.0 (Azure)-6.6",
                                "CIS v1.3.1 (Azure)-6.6",
                                "CIS v1.4.0 (Azure)-6.6",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-07",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-DSP-17",
                                "CSA CCM v.4.0.1-HRS-04",
                                "CSA CCM v.4.0.1-IVS-03",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CSA CCM v.4.0.1-STA-14",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-05",
                                "CSA CCM v.4.0.1-UEM-11",
                                "CyberSecurity Law of the People's Republic of China-Article 21",
                                "CyberSecurity Law of the People's Republic of China-Article 25",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.n",
                                "HITRUST v.9.4.2-Control Reference:01.o",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-12.6.2",
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2",
                                "ISO/IEC 27002:2013-13.1.3",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-14.2.5",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-18.1.4",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-6.2.2",
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1",
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-16.1.2",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2",
                                "ISO/IEC 27018:2019-12.3.1",
                                "ISO/IEC 27018:2019-18.2.1",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v6.3-T1046",
                                "MITRE ATT&CK v8.2-T1046",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Boundary Protection | Block Communication from Non-organizationally Configured Hosts",
                                "NIST 800-53 Rev 5-Boundary Protection | Deny by Default â Allow by Exception",
                                "NIST 800-53 Rev 5-Boundary Protection | Restrict Incoming Communications Traffic",
                                "NIST 800-53 Rev 5-Remote Access | Protection of Confidentiality and Integrity Using Encryption",
                                "NIST 800-53 Rev 5-System Monitoring | Inbound and Outbound Communications Traffic",
                                "NIST 800-53 Rev4-AC-17 (2)",
                                "NIST 800-53 Rev4-SC-7 (11)",
                                "NIST 800-53 Rev4-SC-7 (19)",
                                "NIST 800-53 Rev4-SC-7 (5)",
                                "NIST 800-53 Rev4-SI-4 (4)",
                                "NIST CSF",
                                "NIST CSF-DE.AE-2",
                                "NIST CSF-DE.CM-6",
                                "NIST CSF-DE.CM-7",
                                "NIST CSF-DE.DP-2",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-PR.AC-5",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5",
                                "NIST CSF-PR.PT-4",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6",
                                "NIST SP 800-171 Revision 2-3.14.6",
                                "NIST SP 800-172-3.14.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group (NSG) shouldn't have Inbound rule overly permissive to all traffic from Internet on UDP protocol",
                    "description": "This policy identifies Azure Network Security Groups (NSGs) which are overly permissive to all traffic from Internet on UDP protocol. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources, allowing only authorized protocols and ports."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-005",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-005",
                            "eval": "data.rule.nsg_in_all",
                            "message": "data.rule.nsg_in_all_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_005.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CIS",
                                "CIS v1.1 (Azure)-6.1",
                                "CIS v1.1 (Azure)-6.2",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-07",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-DSP-17",
                                "CSA CCM v.4.0.1-HRS-04",
                                "CSA CCM v.4.0.1-IVS-03",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CSA CCM v.4.0.1-STA-14",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-05",
                                "CSA CCM v.4.0.1-UEM-11",
                                "CyberSecurity Law of the People's Republic of China-Article 21",
                                "CyberSecurity Law of the People's Republic of China-Article 25",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.n",
                                "HITRUST v.9.4.2-Control Reference:01.o",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-12.6.2",
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2",
                                "ISO/IEC 27002:2013-13.1.3",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-14.2.5",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-18.1.4",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-6.2.2",
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1",
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-16.1.2",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2",
                                "ISO/IEC 27018:2019-12.3.1",
                                "ISO/IEC 27018:2019-18.2.1",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1046 - Network Service Scanning",
                                "MITRE ATT&CK v6.3-T1046",
                                "MITRE ATT&CK v8.2-T1046",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Boundary Protection | Block Communication from Non-organizationally Configured Hosts",
                                "NIST 800-53 Rev 5-Boundary Protection | Deny by Default â Allow by Exception",
                                "NIST 800-53 Rev 5-Boundary Protection | Restrict Incoming Communications Traffic",
                                "NIST 800-53 Rev 5-Remote Access | Protection of Confidentiality and Integrity Using Encryption",
                                "NIST 800-53 Rev 5-System Monitoring | Inbound and Outbound Communications Traffic",
                                "NIST 800-53 Rev4-AC-17 (2)",
                                "NIST 800-53 Rev4-SC-7 (11)",
                                "NIST 800-53 Rev4-SC-7 (19)",
                                "NIST 800-53 Rev4-SC-7 (5)",
                                "NIST 800-53 Rev4-SI-4 (4)",
                                "NIST CSF",
                                "NIST CSF-DE.AE-2",
                                "NIST CSF-DE.CM-6",
                                "NIST CSF-DE.CM-7",
                                "NIST CSF-DE.DP-2",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-PR.AC-5",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5",
                                "NIST CSF-PR.PT-4",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6",
                                "NIST SP 800-171 Revision 2-3.14.6",
                                "NIST SP 800-172-3.14.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group (NSG) shouldn't have Inbound rule overly permissive to all traffic from Internet on any protocol",
                    "description": "This policy identifies Azure Network Security Groups (NSGs) which are overly permissive to all traffic from Internet on any protocol. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources, allowing only authorized protocols and ports."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-007",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-007",
                            "eval": "data.rule.nsg_in_all_dst",
                            "message": "data.rule.nsg_in_all_dst_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_007.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group (NSG) has an Inbound rule overly permissive to allow all traffic from any source to any destination",
                    "description": "This policy identifies NSGs which allows incoming traffic from any source. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources on authorized protocols and ports."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-008",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-008",
                            "eval": "data.rule.nsg_allow_icmp",
                            "message": "data.rule.nsg_allow_icmp_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_008.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-07",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-DSP-17",
                                "CSA CCM v.4.0.1-HRS-04",
                                "CSA CCM v.4.0.1-IVS-03",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CSA CCM v.4.0.1-STA-14",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08", 
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-05",
                                "CSA CCM v.4.0.1-UEM-11",
                                "CyberSecurity Law of the People's Republic of China-Article 21",
                                "CyberSecurity Law of the People's Republic of China-Article 25",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.n",
                                "HITRUST v.9.4.2-Control Reference:01.o",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-12.6.2",
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2",
                                "ISO/IEC 27002:2013-13.1.3", 
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-14.2.4", 
                                "ISO/IEC 27002:2013-14.2.5", 
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3", 
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-18.1.4",
                                "ISO/IEC 27002:2013-18.2.1", 
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-6.2.2",
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-16.1.2",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2",
                                "ISO/IEC 27018:2019-12.3.1", 
                                "ISO/IEC 27018:2019-18.2.1", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Boundary Protection | Block Communication from Non-organizationally Configured Hosts",
                                "NIST 800-53 Rev 5-Boundary Protection | Deny by Default â Allow by Exception", 
                                "NIST 800-53 Rev 5-Boundary Protection | Restrict Incoming Communications Traffic", 
                                "NIST 800-53 Rev 5-Remote Access | Protection of Confidentiality and Integrity Using Encryption", 
                                "NIST 800-53 Rev 5-System Monitoring | Inbound and Outbound Communications Traffic",
                                "NIST 800-53 Rev4-AC-17 (2)", 
                                "NIST 800-53 Rev4-SC-7 (11)", 
                                "NIST 800-53 Rev4-SC-7 (19)",
                                "NIST 800-53 Rev4-SC-7 (5)",
                                "NIST 800-53 Rev4-SI-4 (4)",
                                "NIST CSF",
                                "NIST CSF-DE.AE-2",
                                "NIST CSF-DE.CM-6",
                                "NIST CSF-DE.CM-7",
                                "NIST CSF-DE.DP-2",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-PR.AC-5",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5", 
                                "NIST CSF-PR.PT-4", 
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6",
                                "NIST SP 800-171 Revision 2-3.14.6", 
                                "NIST SP 800-172-3.14.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group shouldn't allow ICMP (Ping)",
                    "description": "ICMP is used by devices to communicate error messages and status. While ICMP is useful for  diagnostics and troubleshooting, it can also be used to exploit or disrupt systems.<br><br>This policy detects any NSG rule that allows ICMP (Ping) traffic from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict ICMP (Ping) solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-009",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-009",
                            "eval": "data.rule.inbound_port_21",
                            "message": "data.rule.inbound_port_21_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_009.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-CEK-03", 
                                "CSA CCM v.4.0.1-DSP-07", 
                                "CSA CCM v.4.0.1-DSP-10", 
                                "CSA CCM v.4.0.1-DSP-17",
                                "CSA CCM v.4.0.1-HRS-04",
                                "CSA CCM v.4.0.1-IVS-03",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CSA CCM v.4.0.1-STA-14", 
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09", 
                                "CSA CCM v.4.0.1-TVM-10", 
                                "CSA CCM v.4.0.1-UEM-03", 
                                "CSA CCM v.4.0.1-UEM-05", 
                                "CSA CCM v.4.0.1-UEM-11",
                                "CyberSecurity Law of the People's Republic of China-Article 21", 
                                "CyberSecurity Law of the People's Republic of China-Article 25",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183", 
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.n", 
                                "HITRUST v.9.4.2-Control Reference:01.o", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1", 
                                "ISO/IEC 27002:2013-12.4.3", 
                                "ISO/IEC 27002:2013-12.6.1", 
                                "ISO/IEC 27002:2013-12.6.2", 
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2", 
                                "ISO/IEC 27002:2013-13.1.3", 
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.1", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-14.2.4", 
                                "ISO/IEC 27002:2013-14.2.5", 
                                "ISO/IEC 27002:2013-16.1.1", 
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3", 
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-18.1.4", 
                                "ISO/IEC 27002:2013-18.2.1", 
                                "ISO/IEC 27002:2013-5.1.1", 
                                "ISO/IEC 27002:2013-6.2.2", 
                                "ISO/IEC 27002:2013-8.3.1", 
                                "ISO/IEC 27002:2013-8.3.3", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-16.1.2",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2", 
                                "ISO/IEC 27018:2019-12.3.1",
                                "ISO/IEC 27018:2019-18.2.1",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v6.3-T1190",
                                "MITRE ATT&CK v8.2-T1190",
                                "MPAA Content Protection Best Practices",
                                "MPAA Content Protection Best Practices-DS-1.2",
                                "MPAA Content Protection Best Practices-DS-3.0",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Boundary Protection | Block Communication from Non-organizationally Configured Hosts", 
                                "NIST 800-53 Rev 5-Boundary Protection | Deny by Default â Allow by Exception", 
                                "NIST 800-53 Rev 5-Boundary Protection | Restrict Incoming Communications Traffic", 
                                "NIST 800-53 Rev 5-Remote Access | Protection of Confidentiality and Integrity Using Encryption", 
                                "NIST 800-53 Rev 5-System Monitoring | Inbound and Outbound Communications Traffic", 
                                "NIST 800-53 Rev4-AC-17 (2)",
                                "NIST 800-53 Rev4-SC-7 (11)",
                                "NIST 800-53 Rev4-SC-7 (19)", 
                                "NIST 800-53 Rev4-SC-7 (5)", 
                                "NIST 800-53 Rev4-SI-4 (4)", 
                                "NIST CSF",
                                "NIST CSF-DE.AE-2", 
                                "NIST CSF-DE.CM-6", 
                                "NIST CSF-DE.CM-7", 
                                "NIST CSF-DE.DP-2",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-PR.AC-5",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5", 
                                "NIST CSF-PR.PT-4",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6", 
                                "NIST SP 800-171 Revision 2-3.14.6",
                                "NIST SP 800-172-3.14.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group shouldn't allow FTP (TCP Port 21)",
                    "description": "This policy detects any NSG rule that allows FTP traffic on TCP port 21 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict FTP solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-010",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-010",
                            "eval": "data.rule.inbound_insecure_port",
                            "message": "data.rule.inbound_insecure_port_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_010.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "GDPR",
                                "HIPAA",
                                "NIST CSF",
                                "PCI-DSS",
                                "SOC 2"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "Medium",
                    "title": "Internet connectivity via tcp over insecure port should be prevented",
                    "description": "Identify network traffic coming from internet which is plain text FTP, Telnet or HTTP from Internet."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-011",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-011",
                            "eval": "data.rule.inbound_port_11211",
                            "message": "data.rule.inbound_port_11211_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_011.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Memcached DDoS attack attempt should be prevented",
                    "description": "Memcached is a general-purpose distributed memory caching system. It is often used to speed up dynamic database-driven websites by caching data and objects in RAM to reduce the number of times an external data source (such as a database or API) must be read. It is reported that Memcache versions 1.5.5 and below are vulnerable to DDoS amplification attack. This policy aims at finding such attacks and generate alerts."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-012",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-012",
                            "eval": "data.rule.inbound_port_6379",
                            "message": "data.rule.inbound_port_6379_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_012.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "RedisWannaMine vulnerable instances with active network traffic should be locked down",
                    "description": "RedisWannaMine is cryptojacking attack which aims at both database servers and application servers via remote code execution, exploiting an Apache Struts vulnerability. To inject cryptocurrency mining malware, RedWannaMine uses a transmission control protocol (TCP) scanner to check open port 445 of SMB and scans vulnerable Redis server database over port 6379(tcp), so that it can use EternalBlue to spread further."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-013",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-013",
                            "eval": "data.rule.inbound_port_dbs",
                            "message": "data.rule.inbound_port_dbs_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_013.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Publicly should not expose DB Ports",
                    "description": "DB Servers contain sensitive data and should not be exposed to any direct traffic from internet. This policy checks for the network traffic from internet hitting the DB Servers on their default ports. The DB servers monitored on the default ports are : Microsoft SQL Server (1433), Oracle (1521), MySQL (3306), Sybase (5000), Postgresql (5432), CouchDB (5984), Redis (6379, 6380), RethinkDB (8080,28015, 29015), CassandraDB (9042), Memcached (11211), MongoDB (27017), DB2 (50000)."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-014",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-014",
                            "eval": "data.rule.inbound_port_22",
                            "message": "data.rule.inbound_port_22_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_014.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-NS-1",
                                "Azure Security Benchmark (v3)-GS-9",
                                "Azure Security Benchmark (v3)-NS-1", 
                                "Azure Security Benchmark (v3)-NS-2",
                                "Azure Security Benchmark (v3)-NS-3",
                                "Azure Security Benchmark (v3)-NS-7",
                                "Azure Security Benchmark (v3)-NS-8",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CIS",
                                "CIS v1.1 (Azure)-6.2",
                                "CIS v1.2.0 (Azure)-6.2",
                                "CIS v1.3.0 (Azure)-6.2",
                                "CIS v1.3.1 (Azure)-6.2",
                                "CIS v1.4.0 (Azure)-6.2",
                                "CSA CCM",
                                "CSA CCM v3.0.1-DSI-02",
                                "CSA CCM v3.0.1-IAM-07",
                                "CSA CCM v3.0.1-IVS-06",
                                "CSA CCM v3.0.1-IVS-08",
                                "CyberSecurity Law of the People's Republic of China-Article 21",
                                "CyberSecurity Law of the People's Republic of China-Article 25",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216",
                                "GDPR",
                                "GDPR-Article 32",
                                "GDPR-Article 46",
                                "HIPAA",
                                "HIPAA-164.312(e)(2)(i)",
                                "HITRUST",
                                "HITRUST CSF v9.3-Control Reference:09.ab",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v6.3-T1108",
                                "MITRE ATT&CK v6.3-T1108",
                                "MITRE ATT&CK v6.3-T1190",
                                "MITRE ATT&CK v8.2-T1190",
                                "MPAA Content Protection Best Practices",
                                "MPAA Content Protection Best Practices-DS-1.2",
                                "MPAA Content Protection Best Practices-DS-3.0",
                                "NIST 800",
                                "NIST 800-53 Rev4-SC-7 (19)",
                                "NIST 800-53 Rev4-SI-4 (4)",
                                "NIST CSF",
                                "NIST CSF-DE.AE-1",
                                "NIST CSF-DE.CM-7",
                                "NIST CSF-PR.AC-5",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6",
                                "NIST SP 800-171 Revision 2-3.14.6",
                                "NIST SP 800-172-3.14.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1",
                                "PIPEDA",
                                "PIPEDA-4.7.3",
                                "SOC 2",
                                "SOC 2-CC6.1",
                                "SOC 2-CC6.6",
                                "SOC 2-CC6.7"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group (NSG) should not allow SSH traffic from internet on port 22",
                    "description": "Blocking SSH port 22 will protect users from attacks like Account compromise."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-015",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-015",
                            "eval": "data.rule.inbound_port_3389",
                            "message": "data.rule.inbound_port_3389_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_015.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-NS-1",
                                "Azure Security Benchmark (v3)-GS-9", 
                                "Azure Security Benchmark (v3)-NS-1",
                                "Azure Security Benchmark (v3)-NS-2",
                                "Azure Security Benchmark (v3)-NS-3",
                                "Azure Security Benchmark (v3)-NS-7",
                                "Azure Security Benchmark (v3)-NS-8",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CIS",
                                "CIS v1.1 (Azure)-6.1",
                                "CIS v1.2.0 (Azure)-6.1",
                                "CIS v1.3.0 (Azure)-6.1", 
                                "CIS v1.3.1 (Azure)-6.1",
                                "CIS v1.4.0 (Azure)-6.1",
                                "CSA CCM",
                                "CSA CCM v3.0.1-DSI-02",
                                "CSA CCM v3.0.1-IAM-07",
                                "CSA CCM v3.0.1-IVS-06",
                                "CSA CCM v3.0.1-IVS-08",
                                "CyberSecurity Law of the People's Republic of China-Article 21",
                                "CyberSecurity Law of the People's Republic of China-Article 25",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216",
                                "GDPR",
                                "GDPR-Article 32",
                                "GDPR-Article 46",
                                "HIPAA",
                                "HIPAA-164.312(e)(2)(i)",
                                "HITRUST",
                                "HITRUST CSF v9.3-Control Reference:09.ab",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v6.3-T1190",
                                "MITRE ATT&CK v8.2-T1190",
                                "MPAA Content Protection Best Practices",
                                "MPAA Content Protection Best Practices-DS-1.2",
                                "MPAA Content Protection Best Practices-DS-3.0",
                                "NIST 800",
                                "NIST 800-53 Rev4-SC-7 (19)",
                                "NIST 800-53 Rev4-SI-4 (4)",
                                "NIST CSF",
                                "NIST CSF-DE.AE-1",
                                "NIST CSF-DE.CM-7",
                                "NIST CSF-PR.AC-5",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6",
                                "NIST SP 800-171 Revision 2-3.14.6",
                                "NIST SP 800-172-3.14.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1",
                                "PIPEDA",
                                "PIPEDA-4.7.3",
                                "SOC 2",
                                "SOC 2-CC6.1",
                                "SOC 2-CC6.6",
                                "SOC 2-CC6.7"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group (NSG) should not allow traffic from internet on port 3389",
                    "description": "Blocking RDP port 3389 will protect users from attacks like account compromise, Denial of service and ransomware."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-016",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-016",
                            "eval": "data.rule.inbound_port_445",
                            "message": "data.rule.inbound_port_445_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_016.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03", 
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-07", 
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-DSP-17", 
                                "CSA CCM v.4.0.1-HRS-04",
                                "CSA CCM v.4.0.1-IVS-03", 
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CSA CCM v.4.0.1-STA-14", 
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07", 
                                "CSA CCM v.4.0.1-TVM-08", 
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10", 
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-05", 
                                "CSA CCM v.4.0.1-UEM-11",
                                "CyberSecurity Law of the People's Republic of China-Article 21",
                                "CyberSecurity Law of the People's Republic of China-Article 25",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.n",
                                "HITRUST v.9.4.2-Control Reference:01.o",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1", 
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-12.6.2",
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2",
                                "ISO/IEC 27002:2013-13.1.3",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-14.2.5",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27002:2013-16.1.2", 
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-18.1.4", 
                                "ISO/IEC 27002:2013-18.2.1", 
                                "ISO/IEC 27002:2013-5.1.1", 
                                "ISO/IEC 27002:2013-6.2.2", 
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015", 
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-16.1.2",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019", 
                                "ISO/IEC 27018:2019-10.1.2", 
                                "ISO/IEC 27018:2019-12.3.1", 
                                "ISO/IEC 27018:2019-18.2.1", 
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v6.3-T1190", 
                                "MITRE ATT&CK v8.2-T1190",
                                "MPAA Content Protection Best Practices", 
                                "MPAA Content Protection Best Practices-DS-1.2", 
                                "MPAA Content Protection Best Practices-DS-3.0", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Boundary Protection | Block Communication from Non-organizationally Configured Hosts", 
                                "NIST 800-53 Rev 5-Boundary Protection | Deny by Default â Allow by Exception",
                                "NIST 800-53 Rev 5-Boundary Protection | Restrict Incoming Communications Traffic",
                                "NIST 800-53 Rev 5-Remote Access | Protection of Confidentiality and Integrity Using Encryption",
                                "NIST 800-53 Rev 5-System Monitoring | Inbound and Outbound Communications Traffic", 
                                "NIST 800-53 Rev4-AC-17 (2)", 
                                "NIST 800-53 Rev4-SC-7 (11)", 
                                "NIST 800-53 Rev4-SC-7 (19)",
                                "NIST 800-53 Rev4-SC-7 (5)",
                                "NIST 800-53 Rev4-SI-4 (4)", 
                                "NIST CSF",
                                "NIST CSF-DE.AE-2",
                                "NIST CSF-DE.CM-6",
                                "NIST CSF-DE.CM-7", 
                                "NIST CSF-DE.DP-2",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-PR.AC-5",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5",
                                "NIST CSF-PR.PT-4",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6",
                                "NIST SP 800-171 Revision 2-3.14.6",
                                "NIST SP 800-172-3.14.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group should not allow Windows SMB (TCP Port 445)",
                    "description": "This policy detects any NSG rule that allows Windows SMB traffic on TCP port 445 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict Windows SMB solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-018",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-018",
                            "eval": "data.rule.inbound_port_53",
                            "message": "data.rule.inbound_port_53_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_018.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-07",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-DSP-17",
                                "CSA CCM v.4.0.1-HRS-04",
                                "CSA CCM v.4.0.1-IVS-03",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CSA CCM v.4.0.1-STA-14",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-05",
                                "CSA CCM v.4.0.1-UEM-11",
                                "CyberSecurity Law of the People's Republic of China-Article 21",
                                "CyberSecurity Law of the People's Republic of China-Article 25",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.n",
                                "HITRUST v.9.4.2-Control Reference:01.o",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-12.6.2",
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2",
                                "ISO/IEC 27002:2013-13.1.3",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-14.2.5",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-18.1.4",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-6.2.2",
                                "ISO/IEC 27002:2013-8.3.1", 
                                "ISO/IEC 27002:2013-8.3.3", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1",
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-16.1.2",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2",
                                "ISO/IEC 27018:2019-12.3.1",
                                "ISO/IEC 27018:2019-18.2.1",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v6.3-T1190",
                                "MITRE ATT&CK v8.2-T1190",
                                "MPAA Content Protection Best Practices",
                                "MPAA Content Protection Best Practices-DS-1.2",
                                "MPAA Content Protection Best Practices-DS-3.0",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Boundary Protection | Block Communication from Non-organizationally Configured Hosts",
                                "NIST 800-53 Rev 5-Boundary Protection | Deny by Default â Allow by Exception",
                                "NIST 800-53 Rev 5-Boundary Protection | Restrict Incoming Communications Traffic",
                                "NIST 800-53 Rev 5-Remote Access | Protection of Confidentiality and Integrity Using Encryption",
                                "NIST 800-53 Rev 5-System Monitoring | Inbound and Outbound Communications Traffic",
                                "NIST 800-53 Rev4-AC-17 (2)",
                                "NIST 800-53 Rev4-SC-7 (11)",
                                "NIST 800-53 Rev4-SC-7 (19)",
                                "NIST 800-53 Rev4-SC-7 (5)",
                                "NIST 800-53 Rev4-SI-4 (4)",
                                "NIST CSF",
                                "NIST CSF-DE.AE-2",
                                "NIST CSF-DE.CM-6",
                                "NIST CSF-DE.CM-7",
                                "NIST CSF-DE.DP-2",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-PR.AC-5",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5",
                                "NIST CSF-PR.PT-4",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6",
                                "NIST SP 800-171 Revision 2-3.14.6",
                                "NIST SP 800-172-3.14.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group should not allow DNS (UDP Port 53)",
                    "description": "This policy detects any NSG rule that allows DNS traffic on UDP port 53 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict DNS solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-019",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-019",
                            "eval": "data.rule.inbound_port_20",
                            "message": "data.rule.inbound_port_20_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_019.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03", 
                                "CSA CCM v.4.0.1-CEK-03", 
                                "CSA CCM v.4.0.1-DSP-07",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-DSP-17",
                                "CSA CCM v.4.0.1-HRS-04", 
                                "CSA CCM v.4.0.1-IVS-03",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CSA CCM v.4.0.1-STA-14", 
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08", 
                                "CSA CCM v.4.0.1-TVM-09", 
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-05",
                                "CSA CCM v.4.0.1-UEM-11",
                                "CyberSecurity Law of the People's Republic of China-Article 21",
                                "CyberSecurity Law of the People's Republic of China-Article 25", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.n",
                                "HITRUST v.9.4.2-Control Reference:01.o",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1", 
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-12.6.2",
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2",
                                "ISO/IEC 27002:2013-13.1.3",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.1", 
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-14.2.5",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-18.1.4", 
                                "ISO/IEC 27002:2013-18.2.1", 
                                "ISO/IEC 27002:2013-5.1.1", 
                                "ISO/IEC 27002:2013-6.2.2", 
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2", 
                                "ISO/IEC 27017:2015-16.1.2", 
                                "ISO/IEC 27017:2015-6.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2", 
                                "ISO/IEC 27018:2019-12.3.1", 
                                "ISO/IEC 27018:2019-18.2.1", 
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v6.3-T1190",
                                "MITRE ATT&CK v8.2-T1190", 
                                "MPAA Content Protection Best Practices",
                                "MPAA Content Protection Best Practices-DS-1.2", 
                                "MPAA Content Protection Best Practices-DS-3.0",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Boundary Protection | Block Communication from Non-organizationally Configured Hosts",
                                "NIST 800-53 Rev 5-Boundary Protection | Deny by Default â Allow by Exception", 
                                "NIST 800-53 Rev 5-Boundary Protection | Restrict Incoming Communications Traffic",
                                "NIST 800-53 Rev 5-Remote Access | Protection of Confidentiality and Integrity Using Encryption",
                                "NIST 800-53 Rev 5-System Monitoring | Inbound and Outbound Communications Traffic",
                                "NIST 800-53 Rev4-AC-17 (2)",
                                "NIST 800-53 Rev4-SC-7 (11)",
                                "NIST 800-53 Rev4-SC-7 (19)",
                                "NIST 800-53 Rev4-SC-7 (5)",
                                "NIST 800-53 Rev4-SI-4 (4)",
                                "NIST CSF",
                                "NIST CSF-DE.AE-2", 
                                "NIST CSF-DE.CM-6",
                                "NIST CSF-DE.CM-7",
                                "NIST CSF-DE.DP-2",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-PR.AC-5",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5",
                                "NIST CSF-PR.PT-4", 
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6",
                                "NIST SP 800-171 Revision 2-3.14.6", 
                                "NIST SP 800-172-3.14.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group should not allow FTP-Data (TCP Port 20)",
                    "description": "This policy detects any NSG rule that allows FTP-Data traffic on TCP port 20 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict FTP-Data solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-020",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-020",
                            "eval": "data.rule.inbound_port_4333",
                            "message": "data.rule.inbound_port_4333_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_020.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03", 
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-07",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-DSP-17",
                                "CSA CCM v.4.0.1-HRS-04",
                                "CSA CCM v.4.0.1-IVS-03", 
                                "CSA CCM v.4.0.1-LOG-05", 
                                "CSA CCM v.4.0.1-LOG-13",
                                "CSA CCM v.4.0.1-STA-14",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-05",
                                "CSA CCM v.4.0.1-UEM-11", 
                                "CyberSecurity Law of the People's Republic of China-Article 21", 
                                "CyberSecurity Law of the People's Republic of China-Article 25", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.n",
                                "HITRUST v.9.4.2-Control Reference:01.o",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.6.1", 
                                "ISO/IEC 27002:2013-12.6.2",
                                "ISO/IEC 27002:2013-13.1.1", 
                                "ISO/IEC 27002:2013-13.1.2", 
                                "ISO/IEC 27002:2013-13.1.3",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-14.2.5", 
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-18.1.4",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-6.2.2",
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1",
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-16.1.2",
                                "ISO/IEC 27017:2015-6.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2",
                                "ISO/IEC 27018:2019-12.3.1",
                                "ISO/IEC 27018:2019-18.2.1",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v6.3-T1190",
                                "MITRE ATT&CK v8.2-T1190",
                                "MPAA Content Protection Best Practices",
                                "MPAA Content Protection Best Practices-DS-1.2", 
                                "MPAA Content Protection Best Practices-DS-3.0", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Boundary Protection | Block Communication from Non-organizationally Configured Hosts",
                                "NIST 800-53 Rev 5-Boundary Protection | Deny by Default â Allow by Exception",
                                "NIST 800-53 Rev 5-Boundary Protection | Restrict Incoming Communications Traffic",
                                "NIST 800-53 Rev 5-Remote Access | Protection of Confidentiality and Integrity Using Encryption",
                                "NIST 800-53 Rev 5-System Monitoring | Inbound and Outbound Communications Traffic",
                                "NIST 800-53 Rev4-AC-17 (2)",
                                "NIST 800-53 Rev4-SC-7 (11)", 
                                "NIST 800-53 Rev4-SC-7 (19)", 
                                "NIST 800-53 Rev4-SC-7 (5)",
                                "NIST 800-53 Rev4-SI-4 (4)",
                                "NIST CSF",
                                "NIST CSF-DE.AE-2", 
                                "NIST CSF-DE.CM-6", 
                                "NIST CSF-DE.CM-7",
                                "NIST CSF-DE.DP-2",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-PR.AC-5",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5",
                                "NIST CSF-PR.PT-4",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6",
                                "NIST SP 800-171 Revision 2-3.14.6", 
                                "NIST SP 800-172-3.14.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1", 
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group should not allow MS SQL (TCP Port 4333)",
                    "description": "This policy detects any NSG rule that allows MSQL traffic on TCP port 4333 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict MSQL solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-021",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-021",
                            "eval": "data.rule.inbound_port_3306",
                            "message": "data.rule.inbound_port_3306_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_021.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-07",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-DSP-17",
                                "CSA CCM v.4.0.1-HRS-04",
                                "CSA CCM v.4.0.1-IVS-03",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CSA CCM v.4.0.1-STA-14",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-05",
                                "CSA CCM v.4.0.1-UEM-11",
                                "CyberSecurity Law of the People's Republic of China-Article 21",
                                "CyberSecurity Law of the People's Republic of China-Article 25",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.n",
                                "HITRUST v.9.4.2-Control Reference:01.o",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-12.6.2",
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2",
                                "ISO/IEC 27002:2013-13.1.3",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-14.2.5",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-18.1.4",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-6.2.2",
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1",
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-16.1.2",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2",
                                "ISO/IEC 27018:2019-12.3.1",
                                "ISO/IEC 27018:2019-18.2.1",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v6.3-T1190",
                                "MITRE ATT&CK v8.2-T1190",
                                "MPAA Content Protection Best Practices",
                                "MPAA Content Protection Best Practices-DS-1.2",
                                "MPAA Content Protection Best Practices-DS-3.0",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Boundary Protection | Block Communication from Non-organizationally Configured Hosts",
                                "NIST 800-53 Rev 5-Boundary Protection | Deny by Default â Allow by Exception",
                                "NIST 800-53 Rev 5-Boundary Protection | Restrict Incoming Communications Traffic",
                                "NIST 800-53 Rev 5-Remote Access | Protection of Confidentiality and Integrity Using Encryption",
                                "NIST 800-53 Rev 5-System Monitoring | Inbound and Outbound Communications Traffic",
                                "NIST 800-53 Rev4-AC-17 (2)",
                                "NIST 800-53 Rev4-SC-7 (11)",
                                "NIST 800-53 Rev4-SC-7 (19)",
                                "NIST 800-53 Rev4-SC-7 (5)",
                                "NIST 800-53 Rev4-SI-4 (4)",
                                "NIST CSF",
                                "NIST CSF-DE.AE-2",
                                "NIST CSF-DE.CM-6",
                                "NIST CSF-DE.CM-7",
                                "NIST CSF-DE.DP-2",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-PR.AC-5",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5",
                                "NIST CSF-PR.PT-4",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6",
                                "NIST SP 800-171 Revision 2-3.14.6",
                                "NIST SP 800-172-3.14.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group should not allow MySQL (TCP Port 3306)",
                    "description": "This policy detects any NSG rule that allows MySQL traffic on TCP port 3306 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict MySQL solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-022",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-022",
                            "eval": "data.rule.inbound_port_netbios",
                            "message": "data.rule.inbound_port_netbios_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_022.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-07",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-DSP-17",
                                "CSA CCM v.4.0.1-HRS-04",
                                "CSA CCM v.4.0.1-IVS-03",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CSA CCM v.4.0.1-STA-14",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-05",
                                "CSA CCM v.4.0.1-UEM-11",
                                "CyberSecurity Law of the People's Republic of China-Article 21",
                                "CyberSecurity Law of the People's Republic of China-Article 25",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.n",
                                "HITRUST v.9.4.2-Control Reference:01.o",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-12.6.2",
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2",
                                "ISO/IEC 27002:2013-13.1.3",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-14.2.5",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-18.1.4",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-6.2.2",
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1",
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-16.1.2",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2",
                                "ISO/IEC 27018:2019-12.3.1",
                                "ISO/IEC 27018:2019-18.2.1",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v6.3-T1190",
                                "MITRE ATT&CK v8.2-T1190",
                                "MPAA Content Protection Best Practices",
                                "MPAA Content Protection Best Practices-DS-1.2",
                                "MPAA Content Protection Best Practices-DS-3.0",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Boundary Protection | Block Communication from Non-organizationally Configured Hosts",
                                "NIST 800-53 Rev 5-Boundary Protection | Deny by Default â Allow by Exception",
                                "NIST 800-53 Rev 5-Boundary Protection | Restrict Incoming Communications Traffic",
                                "NIST 800-53 Rev 5-Remote Access | Protection of Confidentiality and Integrity Using Encryption",
                                "NIST 800-53 Rev 5-System Monitoring | Inbound and Outbound Communications Traffic",
                                "NIST 800-53 Rev4-AC-17 (2)",
                                "NIST 800-53 Rev4-SC-7 (11)",
                                "NIST 800-53 Rev4-SC-7 (19)",
                                "NIST 800-53 Rev4-SC-7 (5)",
                                "NIST 800-53 Rev4-SI-4 (4)",
                                "NIST CSF",
                                "NIST CSF-DE.AE-2",
                                "NIST CSF-DE.CM-6",
                                "NIST CSF-DE.CM-7",
                                "NIST CSF-DE.DP-2",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-PR.AC-5",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5",
                                "NIST CSF-PR.PT-4",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6",
                                "NIST SP 800-171 Revision 2-3.14.6",
                                "NIST SP 800-172-3.14.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group allows NetBIOS (UDP Port 137 and 138)",
                    "description": "This policy detects any NSG rule that allows NetBIOS traffic on UDP port 137 and 138 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict NetBIOS solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-023",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-023",
                            "eval": "data.rule.inbound_port_5432",
                            "message": "data.rule.inbound_port_5432_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_023.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-07",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-DSP-17",
                                "CSA CCM v.4.0.1-HRS-04",
                                "CSA CCM v.4.0.1-IVS-03",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CSA CCM v.4.0.1-STA-14",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-05",
                                "CSA CCM v.4.0.1-UEM-11",
                                "CyberSecurity Law of the People's Republic of China-Article 21",
                                "CyberSecurity Law of the People's Republic of China-Article 25",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.n",
                                "HITRUST v.9.4.2-Control Reference:01.o",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-12.6.2",
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2",
                                "ISO/IEC 27002:2013-13.1.3",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-14.2.5",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27002:2013-16.1.2", 
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-18.1.4",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-6.2.2",
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1",
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-16.1.2",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2",
                                "ISO/IEC 27018:2019-12.3.1",
                                "ISO/IEC 27018:2019-18.2.1",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v6.3-T1190",
                                "MITRE ATT&CK v8.2-T1190",
                                "MPAA Content Protection Best Practices",
                                "MPAA Content Protection Best Practices-DS-1.2",
                                "MPAA Content Protection Best Practices-DS-3.0",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Boundary Protection | Block Communication from Non-organizationally Configured Hosts",
                                "NIST 800-53 Rev 5-Boundary Protection | Deny by Default â Allow by Exception",
                                "NIST 800-53 Rev 5-Boundary Protection | Restrict Incoming Communications Traffic",
                                "NIST 800-53 Rev 5-Remote Access | Protection of Confidentiality and Integrity Using Encryption",
                                "NIST 800-53 Rev 5-System Monitoring | Inbound and Outbound Communications Traffic",
                                "NIST 800-53 Rev4-AC-17 (2)",
                                "NIST 800-53 Rev4-SC-7 (11)",
                                "NIST 800-53 Rev4-SC-7 (19)",
                                "NIST 800-53 Rev4-SC-7 (5)",
                                "NIST 800-53 Rev4-SI-4 (4)",
                                "NIST CSF",
                                "NIST CSF-DE.AE-2, NIST CSF-DE.CM-6",
                                "NIST CSF-DE.CM-7",
                                "NIST CSF-DE.DP-2",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-PR.AC-5",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5",
                                "NIST CSF-PR.PT-4",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6",
                                "NIST SP 800-171 Revision 2-3.14.6",
                                "NIST SP 800-172-3.14.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group should not allow PostgreSQL (TCP Port 5432)",
                    "description": "This policy detects any NSG rule that allows PostgreSQL traffic on TCP port 5432 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict PostgreSQL solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-024",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-024",
                            "eval": "data.rule.inbound_port_25",
                            "message": "data.rule.inbound_port_25_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_024.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-07",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-DSP-17",
                                "CSA CCM v.4.0.1-HRS-04",
                                "CSA CCM v.4.0.1-IVS-03",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CSA CCM v.4.0.1-STA-14",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-05",
                                "CSA CCM v.4.0.1-UEM-11",
                                "CyberSecurity Law of the People's Republic of China-Article 21",
                                "CyberSecurity Law of the People's Republic of China-Article 25",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.n",
                                "HITRUST v.9.4.2-Control Reference:01.o",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-12.6.2",
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2",
                                "ISO/IEC 27002:2013-13.1.3",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-14.2.5",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-18.1.4",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-6.2.2",
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1",
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-16.1.2",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019-10.1.2",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-12.3.1",
                                "ISO/IEC 27018:2019-18.2.1",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v6.3-T1190",
                                "MITRE ATT&CK v8.2-T1190",
                                "MPAA Content Protection Best Practices",
                                "MPAA Content Protection Best Practices-DS-1.2",
                                "MPAA Content Protection Best Practices-DS-3.0",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Boundary Protection | Block Communication from Non-organizationally Configured Hosts",
                                "NIST 800-53 Rev 5-Boundary Protection | Deny by Default â Allow by Exception",
                                "NIST 800-53 Rev 5-Boundary Protection | Restrict Incoming Communications Traffic",
                                "NIST 800-53 Rev 5-Remote Access | Protection of Confidentiality and Integrity Using Encryption",
                                "NIST 800-53 Rev 5-System Monitoring | Inbound and Outbound Communications Traffic",
                                "NIST 800-53 Rev4-AC-17 (2)",
                                "NIST 800-53 Rev4-SC-7 (11)",
                                "NIST 800-53 Rev4-SC-7 (19)",
                                "NIST 800-53 Rev4-SC-7 (5)",
                                "NIST 800-53 Rev4-SI-4 (4)",
                                "NIST CSF",
                                "NIST CSF-DE.AE-2",
                                "NIST CSF-DE.CM-6",
                                "NIST CSF-DE.CM-7",
                                "NIST CSF-DE.DP-2",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-PR.AC-5",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5",
                                "NIST CSF-PR.PT-4",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6",
                                "NIST SP 800-171 Revision 2-3.14.6",
                                "NIST SP 800-172-3.14.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group should not allow SMTP (TCP Port 25)",
                    "description": "This policy detects any NSG rule that allows SMTP traffic on TCP port 25 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict SMTP solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-025",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-025",
                            "eval": "data.rule.inbound_port_sqlserver",
                            "message": "data.rule.inbound_port_sqlserver_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_025.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-07",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-DSP-17",
                                "CSA CCM v.4.0.1-HRS-04",
                                "CSA CCM v.4.0.1-IVS-03",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CSA CCM v.4.0.1-STA-14",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-05",
                                "CSA CCM v.4.0.1-UEM-11",
                                "CyberSecurity Law of the People's Republic of China-Article 21",
                                "CyberSecurity Law of the People's Republic of China-Article 25",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.n",
                                "HITRUST v.9.4.2-Control Reference:01.o",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-12.6.2",
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2",
                                "ISO/IEC 27002:2013-13.1.3",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-14.2.5",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-18.1.4",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-6.2.2",
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1",
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-16.1.2",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2",
                                "ISO/IEC 27018:2019-12.3.1",
                                "ISO/IEC 27018:2019-18.2.1",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v6.3-T1190",
                                "MITRE ATT&CK v8.2-T1190",
                                "MPAA Content Protection Best Practices",
                                "MPAA Content Protection Best Practices-DS-1.2",
                                "MPAA Content Protection Best Practices-DS-3.0",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Boundary Protection | Block Communication from Non-organizationally Configured Hosts",
                                "NIST 800-53 Rev 5-Boundary Protection | Deny by Default â Allow by Exception",
                                "NIST 800-53 Rev 5-Boundary Protection | Restrict Incoming Communications Traffic",
                                "NIST 800-53 Rev 5-Remote Access | Protection of Confidentiality and Integrity Using Encryption",
                                "NIST 800-53 Rev 5-System Monitoring | Inbound and Outbound Communications Traffic",
                                "NIST 800-53 Rev4-AC-17 (2)",
                                "NIST 800-53 Rev4-SC-7 (11)",
                                "NIST 800-53 Rev4-SC-7 (19)",
                                "NIST 800-53 Rev4-SC-7 (5)",
                                "NIST 800-53 Rev4-SI-4 (4)",
                                "NIST CSF",
                                "NIST CSF-DE.AE-2",
                                "NIST CSF-DE.CM-6",
                                "NIST CSF-DE.CM-7",
                                "NIST CSF-DE.DP-2",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-PR.AC-5",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5",
                                "NIST CSF-PR.PT-4",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6",
                                "NIST SP 800-171 Revision 2-3.14.6",
                                "NIST SP 800-172-3.14.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group allows SQLServer (TCP Port 1433 and UDP Port 1434)",
                    "description": "This policy detects any NSG rule that allows SQLServer traffic on TCP Port 1433 and UDP Port 1434 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict SQLServer solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-026",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-026",
                            "eval": "data.rule.inbound_port_23",
                            "message": "data.rule.inbound_port_23_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_026.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-07",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-DSP-17",
                                "CSA CCM v.4.0.1-HRS-04",
                                "CSA CCM v.4.0.1-IVS-03",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CSA CCM v.4.0.1-STA-14",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-05",
                                "CSA CCM v.4.0.1-UEM-11",
                                "CyberSecurity Law of the People's Republic of China-Article 21",
                                "CyberSecurity Law of the People's Republic of China-Article 25",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.n",
                                "HITRUST v.9.4.2-Control Reference:01.o",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-12.6.2",
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2",
                                "ISO/IEC 27002:2013-13.1.3",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-14.2.5",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-18.1.4",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-6.2.2",
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1",
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-16.1.2",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2",
                                "ISO/IEC 27018:2019-12.3.1",
                                "ISO/IEC 27018:2019-18.2.1",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v6.3-T1108",
                                "MITRE ATT&CK v6.3-T1108",
                                "MPAA Content Protection Best Practices",
                                "MPAA Content Protection Best Practices-DS-1.2",
                                "MPAA Content Protection Best Practices-DS-3.0",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Boundary Protection | Block Communication from Non-organizationally Configured Hosts",
                                "NIST 800-53 Rev 5-Boundary Protection | Deny by Default â Allow by Exception",
                                "NIST 800-53 Rev 5-Boundary Protection | Restrict Incoming Communications Traffic",
                                "NIST 800-53 Rev 5-Remote Access | Protection of Confidentiality and Integrity Using Encryption",
                                "NIST 800-53 Rev 5-System Monitoring | Inbound and Outbound Communications Traffic",
                                "NIST 800-53 Rev4-AC-17 (2)",
                                "NIST 800-53 Rev4-SC-7 (11)",
                                "NIST 800-53 Rev4-SC-7 (19)",
                                "NIST 800-53 Rev4-SC-7 (5)",
                                "NIST 800-53 Rev4-SI-4 (4)",
                                "NIST CSF",
                                "NIST CSF-DE.AE-2",
                                "NIST CSF-DE.CM-6",
                                "NIST CSF-DE.CM-7",
                                "NIST CSF-DE.DP-2",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-PR.AC-5",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5",
                                "NIST CSF-PR.PT-4",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6",
                                "NIST SP 800-171 Revision 2-3.14.6",
                                "NIST SP 800-172-3.14.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group should not allow Telnet (TCP Port 23)",
                    "description": "Telnet provides a plaintext connection to manage devices using the command line, and is less secure than SSH.<br>This policy detects any NSG rule that allows Telnet traffic on TCP port 23 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict Telnet solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-027",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-027",
                            "eval": "data.rule.inbound_port_5500",
                            "message": "data.rule.inbound_port_5500_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_027.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-07",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-DSP-17",
                                "CSA CCM v.4.0.1-HRS-04",
                                "CSA CCM v.4.0.1-IVS-03",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CSA CCM v.4.0.1-STA-14",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-05",
                                "CSA CCM v.4.0.1-UEM-11",
                                "CyberSecurity Law of the People's Republic of China-Article 21",
                                "CyberSecurity Law of the People's Republic of China-Article 25",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.n",
                                "HITRUST v.9.4.2-Control Reference:01.o",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-12.6.2",
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2",
                                "ISO/IEC 27002:2013-13.1.3",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-14.2.5",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-18.1.4",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-6.2.2",
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1",
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-16.1.2",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2",
                                "ISO/IEC 27018:2019-12.3.1",
                                "ISO/IEC 27018:2019-18.2.1",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v6.3-T1108",
                                "MITRE ATT&CK v6.3-T1108",
                                "MPAA Content Protection Best Practices",
                                "MPAA Content Protection Best Practices-DS-1.2",
                                "MPAA Content Protection Best Practices-DS-3.0",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Boundary Protection | Block Communication from Non-organizationally Configured Hosts",
                                "NIST 800-53 Rev 5-Boundary Protection | Deny by Default â Allow by Exception",
                                "NIST 800-53 Rev 5-Boundary Protection | Restrict Incoming Communications Traffic",
                                "NIST 800-53 Rev 5-Remote Access | Protection of Confidentiality and Integrity Using Encryption",
                                "NIST 800-53 Rev 5-System Monitoring | Inbound and Outbound Communications Traffic",
                                "NIST 800-53 Rev4-AC-17 (2)",
                                "NIST 800-53 Rev4-SC-7 (11)",
                                "NIST 800-53 Rev4-SC-7 (19)",
                                "NIST 800-53 Rev4-SC-7 (5)",
                                "NIST 800-53 Rev4-SI-4 (4)",
                                "NIST CSF",
                                "NIST CSF-DE.AE-2",
                                "NIST CSF-DE.CM-6",
                                "NIST CSF-DE.CM-7",
                                "NIST CSF-DE.DP-2",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-PR.AC-5",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5",
                                "NIST CSF-PR.PT-4",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6",
                                "NIST SP 800-171 Revision 2-3.14.6",
                                "NIST SP 800-172-3.14.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group should not allow VNC Listener (TCP Port 5500)",
                    "description": "This policy detects any NSG rule that allows VNC Listener traffic on TCP port 5500 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict VNC Listener solely to known static IP addresses. Limit the access list to include known hosts, services,     or specific employees only."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-028",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-028",
                            "eval": "data.rule.inbound_port_5900",
                            "message": "data.rule.inbound_port_5900_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_028.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-07",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-DSP-17",
                                "CSA CCM v.4.0.1-HRS-04",
                                "CSA CCM v.4.0.1-IVS-03",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CSA CCM v.4.0.1-STA-14",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-05",
                                "CSA CCM v.4.0.1-UEM-11",
                                "CyberSecurity Law of the People's Republic of China-Article 21",
                                "CyberSecurity Law of the People's Republic of China-Article 25",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.n",
                                "HITRUST v.9.4.2-Control Reference:01.o",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-12.6.2",
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2",
                                "ISO/IEC 27002:2013-13.1.3",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-14.2.5",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-18.1.4",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-6.2.2",
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1",
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-16.1.2",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2",
                                "ISO/IEC 27018:2019-12.3.1",
                                "ISO/IEC 27018:2019-18.2.1",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v6.3-T1108",
                                "MITRE ATT&CK v6.3-T1108",
                                "MPAA Content Protection Best Practices",
                                "MPAA Content Protection Best Practices-DS-1.2",
                                "MPAA Content Protection Best Practices-DS-3.0",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Boundary Protection | Block Communication from Non-organizationally Configured Hosts",
                                "NIST 800-53 Rev 5-Boundary Protection | Deny by Default â Allow by Exception",
                                "NIST 800-53 Rev 5-Boundary Protection | Restrict Incoming Communications Traffic",
                                "NIST 800-53 Rev 5-Remote Access | Protection of Confidentiality and Integrity Using Encryption",
                                "NIST 800-53 Rev 5-System Monitoring | Inbound and Outbound Communications Traffic",
                                "NIST 800-53 Rev4-AC-17 (2)",
                                "NIST 800-53 Rev4-SC-7 (11)",
                                "NIST 800-53 Rev4-SC-7 (19)",
                                "NIST 800-53 Rev4-SC-7 (5)",
                                "NIST 800-53 Rev4-SI-4 (4)",
                                "NIST CSF",
                                "NIST CSF-DE.AE-2",
                                "NIST CSF-DE.CM-6",
                                "NIST CSF-DE.CM-7",
                                "NIST CSF-DE.DP-2",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-PR.AC-5",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5",
                                "NIST CSF-PR.PT-4",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6",
                                "NIST SP 800-171 Revision 2-3.14.6",
                                "NIST SP 800-172-3.14.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group should not allow VNC Server (TCP Port 5900)",
                    "description": "This policy detects any NSG rule that allows VNC Server traffic on TCP port 5900 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict VNC Server solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-029",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-029",
                            "eval": "data.rule.inbound_port_135",
                            "message": "data.rule.inbound_port_135_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_029.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-07",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-DSP-17",
                                "CSA CCM v.4.0.1-HRS-04",
                                "CSA CCM v.4.0.1-IVS-03",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CSA CCM v.4.0.1-STA-14",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-05",
                                "CSA CCM v.4.0.1-UEM-11",
                                "CyberSecurity Law of the People's Republic of China-Article 21",
                                "CyberSecurity Law of the People's Republic of China-Article 25",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.n",
                                "HITRUST v.9.4.2-Control Reference:01.o",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-12.6.2",
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2", 
                                "ISO/IEC 27002:2013-13.1.3", 
                                "ISO/IEC 27002:2013-13.2.1", 
                                "ISO/IEC 27002:2013-13.2.3", 
                                "ISO/IEC 27002:2013-14.1.1", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.1.3", 
                                "ISO/IEC 27002:2013-14.2.4", 
                                "ISO/IEC 27002:2013-14.2.5", 
                                "ISO/IEC 27002:2013-16.1.1", 
                                "ISO/IEC 27002:2013-16.1.2", 
                                "ISO/IEC 27002:2013-16.1.3", 
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-18.1.4", 
                                "ISO/IEC 27002:2013-18.2.1", 
                                "ISO/IEC 27002:2013-5.1.1", 
                                "ISO/IEC 27002:2013-6.2.2", 
                                "ISO/IEC 27002:2013-8.3.1", 
                                "ISO/IEC 27002:2013-8.3.3", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2", 
                                "ISO/IEC 27017:2015-16.1.2", 
                                "ISO/IEC 27017:2015-6.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2", 
                                "ISO/IEC 27018:2019-12.3.1", 
                                "ISO/IEC 27018:2019-18.2.1", 
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v6.3-T1190", 
                                "MITRE ATT&CK v8.2-T1190", 
                                "MPAA Content Protection Best Practices-DS-1.2", 
                                "MPAA Content Protection Best Practices-DS-3.0", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Boundary Protection | Block Communication from Non-organizationally Configured Hosts", 
                                "NIST 800-53 Rev 5-Boundary Protection | Deny by Default â Allow by Exception", 
                                "NIST 800-53 Rev 5-Boundary Protection | Restrict Incoming Communications Traffic", 
                                "NIST 800-53 Rev 5-Remote Access | Protection of Confidentiality and Integrity Using Encryption", 
                                "NIST 800-53 Rev 5-System Monitoring | Inbound and Outbound Communications Traffic", 
                                "NIST 800-53 Rev4-AC-17 (2), NIST 800-53 Rev4-SC-7 (11)", 
                                "NIST 800-53 Rev4-SC-7 (19), NIST 800-53 Rev4-SC-7 (5)", 
                                "NIST 800-53 Rev4-SI-4 (4), NIST CSF-DE.AE-2", 
                                "NIST CSF",
                                "NIST CSF-DE.CM-6", 
                                "NIST CSF-DE.CM-7", 
                                "NIST CSF-DE.DP-2", 
                                "NIST CSF-ID.RA-1", 
                                "NIST CSF-PR.AC-5", 
                                "NIST CSF-PR.DS-1", 
                                "NIST CSF-PR.DS-5", 
                                "NIST CSF-PR.PT-4", 
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6", 
                                "NIST SP 800-171 Revision 2-3.14.6", 
                                "NIST SP 800-172-3.14.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1", 
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group should not allow Windows RPC (TCP Port 135)",
                    "description": "This policy detects any NSG rule that allows Windows RPC traffic on TCP port 135 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict Windows RPC solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-030",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-030",
                            "eval": "data.rule.nsg_out_all",
                            "message": "data.rule.nsg_out_all_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_030.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-CEK-03",
                                "CSA CCM v.4.0.1-DSP-07",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-DSP-17",
                                "CSA CCM v.4.0.1-HRS-04",
                                "CSA CCM v.4.0.1-IVS-03",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-13",
                                "CSA CCM v.4.0.1-STA-14",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-05",
                                "CSA CCM v.4.0.1-UEM-11",
                                "CyberSecurity Law of the People's Republic of China-Article 21",
                                "CyberSecurity Law of the People's Republic of China-Article 25",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.183",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SI.2.216",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.n",
                                "HITRUST v.9.4.2-Control Reference:01.o",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-12.6.2",
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2",
                                "ISO/IEC 27002:2013-13.1.3",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.1.3",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-14.2.5",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-18.1.4",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-6.2.2",
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1",
                                "ISO/IEC 27017:2015-10.1.2",
                                "ISO/IEC 27017:2015-16.1.2",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2",
                                "ISO/IEC 27018:2019-12.3.1",
                                "ISO/IEC 27018:2019-18.2.1",
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v6.3-T1190",
                                "MITRE ATT&CK v8.2-T1190",
                                "NIST 800",
                                "NIST 800-53 Rev 5-Boundary Protection | Block Communication from Non-organizationally Configured Hosts",
                                "NIST 800-53 Rev 5-Boundary Protection | Deny by Default â Allow by Exception",
                                "NIST 800-53 Rev 5-Boundary Protection | Restrict Incoming Communications Traffic",
                                "NIST 800-53 Rev 5-Remote Access | Protection of Confidentiality and Integrity Using Encryption",
                                "NIST 800-53 Rev 5-System Monitoring | Inbound and Outbound Communications Traffic",
                                "NIST 800-53 Rev4-AC-17 (2)",
                                "NIST 800-53 Rev4-SC-7 (11)",
                                "NIST 800-53 Rev4-SC-7 (19)",
                                "NIST 800-53 Rev4-SC-7 (5)",
                                "NIST 800-53 Rev4-SI-4 (4)",
                                "NIST CSF",
                                "NIST CSF-DE.AE-2",
                                "NIST CSF-DE.CM-6",
                                "NIST CSF-DE.CM-7",
                                "NIST CSF-DE.DP-2",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-PR.AC-5",
                                "NIST CSF-PR.DS-1",
                                "NIST CSF-PR.DS-5",
                                "NIST CSF-PR.PT-4",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.6",
                                "NIST SP 800-171 Revision 2-3.14.6",
                                "NIST SP 800-172-3.14.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.2.1",
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "Low",
                    "title": "Azure Network Security Group with Outbound rule to should not allow all traffic to any source",
                    "description": "This policy identifies NSGs which allows outgoing traffic to any source. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic to known sources on authorized protocols and ports."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-031",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-031",
                            "eval": "data.rule.outbound_port_bitcoin",
                            "message": "data.rule.outbound_port_bitcoin_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_031.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "HIPAA",
                                "NIST CSF"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "Medium",
                    "title": "Instance should not be allowed with ports known to mine Bitcoin",
                    "description": "Identifies traffic from internal workloads to internet IPs on ports 8332,8333 that are known to mine Bitcoins. Unless this traffic is part of authorized applications and processes, your instances may have been compromised."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-032",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-032",
                            "eval": "data.rule.outbound_port_ethereum",
                            "message": "data.rule.outbound_port_ethereum_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_032.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "HIPAA",
                                "NIST CSF"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "Medium",
                    "title": "Instance should not be allowed communicating with ports known to mine Ethereum",
                    "description": "Identifies traffic from internal workloads to internet IPs on ports 8545,30303 that are known to mine Ethereum. Unless this traffic is part of authorized applications and processes, your instances may have been compromised."
                },
                {
                    "masterTestId": "PR-AZR-CLD-NSG-017",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-NSG-017",
                            "eval": "data.rule.inbound_omi_port_blocked",
                            "message": "data.rule.inbound_omi_port_blocked_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/security/fundamentals/network-overview' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_NSG_017.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group (NSG) should protect OMIGOD attack from internet",
                    "description": "Blocking OMI port 5985, 5986, 1270 will protect vnet/subnet/vms from OMIGOD attacks from internet."
                },
                {
                    "masterTestId": "PR-AZR-CLD-MNT-001",
                    "type": "rego",
                    "rule": "file(activitylogalerts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-MNT-001",
                            "eval": "data.rule.alerts",
                            "message": "data.rule.alerts_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='' target=https://docs.microsoft.com/en-us/azure/azure-monitor/alerts/activity-log-alerts'_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_MNT_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Management and governance"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_299"
                    ],
                    "severity": "Low",
                    "title": "Activity log alerts settings should be enabled",
                    "description": "Activity log alerts are alerts that activate when a new activity log event occurs that matches the conditions specified in the alert. Based on the order and volume of the events recorded in Azure activity log, the alert rule will fire. Activity log alert rules are Azure resources, so they can be created by using an Azure Resource Manager template. "
                },
                {
                    "masterTestId": "PR-AZR-CLD-MNT-009",
                    "type": "rego",
                    "rule": "file(activitylogalerts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-MNT-009",
                            "eval": "data.rule.log_profiles_retention_days",
                            "message": "data.rule.log_profiles_retention_days_err",
                            "remediationDescription": "To change the policy using the Azure Portal, follow these steps:<br><br>1. Log in to the Azure Portal at https://portal.azure.com.<br>2. Navigate to the Activity log.<br>3. Select Export.<br>4. Set Retention (days) to 365 or 0.<br>5. Click Save.",
                            "remediationFunction": "PR_AZR_CLD_MNT_009.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "APRA (CPS 234) Information Security-CPS234-35", 
                                "APRA (CPS 234) Information Security-CPS234-36", 
                                "Brazilian Data Protection Law (LGPD)-Article 16", 
                                "Brazilian Data Protection Law (LGPD)-Article 40",
                                "CCPA", 
                                "CCPA 2018-1798.150(a)(1)",
                                "CIS", 
                                "CIS v1.1 (Azure)-5.1.2",
                                "CSA CCM", 
                                "CSA CCM v3.0.1-BCR-11", 
                                "CSA CCM v3.0.1-GRM-01", 
                                "CSA CCM v3.0.1-MOS-19", 
                                "CyberSecurity Law of the People's Republic of China-Article 34", 
                                "CyberSecurity Law of the People's Republic of China-Article 55", 
                                "CyberSecurity Law of the People's Republic of China-Article 56", 
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AU.2.042",
                                "HIPAA", 
                                "HIPAA-164.312(b)",
                                "HITRUST", 
                                "HITRUST CSF v9.3-Control Reference:06.c", 
                                "HITRUST CSF v9.3-Control Reference:06.d", 
                                "HITRUST CSF v9.3-Control Reference:09.aa", 
                                "HITRUST CSF v9.3-Control Reference:09.q", 
                                "HITRUST CSF v9.3-Control Reference:10.k", 
                                "HITRUST CSF v9.3-Control Reference:11.e",
                                "ISO/IEC 27002:2013", 
                                "ISO/IEC 27001:2013-A.12.4.2", 
                                "ISO/IEC 27001:2013-A.18.1.3", 
                                "NIST 800",
                                "NIST 800-53 Rev4-AU-11", 
                                "NIST 800-53 Rev4-CM-2 (3)", 
                                "NIST 800-53 Rev4-SI-12",
                                "NIST CSF", 
                                "NIST CSF-PR.IP-2",
                                "NIST SP", 
                                "NIST SP 800",
                                "NIST SP 800-171 Revision 2-3.3.2", 
                                "NIST SP 800-172-3.1.1e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-10.7", 
                                "PIPEDA",
                                "PIPEDA-4.5.2", 
                                "SOC 2",
                                "SOC 2-CC6.1", 
                                "SOC 2-CC6.6", 
                                "SOC 2-CC7.2", 
                                "SOC 2-CC7.3", 
                                "SOC 2-CC7.4", 
                                "SOC 2-CC7.5", 
                                "SOC 2-CC8.1"
                            ],
                            "service": [
                                "Management and governance"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_501"
                    ],
                    "severity": "Medium",
                    "title": "activity log retention should be set to 365 days or greater",
                    "description": "Specifies the retention policy for the log. We recommend you set activity log retention for 365 days or greater. (A value of 0 will retain the events indefinitely.)"
                },
                {
                    "masterTestId": "PR-AZR-CLD-MNT-010",
                    "type": "rego",
                    "rule": "file(activitylogalerts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-MNT-010",
                            "eval": "data.rule.log_profiles_retention_enabled",
                            "message": "data.rule.log_profiles_retention_enabled_err",
                            "remediationDescription": "To change the policy using the Azure Portal, follow these steps:<br><br>1. Log in to the Azure Portal at https://portal.azure.com.<br>2. Navigate to the Activity log.<br>3. Select Export.<br>4. Set Retention (days) to 365 or 0.<br>5. Click Save.",
                            "remediationFunction": "PR_AZR_CLD_MNT_010.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Management and governance"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_501"
                    ],
                    "severity": "High",
                    "title": "Activity log profile retention should be enabled",
                    "description": "This policy identifies Microsoft.Insights/logprofiles which don't have log retention enabled. Activity Logs can be used to check for anomalies and give insight into suspected breaches or misuse of information and access."
                },
                {
                    "masterTestId": "PR-AZR-CLD-MNT-011",
                    "type": "rego",
                    "rule": "file(activitylogalerts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-MNT-011",
                            "eval": "data.rule.log_profile_category",
                            "message": "data.rule.log_profile_category_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/activity-log' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_MNT_011.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Management and governance"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_501"
                    ],
                    "severity": "High",
                    "title": "log profile should be configured to capture all activities",
                    "description": "the categories of the logs. These categories are created as is convenient to the user. Some values are: 'Write', 'Delete', and/or 'Action.' We recommend you configure the log profile to export all activities from the control/management plane."
                },
                {
                    "masterTestId": "PR-AZR-CLD-STR-001",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-STR-001",
                            "eval": "data.rule.storage_blob_soft_delete",
                            "message": "data.rule.storage_blob_soft_delete_err",
                            "remediationDescription": "To enable blob soft delete for your storage account by using the Azure portal, follow these steps:<br><br>1. In the Azure portal, navigate to your storage account.<br>2. Locate the Data Protection option under Blob service.<br>3. In the Recovery section, select Turn on soft delete for blobs.<br>4. Specify a retention period between 1 and 365 days. Microsoft recommends a minimum retention period of seven days.<br>5. Save your changes.",
                            "remediationFunction": "PR_AZR_CLD_STR_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITTRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ],
                    "severity": "Medium",
                    "title": "Soft delete on blob service should be enabled",
                    "description": "The blob service properties for blob soft delete. It helps to restore removed blob within configured retention days"
                },
                {
                    "masterTestId": "PR-AZR-CLD-STR-002",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-STR-002",
                            "eval": "data.rule.storage_blob_container_soft_delete",
                            "message": "data.rule.storage_blob_container_soft_delete_err",
                            "remediationDescription": "To enable blob soft delete for your storage account by using the Azure portal, follow these steps:<br><br>1. In the Azure portal, navigate to your storage account.<br>2. Locate the Data Protection option under Blob service.<br>3. In the Recovery section, select Turn on soft delete for blobs.<br>4. Specify a retention period between 1 and 365 days. Microsoft recommends a minimum retention period of seven days.<br>5. Save your changes.",
                            "remediationFunction": "PR_AZR_CLD_STR_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITTRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ],
                    "severity": "Medium",
                    "title": "Soft delete on blob service container should be enabled",
                    "description": "The blob service properties for container soft delete. It helps to restore removed blob containers within configured retention days."
                },
                {
                    "masterTestId": "PR-AZR-CLD-AML-008",
                    "type": "rego",
                    "rule": "file(locks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AML-008",
                            "eval": "data.rule.rg_locks",
                            "message": "data.rule.rg_locks_err",
                            "remediationDescription": "1. In the Settings blade for the resource, resource group, or subscription that you wish to lock, select Locks.<br>2. To add a lock, select Add. If you want to create a lock at a parent level, select the parent. The currently selected resource inherits the lock from the parent. For example, you could lock the resource group to apply a lock to all its resources.<br>3. Give the lock a name and lock level. Optionally, you can add notes that describe the lock.",
                            "remediationFunction": "PR_AZR_CLD_AML_008.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15",
                                "APRA (CPS 234) Information Security-CPS234-16",
                                "APRA (CPS 234) Information Security-CPS234-17",
                                "APRA (CPS 234) Information Security-CPS234-21",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v3)-AM-4",
                                "Azure Security Benchmark (v3)-IM-7",
                                "Azure Security Benchmark (v3)-PA-7",
                                "Brazilian Data Protection Law (LGPD)-Article 49",
                                "CIS",
                                "CIS v1.1 (Azure)-8.3",
                                "CIS v1.2.0 (Azure)-8.3",
                                "CIS v1.3.0 (Azure)-8.3",
                                "CIS v1.3.1 (Azure)-8.3",
                                "CIS v1.4.0 (Azure)-8.5",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-AIS-01",
                                "CSA CCM v.4.0.1-AIS-02",
                                "CSA CCM v.4.0.1-AIS-04",
                                "CSA CCM v.4.0.1-CCC-01",
                                "CSA CCM v.4.0.1-GRC-03",
                                "CSA CCM v.4.0.1-IVS-04",
                                "CSA CCM v.4.0.1-UEM-06",
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AM.4.226",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:10.a",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.1.2",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.2.1",
                                "ISO/IEC 27002:2013-14.2.2",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.1.2",
                                "ISO/IEC 27017:2015-14.1.1",
                                "ISO/IEC 27017:2015-14.1.2",
                                "ISO/IEC 27017:2015-14.2.1",
                                "ISO/IEC 27017:2015-14.2.5",
                                "ISO/IEC 27017:2015-5.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-12.1.2",
                                "NIST CSF",
                                "NIST CSF-PR.IP-1",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.4.2",
                                "NIST SP 800-172-3.4.1e",
                                "NIST SP 800-172-3.4.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-6.3"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_503",
                        "AZRSNP_261"
                    ],
                    "severity": "Low",
                    "title": "Azure Deployment Scope Resource Group should have a remove protection resource lock configured",
                    "description": "Azure Resource Manager locks provide a way to lock down Azure resources from being deleted or modified. The lock level can be set to either 'CanNotDelete' or 'ReadOnly'. When you apply a lock at a parent scope, all resources within the scope inherit the same lock, and the most restrictive lock takes precedence.<br><br>This policy identifies Azure Resource Groups that do not have a lock set. As a best practice, place a lock on important resources to prevent accidental or malicious modification or deletion by unauthorized users."
                },
                {
                    "masterTestId": "PR-AZR-CLD-ASC-001",
                    "type": "rego",
                    "rule": "file(pricing.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ASC-001",
                            "eval": "data.rule.pricing",
                            "message": "data.rule.pricing_err",
                            "remediationDescription": "To change the policy using the Azure Portal, follow these steps:<br>1. Log in to the Azure Portal at https://portal.azure.com.<br>2. Navigate to the Azure Security Center.<br>3. Select Security policy blade.<br>4. To alter the the security policy for a subscription, click Edit Settings.<br>5. Select Pricing tier blade.<br>6. Select Standard.<br>7. Select Save.",
                            "remediationFunction": "PR_AZR_CLD_ASC_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "ISO 27001"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_300"
                    ],
                    "severity": "High",
                    "title": "Azure Security Center should have pricing tier configured to 'standard'",
                    "description": "Selecting the standard pricing tier will enable threat detection for networks and virtual systems by providing threat intelligence, anomaly detection, and behavior analytics in Azure Security Center."
                },
                {
                    "masterTestId": "PR-AZR-CLD-ASC-002",
                    "type": "rego",
                    "rule": "file(securitycontacts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ASC-002",
                            "eval": "data.rule.securitycontacts",
                            "message": "data.rule.securitycontacts_err",
                            "remediationDescription": "1. From Defender for Cloud's Environment settings area, select the relevant subscription, and open Email notifications.<br><br2. Define the recipients for your notifications with one or both of these options:<br>From the dropdown list,a) select from the available roles.<br>b) Enter specific email addresses separated by commas. There's no limit to the number of email addresses that you can enter.<br><br>3. To apply the security contact information to your subscription, select Save.<br><br>For more information please click <a href='https://docs.microsoft.com/en-us/azure/defender-for-cloud/configure-email-notifications' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_ASC_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_296"
                    ],
                    "severity": "Low",
                    "title": "Security Center should have security contact emails configured to get notifications",
                    "description": "Setting a valid email address in Security contact emails will enable Microsoft to contact you if the Microsoft Security Response Center (MSRC) discovers that your data has been accessed by an unlawful or unauthorized party. This will make sure that you are aware of any security issues and take prompt actions to mitigate the risks."
                },
                {
                    "masterTestId": "PR-AZR-CLD-ASC-003",
                    "type": "rego",
                    "rule": "file(securitycontacts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ASC-003",
                            "eval": "data.rule.alert_notifications",
                            "message": "data.rule.alert_notifications_err",
                            "remediationDescription": "1. From Defender for Cloud's Environment settings area, select the relevant subscription, and open Email notifications.<br><br2. Define the recipients for your notifications with one or both of these options:<br>From the dropdown list,a) select from the available roles.<br>b) Enter specific email addresses separated by commas. There's no limit to the number of email addresses that you can enter.<br><br>3. To apply the security contact information to your subscription, select Save.<br><br>For more information please click <a href='https://docs.microsoft.com/en-us/azure/defender-for-cloud/configure-email-notifications' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_ASC_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_296"
                    ],
                    "severity": "Medium",
                    "title": "Send email notification should be enabled",
                    "description": "Setting the security alert Send email notification for alerts to On ensures that emails are sent from Microsoft if their security team determines a potential security breach has taken place."
                },
                {
                    "masterTestId": "PR-AZR-CLD-ASC-005",
                    "type": "rego",
                    "rule": "file(securitycontacts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-ASC-005",
                            "eval": "data.rule.securitycontacts_alerts_to_admins_enabled",
                            "message": "data.rule.securitycontacts_alerts_to_admins_enabled_err",
                            "remediationDescription": "1. From Defender for Cloud's Environment settings area, select the relevant subscription, and open Email notifications.<br><br2. Define the recipients for your notifications with one or both of these options:<br>From the dropdown list,a) select from the available roles.<br>b) Enter specific email addresses separated by commas. There's no limit to the number of email addresses that you can enter.<br><br>3. To apply the security contact information to your subscription, select Save.<br><br>For more information please click <a href='https://docs.microsoft.com/en-us/azure/defender-for-cloud/configure-email-notifications' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_ASC_005.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_296"
                    ],
                    "severity": "Medium",
                    "title": "Security Center should send security alerts notifications to subscription admins",
                    "description": "This policy will identify security centers which dont have configuration enabled to send security alerts notifications to subscription admins and alert if missing."
                },
                {
                    "masterTestId": "PR-AZR-CLD-AFW-001",
                    "type": "rego",
                    "rule": "file(azure_firewalls.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AFW-001",
                            "eval": "data.rule.azure_firewall_configured_with_idpc_and_tls_inspection",
                            "message": "data.rule.azure_firewall_configured_with_idpc_and_tls_inspection_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/firewall/premium-features' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_AFW_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_225",
                        "AZRSNP_230"
                    ],
                    "severity": "High",
                    "title": "Azure Firewall Premium should be configured with both IDPS Alert & Deny mode and TLS inspection enabled for proactive protection against CVE-2021-44228 exploit",
                    "description": "Azure Firewall Premium has enhanced protection from the Log4j RCE CVE-2021-44228 vulnerability and exploit. Azure Firewall premium IDPS (Intrusion Detection and Prevention System) provides IDPS inspection for all east-west traffic and outbound traffic to internet. details at https://www.microsoft.com/security/blog/2021/12/11/guidance-for-preventing-detecting-and-hunting-for-cve-2021-44228-log4j-2-exploitation/"
                },
                {
                    "masterTestId": "PR-AZR-CLD-FRD-001",
                    "type": "rego",
                    "rule": "file(frontdoors.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-FRD-001",
                            "eval": "data.rule.frontdoors_has_drs_configured",
                            "message": "data.rule.frontdoors_has_drs_configured_err",
                            "remediationDescription": "Follow the guideline mentioned <a href='https://docs.microsoft.com/en-us/azure/web-application-firewall/afds/waf-front-door-tuning#understanding-waf-logs' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_CLD_FRD_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_220",
                        "AZRSNP_502"
                    ],
                    "severity": "High",
                    "title": "Azure frontDoors should have configured with WAF policy with Default Rule Set 1.0/1.1 for proactive protection against CVE-2021-44228 exploit",
                    "description": "It is recommended to enable WAF policy with Default Rule Set 1.0/1.1 on Front Door deployments to immediately avail of additional protection from log4j Remote Command Execution. details at https://www.microsoft.com/security/blog/2021/12/11/guidance-for-preventing-detecting-and-hunting-for-cve-2021-44228-log4j-2-exploitation/"
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-051",
                    "masterSnapshotId": [
                        "AZRSNP_399",
                        "AZRSNP_400"
                    ],
                    "type": "rego",
                    "rule": "file(sql_vulnerabilityassessments.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-051",
                            "eval": "data.rule.sql_ads_scan",
                            "message": "data.rule.sql_ads_scan_err",
                            "remediationDescription": "Make sure you are following the ARM template guidelines for SQL Server by visiting <a href='https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/servers/vulnerabilityassessments?tabs=json' target='_blank'>here</a>. recurringScans.isEnabled should be true",
                            "remediationFunction": "PR_AZR_CLD_SQL_051.py"
                        }
                    ],
                    "severity": "Low",
                    "title": "Azure SQL Server advanced data security recurring scans should be enabled",
                    "description": "Advanced data security (ADS) provides a set of advanced SQL security capabilities, including vulnerability assessment, threat detection, and data discovery and classification.<br><br>This policy identifies Azure SQL servers that do not have ADS enabled. As a best practice, enable ADS on mission-critical SQL servers.",
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-GS-7",
                                "Azure Security Benchmark (v2)-IR-1",
                                "Azure Security Benchmark (v2)-IR-4",
                                "Azure Security Benchmark (v2)-IR-6",
                                "Azure Security Benchmark (v3)-DS-6",
                                "Azure Security Benchmark (v3)-PV-5",
                                "CIS",
                                "CIS v1.2.0 (Azure)-4.2.6",
                                "CIS v1.3.0 (Azure)-4.2.3",
                                "CIS v1.3.1 (Azure)-4.2.3",
                                "CIS v1.4.0 (Azure)-4.2.3",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-AIS-01",
                                "CSA CCM v.4.0.1-AIS-02",
                                "CSA CCM v.4.0.1-AIS-04",
                                "CSA CCM v.4.0.1-CCC-01",
                                "CSA CCM v.4.0.1-DSP-01",
                                "CSA CCM v.4.0.1-DSP-04",
                                "CSA CCM v.4.0.1-GRC-03",
                                "CSA CCM v.4.0.1-IVS-04",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-06",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:10.m",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.1.1",
                                "ISO/IEC 27002:2013-12.1.2",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.2.1",
                                "ISO/IEC 27002:2013-14.2.2",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-5.1.2",
                                "ISO/IEC 27002:2013-8.2.1",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.1.2",
                                "ISO/IEC 27017:2015-14.1.1",
                                "ISO/IEC 27017:2015-14.1.2",
                                "ISO/IEC 27017:2015-14.2.1",
                                "ISO/IEC 27017:2015-14.2.5",
                                "ISO/IEC 27017:2015-5.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-12.1.2",
                                "ISO/IEC 27018:2019-18.2.1",
                                "NIST CSF",
                                "NIST CSF-DE.AE-4",
                                "NIST CSF-DE.CM-8",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-ID.RA-3",
                                "NIST CSF-ID.RA-4",
                                "NIST CSF-ID.RA-5",
                                "NIST CSF-PR.IP-1",
                                "NIST CSF-RS.AN-2",
                                "NIST CSF-RS.MI-3",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.11.1",
                                "NIST SP 800-171 Revision 2-3.11.2",
                                "NIST SP 800-172-3.12.1e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-6.1",
                                "PCI DSS v3.2.1-6.2"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ]
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-053",
                    "masterSnapshotId": [
                        "AZRSNP_399",
                        "AZRSNP_400"
                    ],
                    "type": "rego",
                    "rule": "file(sql_vulnerabilityassessments.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-053",
                            "eval": "data.rule.sql_ads_mail",
                            "message": "data.rule.sql_ads_mail_err",
                            "remediationDescription": "Make sure you are following the ARM template guidelines for SQL Server by visiting <a href='https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/servers/vulnerabilityassessments?tabs=json' target='_blank'>here</a>. Specify e-mail addresses at recurringScans.emails property to which the scan notification would be sent.",
                            "remediationFunction": "PR_AZR_CLD_SQL_053.py"
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure SQL Server advanced data security should have email alert recipient to get scan notification",
                    "description": "Advanced data security (ADS) provides a set of advanced SQL security capabilities, including vulnerability assessment, threat detection, and data discovery and classification.<br><br>This policy identifies Azure SQL Servers that do not have an email address configured for ADS alert notifications. As a best practice, provide one or more email addresses where you want to receive alerts for any anomalous activities detected on SQL Servers.",
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Azure Security Benchmark (v2)-GS-7",
                                "Azure Security Benchmark (v2)-IR-1",
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-IR-4",
                                "Azure Security Benchmark (v2)-IR-6",
                                "Azure Security Benchmark (v3)-DS-6",
                                "Azure Security Benchmark (v3)-PV-5",
                                "CIS",
                                "CIS v1.2.0 (Azure)-4.2.7",
                                "CIS v1.3.0 (Azure)-4.2.4",
                                "CIS v1.3.1 (Azure)-4.2.4",
                                "CIS v1.4.0 (Azure)-4.2.4",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-AIS-01",
                                "CSA CCM v.4.0.1-AIS-02",
                                "CSA CCM v.4.0.1-AIS-04",
                                "CSA CCM v.4.0.1-CCC-01",
                                "CSA CCM v.4.0.1-GRC-03",
                                "CSA CCM v.4.0.1-IVS-04",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-02",
                                "CSA CCM v.4.0.1-TVM-04",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-06",
                                "CSA CCM v.4.0.1-UEM-09",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1",
                                "ISO/IEC 27002:2013-12.1.2",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.2.1",
                                "ISO/IEC 27002:2013-14.2.2",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-5.1.2",
                                "ISO/IEC 27002:2013-6.2.1",
                                "ISO/IEC 27002:2013-6.2.2",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.1.2",
                                "ISO/IEC 27017:2015-12.2.1",
                                "ISO/IEC 27017:2015-14.1.1",
                                "ISO/IEC 27017:2015-14.1.2",
                                "ISO/IEC 27017:2015-14.2.1",
                                "ISO/IEC 27017:2015-14.2.5",
                                "ISO/IEC 27017:2015-5.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-12.1.2",
                                "ISO/IEC 27018:2019-18.2.1",
                                "NIST CSF",
                                "NIST CSF-DE.CM-4",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-ID.RA-2",
                                "NIST CSF-ID.RA-3",
                                "NIST CSF-PR.IP-1",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.1.9",
                                "NIST SP 800-171 Revision 2-3.14.3",
                                "NIST SP 800-172-3.4.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-A3.3.1"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ]
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-055",
                    "masterSnapshotId": [
                        "AZRSNP_399",
                        "AZRSNP_400"
                    ],
                    "type": "rego",
                    "rule": "file(sql_vulnerabilityassessments.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-055",
                            "eval": "data.rule.db_ads_alert",
                            "message": "data.rule.db_ads_alert_err",
                            "remediationDescription": "Make sure you are following the ARM template guidelines for SQL Server by visiting <a href='https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/servers/vulnerabilityassessments?tabs=json' target='_blank'>here</a>. Specify admin e-mail address at recurringScans.emailSubscriptionAdmins property where the schedule scan notification would be sent.",
                            "remediationFunction": "PR_AZR_CLD_SQL_055.py"
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure SQL Server advanced data security should send alerts to subscription administrators",
                    "description": "Advanced data security (ADS) provides a set of advanced SQL security capabilities, including vulnerability assessment, threat detection, and data discovery and classification.<br><br>This policy identifies Azure SQL Servers that are not enabled with ADS. As a best practice, enable ADS so that the subscription admin can receive email alerts when anomalous activities are detected on the SQL Servers.",
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-DP-3",
                                "Azure Security Benchmark (v3)-DS-6",
                                "Azure Security Benchmark (v3)-PV-5",
                                "CIS",
                                "CIS v1.2.0 (Azure)-4.2.5",
                                "CIS v1.3.0 (Azure)-4.2.2",
                                "CIS v1.3.1 (Azure)-4.2.2",
                                "CIS v1.4.0 (Azure)-4.2.2",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-AIS-01",
                                "CSA CCM v.4.0.1-AIS-02",
                                "CSA CCM v.4.0.1-AIS-04",
                                "CSA CCM v.4.0.1-CCC-01",
                                "CSA CCM v.4.0.1-DSP-01",
                                "CSA CCM v.4.0.1-DSP-04",
                                "CSA CCM v.4.0.1-GRC-03",
                                "CSA CCM v.4.0.1-IVS-04",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-06",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:10.m",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.1.1",
                                "ISO/IEC 27002:2013-12.1.2",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.2.1",
                                "ISO/IEC 27002:2013-14.2.2",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-5.1.2",
                                "ISO/IEC 27002:2013-8.2.1",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.1.2",
                                "ISO/IEC 27017:2015-14.1.1",
                                "ISO/IEC 27017:2015-14.1.2",
                                "ISO/IEC 27017:2015-14.2.1",
                                "ISO/IEC 27017:2015-14.2.5",
                                "ISO/IEC 27017:2015-5.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-12.1.2",
                                "ISO/IEC 27018:2019-18.2.1",
                                "NIST CSF",
                                "NIST CSF-DE.AE-4",
                                "NIST CSF-DE.CM-8",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-ID.RA-3",
                                "NIST CSF-ID.RA-4",
                                "NIST CSF-ID.RA-5",
                                "NIST CSF-PR.IP-1",
                                "NIST CSF-RS.AN-2",
                                "NIST CSF-RS.MI-3",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.11.1",
                                "NIST SP 800-171 Revision 2-3.11.2",
                                "NIST SP 800-172-3.12.1e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-6.1",
                                "PCI DSS v3.2.1-6.2"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ]
                },
                {
                    "masterTestId": "PR-AZR-CLD-SQL-062",
                    "masterSnapshotId": [
                        "AZRSNP_399",
                        "AZRSNP_400"
                    ],
                    "type": "rego",
                    "rule": "file(sql_vulnerabilityassessments.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-SQL-062",
                            "eval": "data.rule.sql_ads_va_configured",
                            "message": "data.rule.sql_ads_va_configured_err",
                            "remediationDescription": "Make sure you are following the ARM template guidelines for SQL Server by visiting <a href='https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/servers/vulnerabilityassessments?tabs=json' target='_blank'>here</a>. storageContainerPath should be exist.",
                            "remediationFunction": "PR_AZR_CLD_SQL_062.py"
                        }
                    ],
                    "severity": "Low",
                    "title": "Azure SQL Server advanced data security should be enabled",
                    "description": "Advanced data security (ADS) provides a set of advanced SQL security capabilities, including vulnerability assessment, threat detection, and data discovery and classification.<br><br>This policy identifies Azure SQL servers that do not have ADS enabled. As a best practice, enable ADS on mission-critical SQL servers.",
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-DP-3",
                                "Azure Security Benchmark (v3)-DS-6",
                                "Azure Security Benchmark (v3)-PV-5",
                                "CIS",
                                "CIS v1.2.0 (Azure)-4.2.5",
                                "CIS v1.3.0 (Azure)-4.2.2",
                                "CIS v1.3.1 (Azure)-4.2.2",
                                "CIS v1.4.0 (Azure)-4.2.2",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-A&A-03",
                                "CSA CCM v.4.0.1-AIS-01",
                                "CSA CCM v.4.0.1-AIS-02",
                                "CSA CCM v.4.0.1-AIS-04",
                                "CSA CCM v.4.0.1-CCC-01",
                                "CSA CCM v.4.0.1-DSP-01",
                                "CSA CCM v.4.0.1-DSP-04",
                                "CSA CCM v.4.0.1-GRC-03",
                                "CSA CCM v.4.0.1-IVS-04",
                                "CSA CCM v.4.0.1-TVM-01",
                                "CSA CCM v.4.0.1-TVM-07",
                                "CSA CCM v.4.0.1-TVM-08",
                                "CSA CCM v.4.0.1-TVM-09",
                                "CSA CCM v.4.0.1-TVM-10",
                                "CSA CCM v.4.0.1-UEM-03",
                                "CSA CCM v.4.0.1-UEM-06",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:10.m",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.1.1",
                                "ISO/IEC 27002:2013-12.1.2",
                                "ISO/IEC 27002:2013-12.6.1",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.2.1",
                                "ISO/IEC 27002:2013-14.2.2",
                                "ISO/IEC 27002:2013-14.2.4",
                                "ISO/IEC 27002:2013-16.1.2",
                                "ISO/IEC 27002:2013-16.1.3",
                                "ISO/IEC 27002:2013-18.2.1",
                                "ISO/IEC 27002:2013-5.1.1",
                                "ISO/IEC 27002:2013-5.1.2",
                                "ISO/IEC 27002:2013-8.2.1",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.1.2",
                                "ISO/IEC 27017:2015-14.1.1",
                                "ISO/IEC 27017:2015-14.1.2",
                                "ISO/IEC 27017:2015-14.2.1",
                                "ISO/IEC 27017:2015-14.2.5",
                                "ISO/IEC 27017:2015-5.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-12.1.2",
                                "ISO/IEC 27018:2019-18.2.1",
                                "NIST CSF",
                                "NIST CSF-DE.AE-4",
                                "NIST CSF-DE.CM-8",
                                "NIST CSF-ID.RA-1",
                                "NIST CSF-ID.RA-3",
                                "NIST CSF-ID.RA-4",
                                "NIST CSF-ID.RA-5",
                                "NIST CSF-PR.IP-1",
                                "NIST CSF-RS.AN-2",
                                "NIST CSF-RS.MI-3",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.11.1",
                                "NIST SP 800-171 Revision 2-3.11.2",
                                "NIST SP 800-172-3.12.1e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-6.1",
                                "PCI DSS v3.2.1-6.2"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ]
                },
                {
                    "masterTestId": "PR-AZR-CLD-VM-004",
                    "type": "rego",
                    "rule": "file(vm.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-VM-004",
                            "eval": "data.rule.vm_usage_managed_disks",
                            "message": "data.rule.vm_usage_managed_disks_err",
                            "remediationDescription": "1. Log in to the Azure Portal<br>2. Select 'Virtual Machines' from the left pane<br>3. Select the reported virtual machine<br>4. Select 'Disks' under 'Settings'<br>5. Click on 'Migrate to managed disks'<br>6. Select 'Migrate'",
                            "remediationFunction": "PR_AZR_CLD_VM_004.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-NS-1",
                                "Azure Security Benchmark (v3)-GS-3",
                                "CIS",
                                "CIS v1.2.0 (Azure)-7.1",
                                "CIS v1.3.0 (Azure)-7.1",
                                "CIS v1.3.1 (Azure)-7.1",
                                "CIS v1.4.0 (Azure)-7.1",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-AIS-01",
                                "CSA CCM v.4.0.1-AIS-02",
                                "CSA CCM v.4.0.1-AIS-04",
                                "CSA CCM v.4.0.1-CCC-01",
                                "CSA CCM v.4.0.1-GRC-03",
                                "CSA CCM v.4.0.1-IVS-04",
                                "CSA CCM v.4.0.1-UEM-06",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:10.a",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.1.2",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.2.1",
                                "ISO/IEC 27002:2013-14.2.2",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.1.2",
                                "ISO/IEC 27017:2015-14.1.1",
                                "ISO/IEC 27017:2015-14.1.2",
                                "ISO/IEC 27017:2015-14.2.1",
                                "ISO/IEC 27017:2015-14.2.5",
                                "ISO/IEC 27017:2015-5.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-12.1.2",
                                "NIST CSF",
                                "NIST CSF-PR.IP-1",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.4.2",
                                "NIST SP 800-172-3.4.1e",
                                "NIST SP 800-172-3.4.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-6.3"
                            ],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_274"
                    ],
                    "severity": "Medium",
                    "title": "Azure Virtual Machine should utilize managed disks",
                    "description": "This policy identifies Azure Virtual Machines which are not utilising Managed Disks. Using Azure Managed disk over traditional BLOB based VHD's has more advantage features like Managed disks are by default encrypted, reduces cost over storage accounts and more resilient as Microsoft will manage the disk storage and move around if underlying hardware goes faulty. It is recommended to move BLOB based VHD's to Managed Disks."
                },
                {
                    "masterTestId": "PR-AZR-CLD-VM-005",
                    "type": "rego",
                    "rule": "file(vm.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-VM-005",
                            "eval": "data.rule.vm_ip_forwarding_disabled",
                            "message": "data.rule.vm_ip_forwarding_disabled_err",
                            "remediationDescription": "1.Login to Azure Portal<br>2.Click on 'All services' on left Navigation<br>3.Click on 'Network interfaces' under 'Networking'<br>4.Click on reported resource<br>5.Click on 'IP configurations' under Settings<br>6.Select 'Disabled' for 'IP forwarding'<br>7.Click on 'Save'",
                            "remediationFunction": "PR_AZR_CLD_VM_005.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA CCM",
                                "CSA CCM v.4.0.1-DSP-07",
                                "CSA CCM v.4.0.1-DSP-10",
                                "CSA CCM v.4.0.1-DSP-17",
                                "CSA CCM v.4.0.1-IVS-03",
                                "CSA CCM v.4.0.1-UEM-11",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:01.c",
                                "HITRUST v.9.4.2-Control Reference:09.m",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.2.1",
                                "ISO/IEC 27002:2013-12.3.1",
                                "ISO/IEC 27002:2013-13.1.1",
                                "ISO/IEC 27002:2013-13.1.2",
                                "ISO/IEC 27002:2013-13.1.3",
                                "ISO/IEC 27002:2013-13.2.1",
                                "ISO/IEC 27002:2013-13.2.3",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.2.5",
                                "ISO/IEC 27002:2013-18.1.3",
                                "ISO/IEC 27002:2013-18.1.4",
                                "ISO/IEC 27002:2013-8.3.1",
                                "ISO/IEC 27002:2013-8.3.3",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-6.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2",
                                "ISO/IEC 27018:2019-12.3.1",
                                "NIST CSF",
                                "NIST CSF-PR.AC-5",
                                "NIST CSF-PR.DS-5",
                                "NIST CSF-PR.PT-4",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.13.5",
                                "NIST SP 800-172-3.4.1e",
                                "NIST SP 800-172-3.4.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-1.3",
                                "PCI DSS v3.2.1-7.1"
                            ],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_274"
                    ],
                    "severity": "Medium",
                    "title": "Azure Virtual Machine NIC should have IP forwarding disabled",
                    "description": "This policy identifies Azure Virtual machine NIC which have IP forwarding enabled. IP forwarding on a virtual machine's NIC allows the machine to receive and forward traffic addressed to other destinations. As a best practice, before you enable IP forwarding in a Virtual Machine NIC, review the configuration with your network security team to ensure that it does not allow an attacker to exploit the set up to route packets through the host and compromise your network."
                },
                {
                    "masterTestId": "PR-AZR-CLD-VMSS-001",
                    "type": "rego",
                    "rule": "file(vm_scale_sets.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-VMSS-001",
                            "eval": "data.rule.vmss_bootdiagonstics_enabled",
                            "message": "data.rule.vmss_bootdiagonstics_enabled_err",
                            "remediationDescription": "1. Log in to the Azure Portal<br>2. Select 'All services' from the left pane<br>3. Go to 'Compute' under 'Categories'<br>4. Select 'Virtual Machine scale sets'<br>5. Select the reported virtual machine scale sets<br>6. Click on 'Boot Diagnostics' under 'Support + troubleshooting'<br>7. Select 'On'<br>8. Click on 'Save'",
                            "remediationFunction": "PR_AZR_CLD_VMSS_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-LOG-05",
                                "CSA CCM v.4.0.1-LOG-06",
                                "CSA CCM v.4.0.1-LOG-08",
                                "CSA CCM v.4.0.1-LOG-13",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.ab",
                                "HITRUST v.9.4.2-Control Reference:09.ac",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.4.1",
                                "ISO/IEC 27002:2013-12.4.3",
                                "ISO/IEC 27002:2013-12.4.4",
                                "ISO/IEC 27002:2013-16.1.1",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.4.1",
                                "ISO/IEC 27017:2015-12.4.4",
                                "ISO/IEC 27017:2015-16.1.2",
                                "NIST CSF",
                                "NIST CSF-PR.PT-1",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.3.4",
                                "NIST SP 800-172-3.4.1e",
                                "NIST SP 800-172-3.4.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-10.2.3",
                                "PCI DSS v3.2.1-10.6"
                            ],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_507"
                    ],
                    "severity": "Low",
                    "title": "Azure Virtual Machine scale sets should have Boot Diagnostics enabled",
                    "description": "This policy identifies Azure Virtual Machines scale sets which has Boot Diagnostics setting Disabled. Boot Diagnostics when enabled for virtual machine, captures Screenshot and Console Output during virtual machine startup. This would help in troubleshooting virtual machine when it enters a non-bootable state."
                },
                {
                    "masterTestId": "PR-AZR-CLD-VMSS-002",
                    "type": "rego",
                    "rule": "file(vm_scale_sets.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-VMSS-002",
                            "eval": "data.rule.vmss_usage_managed_disks",
                            "message": "data.rule.vmss_usage_managed_disks_err",
                            "remediationDescription": "Currently migrating Virtual machine scale sets VHD disks to Azure Managed Disks is not available.<br>It is recommended that all new future scale sets be deployed with managed disks.<br><br>Follow steps given in the URL to create new Virtual machine Scale sets,<br><br>https://docs.microsoft.com/en-us/azure/virtual-machine-scale-sets/quick-create-portal",
                            "remediationFunction": "PR_AZR_CLD_VMSS_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23",
                                "APRA (CPS 234) Information Security-CPS234-27",
                                "APRA (CPS 234) Information Security-CPS234-34",
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-NS-1",
                                "Azure Security Benchmark (v3)-GS-3",
                                "CIS",
                                "CIS v1.2.0 (Azure)-7.1",
                                "CIS v1.3.0 (Azure)-7.1",
                                "CIS v1.3.1 (Azure)-7.1",
                                "CIS v1.4.0 (Azure)-7.1",
                                "CSA CCM",
                                "CSA CCM v.4.0.1-AIS-01",
                                "CSA CCM v.4.0.1-AIS-02",
                                "CSA CCM v.4.0.1-AIS-04",
                                "CSA CCM v.4.0.1-CCC-01",
                                "CSA CCM v.4.0.1-GRC-03",
                                "CSA CCM v.4.0.1-IVS-04",
                                "CSA CCM v.4.0.1-UEM-06",
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:10.a",
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.1.2",
                                "ISO/IEC 27002:2013-14.1.1",
                                "ISO/IEC 27002:2013-14.1.2",
                                "ISO/IEC 27002:2013-14.2.1",
                                "ISO/IEC 27002:2013-14.2.2",
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.1.2",
                                "ISO/IEC 27017:2015-14.1.1",
                                "ISO/IEC 27017:2015-14.1.2",
                                "ISO/IEC 27017:2015-14.2.1",
                                "ISO/IEC 27017:2015-14.2.5",
                                "ISO/IEC 27017:2015-5.1.1",
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-12.1.2",
                                "NIST CSF",
                                "NIST CSF-PR.IP-1",
                                "NIST SP",
                                "NIST SP 800-171 Revision 2-3.4.2",
                                "NIST SP 800-172-3.4.1e",
                                "NIST SP 800-172-3.4.2e",
                                "PCI DSS",
                                "PCI DSS v3.2.1-6.3"
                            ],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_507"
                    ],
                    "severity": "Medium",
                    "title": "Azure Virtual Machine scale sets should utilize managed disks",
                    "description": "This policy identifies Azure Virtual machine scale sets which are not utilising Managed Disks. Using Azure Managed disk over traditional BLOB storage based VHD's has more advantage features like Managed disks are by default encrypted, reduces cost over storage accounts and more resilient as Microsoft will manage the disk storage and move around if underlying hardware goes faulty. It is recommended to move BLOB based VHD's to Managed Disks."
                },
                {
                    "masterTestId": "PR-AZR-CLD-EGR-001",
                    "type": "rego",
                    "rule": "file(eventgrid.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-EGR-001",
                            "eval": "data.rule.event_grid_topic_has_public_network_access_disabled",
                            "message": "data.rule.event_grid_topic_has_public_network_access_disabled_err",
                            "remediationDescription": "01. Navigate to your event grid topic, and switch to the Networking tab.<br>02. Select Private endpoints only to allow only private endpoint connections to access this resource. Use the Private endpoint connections tab on this page to manage connections. For step-by-step instructions to create a private endpoint connection, visit https://learn.microsoft.com/en-us/azure/event-grid/configure-private-endpoints#use-azure-portal.<br>03. Select Save on the toolbar",
                            "remediationFunction": "PR_AZR_CLD_EGR_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "EventGrid"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_508"
                    ],
                    "severity": "Medium",
                    "title": "Azure Event Grid topics should disable public network access",
                    "description": "Disabling public network access improves security by ensuring that the resource isn't exposed on the public internet. You can limit exposure of your resources by creating private endpoints instead. Learn more at: https://aka.ms/privateendpoints."
                },
                {
                    "masterTestId": "PR-AZR-CLD-EGR-002",
                    "type": "rego",
                    "rule": "file(eventgrid.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-EGR-002",
                            "eval": "data.rule.event_grid_topic_has_local_auth_disabled",
                            "message": "data.rule.event_grid_topic_has_local_auth_disabled_err",
                            "remediationDescription": "01. Navigate to your event grid topic.<br>02. On the Overview page, in the Essentials section, select the current value for Local Authentication.<br>03. On the Local Authentication page, select Disabled.<br>04. Select OK to close the Local Authentication page.",
                            "remediationFunction": "PR_AZR_CLD_EGR_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "EventGrid"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_508"
                    ],
                    "severity": "Medium",
                    "title": "Azure Event Grid topics should disable local authentication",
                    "description": "Disable local authentication methods so that your Azure Event Grid topics exclusively require Azure Active Directory identities for authentication. Learn more at: https://aka.ms/aeg-disablelocalauth."
                },
                {
                    "masterTestId": "PR-AZR-CLD-EGR-003",
                    "type": "rego",
                    "rule": "file(eventgrid.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-EGR-003",
                            "eval": "data.rule.event_grid_domain_configured_with_private_endpoint",
                            "message": "data.rule.event_grid_domain_configured_with_private_endpoint_err",
                            "remediationDescription": "01. Navigate to your event grid domain, and switch to the Networking tab.<br>02. Select Private endpoints only to allow only private endpoint connections to access this resource. Use the Private endpoint connections tab on this page to manage connections. For step-by-step instructions to create a private endpoint connection, visit https://learn.microsoft.com/en-us/azure/event-grid/configure-private-endpoints#use-azure-portal.<br>03. Select Save on the toolbar.",
                            "remediationFunction": "PR_AZR_CLD_EGR_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Azure_Security_Benchmark",
                                "Azure_Security_Benchmark_v2.0_NS-2",
                                "Azure_Security_Benchmark_v2.0_NS-3",
                                "Azure_Security_Benchmark_v3.0_NS-2",
                                "CMMC",
                                "CMMC_2.0_L2_AC.L1-3.1.1",
                                "CMMC_2.0_L2_AC.L2-3.1.12",
                                "CMMC_2.0_L2_AC.L2-3.1.13",
                                "CMMC_2.0_L2_AC.L2-3.1.14",
                                "CMMC_2.0_L2_AC.L2-3.1.3",
                                "CMMC_2.0_L2_SC.L1-3.13.1",
                                "CMMC_2.0_L2_SC.L1-3.13.5"
                            ],
                            "service": [
                                "EventGrid"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_509"
                    ],
                    "severity": "Medium",
                    "title": "Azure Event Grid domains should have private endpoints configured",
                    "description": "Private endpoints lets you connect your virtual network to Azure services without a public IP address at the source or destination. By mapping private endpoints to your resources, they'll be protected against data leakage risks. Learn more at: https://aka.ms/privateendpoints."
                },
                {
                    "masterTestId": "PR-AZR-CLD-EGR-004",
                    "type": "rego",
                    "rule": "file(eventgrid.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-EGR-004",
                            "eval": "data.rule.event_grid_topic_configured_with_private_endpoint",
                            "message": "data.rule.event_grid_topic_configured_with_private_endpoint_err",
                            "remediationDescription": "01. Navigate to your topic.<br>02. Switch to the Networking tab of your topics page. In the Public access tab, select Private endpoints only. For step-by-step instructions to create a private endpoint connection, visit https://learn.microsoft.com/en-us/azure/event-grid/configure-private-endpoints#use-azure-portal.<br>03. Select Save on the toolbar.",
                            "remediationFunction": "PR_AZR_CLD_EGR_004.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Azure_Security_Benchmark",
                                "Azure_Security_Benchmark_v2.0_NS-2",
                                "Azure_Security_Benchmark_v2.0_NS-3",
                                "Azure_Security_Benchmark_v3.0_NS-2",
                                "CMMC",
                                "CMMC_2.0_L2_AC.L1-3.1.1",
                                "CMMC_2.0_L2_AC.L2-3.1.12",
                                "CMMC_2.0_L2_AC.L2-3.1.13",
                                "CMMC_2.0_L2_AC.L2-3.1.14",
                                "CMMC_2.0_L2_AC.L2-3.1.3",
                                "CMMC_2.0_L2_SC.L1-3.13.1",
                                "CMMC_2.0_L2_SC.L1-3.13.5"
                            ],
                            "service": [
                                "EventGrid"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_508"
                    ],
                    "severity": "Medium",
                    "title": "Azure Event Grid topics should have private endpoints configured",
                    "description": "Private endpoints lets you connect your virtual network to Azure services without a public IP address at the source or destination. By mapping private endpoints to your resources, they'll be protected against data leakage risks. Learn more at: https://aka.ms/privateendpoints."
                },
                {
                    "masterTestId": "PR-AZR-CLD-EGR-005",
                    "type": "rego",
                    "rule": "file(eventgrid.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-EGR-005",
                            "eval": "data.rule.event_grid_domain_has_public_network_access_disabled",
                            "message": "data.rule.event_grid_domain_has_public_network_access_disabled_err",
                            "remediationDescription": "01. Navigate to your event grid domain, and switch to the Networking tab.<br>02. Select Private endpoints only to allow only private endpoint connections to access this resource. Use the Private endpoint connections tab on this page to manage connections. For step-by-step instructions to create a private endpoint connection, visit https://learn.microsoft.com/en-us/azure/event-grid/configure-private-endpoints#use-azure-portal.<br>03. Select Save on the toolbar.",
                            "remediationFunction": "PR_AZR_CLD_EGR_005.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Azure_Security_Benchmark",
                                "Azure_Security_Benchmark_v2.0_NS-2",
                                "Azure_Security_Benchmark_v2.0_NS-3",
                                "Azure_Security_Benchmark_v3.0_NS-2",
                                "CMMC",
                                "CMMC_2.0_L2_AC.L1-3.1.1",
                                "CMMC_2.0_L2_AC.L2-3.1.12",
                                "CMMC_2.0_L2_AC.L2-3.1.13",
                                "CMMC_2.0_L2_AC.L2-3.1.14",
                                "CMMC_2.0_L2_AC.L2-3.1.3",
                                "CMMC_2.0_L2_SC.L1-3.13.1",
                                "CMMC_2.0_L2_SC.L1-3.13.5"
                            ],
                            "service": [
                                "EventGrid"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_509"
                    ],
                    "severity": "Medium",
                    "title": "Azure Event Grid domains should disable public network access",
                    "description": "Disable public network access for Azure Event Grid resource so that it isn't accessible over the public internet. This will help protect them against data leakage risks. You can limit exposure of your resources by creating private endpoints instead. Learn more at: https://aka.ms/privateendpoints."
                },
                {
                    "masterTestId": "PR-AZR-CLD-EGR-006",
                    "type": "rego",
                    "rule": "file(eventgrid.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-EGR-006",
                            "eval": "data.rule.event_grid_domain_has_local_auth_disabled",
                            "message": "data.rule.event_grid_domain_has_local_auth_disabled_err",
                            "remediationDescription": "01. Navigate to your event grid domain.<br>02. On the Overview page, in the Essentials section, select the current value for Local Authentication.<br>03. On the Local Authentication page, select Disabled.<br>04. Select OK to close the Local Authentication page.",
                            "remediationFunction": "PR_AZR_CLD_EGR_006.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "EventGrid"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_509"
                    ],
                    "severity": "Medium",
                    "title": "Azure Event Grid domains should disable local authentication",
                    "description": "Disable local authentication methods so that your Azure Event Grid domains exclusively require Azure Active Directory identities for authentication. Learn more at: https://aka.ms/aeg-disablelocalauth."
                },
                {
                    "masterTestId": "PR-AZR-CLD-EGR-009",
                    "type": "rego",
                    "rule": "file(eventgrid.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-EGR-009",
                            "eval": "data.rule.event_grid_partnernamespace_has_local_auth_disabled",
                            "message": "data.rule.event_grid_partnernamespace_has_local_auth_disabled_err",
                            "remediationDescription": "01. Navigate to your event grid partner namespace.<br>02. On the Overview page, in the Essentials section, select the current value for Local Authentication.<br>03. On the Local Authentication page, select Disabled.<br>04. Select OK to close the Local Authentication page.",
                            "remediationFunction": "PR_AZR_CLD_EGR_009.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "EventGrid"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_510"
                    ],
                    "severity": "Medium",
                    "title": "Azure Event Grid partner namespaces should disable local authentication",
                    "description": "Disabling local authentication methods improves security by ensuring that Azure Event Grid partner namespaces exclusively require Azure Active Directory identities for authentication. Learn more at: https://aka.ms/aeg-disablelocalauth."
                },
                {
                    "masterTestId": "PR-AZR-CLD-RSV-001",
                    "type": "rego",
                    "rule": "file(recoveryservices_vaults.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-RSV-001",
                            "eval": "data.rule.recoveryservices_vaults_usage_custom_managed_keys_for_encryption",
                            "message": "data.rule.recoveryservices_vaults_usage_custom_managed_keys_for_encryption_err",
                            "remediationDescription": "01. Go to your Recovery Services vault -> Properties.<br>02. Select Update under Encryption Settings.<br>03. In the Encryption Settings pane, select Use your own key and enter the Key URI with which you want to encrypt the data in this Recovery Services vault.<br>04. Select Save.<br>Please visit <a href='https://learn.microsoft.com/en-us/azure/backup/encryption-at-rest-with-cmk?tabs=portal#configure-a-vault-to-encrypt-using-customer-managed-keys' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_CLD_RSV_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CMMC",
                                "CMMC_2.0_L2_SC.L2-3.13.10",
                                "FedRAMP",
                                "FedRAMP_High_R4_SC-12",
                                "FedRAMP_Moderate_R4_SC-12",
                                "NIST_SP",
                                "NIST_SP_800-171_R2_3.13.10",
                                "NIST_SP_800-53_R4_SC-12",
                                "NIST_SP_800-53_R5_SC-12",
                                "RBI_ITF_NBFC",
                                "RBI_ITF_NBFC_v2017_6",
                                "RBI_ITF_NBFC_v2017_6.2",
                                "RBI_ITF_NBFC_v2017_6.3",
                                "RBI_ITF_NBFC_v2017_6.4"
                            ],
                            "service": [
                                "RecoveryServices"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_511"
                    ],
                    "severity": "Medium",
                    "title": "Azure Recovery Services vaults should use customer-managed keys for encryption",
                    "description": "Use customer-managed keys to manage the encryption at rest of your backup data. By default, customer data is encrypted with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more at https://aka.ms/AB-CmkEncryption."
                },
                {
                    "masterTestId": "PR-AZR-CLD-RSV-002",
                    "type": "rego",
                    "rule": "file(recoveryservices_vaults.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-RSV-002",
                            "eval": "data.rule.recoveryservices_vaults_configured_with_private_endpoint",
                            "message": "data.rule.recoveryservices_vaults_configured_with_private_endpoint_err",
                            "remediationDescription": "01. Navigate to your vault and go to Private endpoint connections on the left navigation bar. Select +Private endpoint on the top to start creating a new private endpoint for this vault.<br>02. Once in the Create Private Endpoint process, you'll be required to specify details for creating your private endpoint connection.<br>Please visit <a href='https://learn.microsoft.com/en-us/azure/backup/private-endpoints#create-private-endpoints-for-azure-backup' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_CLD_RSV_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "RecoveryServices"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_511"
                    ],
                    "severity": "Medium",
                    "title": "Azure Recovery Services vaults should use private link",
                    "description": "Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to Azure Recovery Services vaults, data leakage risks are reduced. Learn more about private links at: https://aka.ms/AB-PrivateEndpoints."
                },
                {
                    "masterTestId": "PR-AZR-CLD-EHB-001",
                    "type": "rego",
                    "rule": "file(eventhub.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-EHB-001",
                            "eval": "data.rule.event_hub_namespace_has_local_auth_disabled",
                            "message": "data.rule.event_hub_namespace_has_local_auth_disabled_err",
                            "remediationDescription": "01. Navigate to your Event Hubs namespace using the Azure portal.<br>02. In the namespace overview section, click on the Local Authentication.<br>03. Now select Disabled option and click Ok to save the changes",
                            "remediationFunction": "PR_AZR_CLD_EHB_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "EventHub"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_512"
                    ],
                    "severity": "Medium",
                    "title": "Azure Event Hub namespaces should have local authentication methods disabled",
                    "description": "Disabling local authentication methods improves security by ensuring that Azure Event Hub namespaces exclusively require Azure Active Directory identities for authentication. Learn more at: https://aka.ms/disablelocalauth-eh."
                },
                {
                    "masterTestId": "PR-AZR-CLD-EHB-002",
                    "type": "rego",
                    "rule": "file(eventhub.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-EHB-002",
                            "eval": "data.rule.event_hub_namespace_has_double_encryption_enabled",
                            "message": "data.rule.event_hub_namespace_has_double_encryption_enabled_err",
                            "remediationDescription": "01. Select the namespace on which you want to enable BYOK.<br>02. On the Settings page of your Event Hubs namespace, select Encryption.<br>03. Select Encrypt with Customer-managed key and check Enable infrastructure-level encryption checkbox.<br>04. Click Save to complete,",
                            "remediationFunction": "PR_AZR_CLD_EHB_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "EventHub"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_512"
                    ],
                    "severity": "Medium",
                    "title": "Event Hub namespaces should have double encryption enabled",
                    "description": "Enabling double encryption helps protect and safeguard your data to meet your organizational security and compliance commitments. When double encryption has been enabled, data in the storage account is encrypted twice, once at the service level and once at the infrastructure level, using two different encryption algorithms and two different keys."
                },
                {
                    "masterTestId": "PR-AZR-CLD-EHB-004",
                    "type": "rego",
                    "rule": "file(eventhub.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-EHB-004",
                            "eval": "data.rule.event_hub_namespace_configured_with_private_endpoint",
                            "message": "data.rule.event_hub_namespace_configured_with_private_endpoint_err",
                            "remediationDescription": "01. Navigate to your Event Hubs namespace using the Azure portal.<br>02. On the Networking page, for Public network access, select Disabled so that the namespace to be accessed only via private endpoints.<br>03. To create and integrate a private endpoint please visit <a href='https://learn.microsoft.com/en-us/azure/event-hubs/private-link-service#add-a-private-endpoint-using-azure-portal' target='_blank'>here</a> for more details.",
                            "remediationFunction": "PR_AZR_CLD_EHB_004.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "EventHub"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_512"
                    ],
                    "severity": "Medium",
                    "title": "Azure Event Hub namespaces should have private endpoints configured",
                    "description": "Private endpoints connect your virtual network to Azure services without a public IP address at the source or destination. By mapping private endpoints to Event Hub namespaces, you can reduce data leakage risks. Learn more at: https://docs.microsoft.com/azure/event-hubs/private-link-service."
                },
                {
                    "masterTestId": "PR-AZR-CLD-EHB-005",
                    "type": "rego",
                    "rule": "file(eventhub.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-EHB-005",
                            "eval": "data.rule.event_hub_namespace_usage_custom_managed_key_for_encryption",
                            "message": "data.rule.event_hub_namespace_usage_custom_managed_key_for_encryption_err",
                            "remediationDescription": "01. Select the namespace on which you want to enable BYOK.<br>02. On the Settings page of your Event Hubs namespace, select Encryption.<br>03. Check the Customer-managed key encryption at rest checkbox.<br>04. Select save to complete.",
                            "remediationFunction": "PR_AZR_CLD_EHB_005.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CMMC",
                                "CMMC_2.0_L2_SC.L2-3.13.10",
                                "FedRAMP",
                                "FedRAMP_High_R4_SC-12",
                                "FedRAMP_Moderate_R4_SC-12",
                                "NIST_SP",
                                "NIST_SP_800-171_R2_3.13.10",
                                "NIST_SP_800-171_R2_3.13.10",
                                "NIST_SP_800-53_R5_SC-12",
                                "RMiT",
                                "RMiT_v1.0_10.53"
                            ],
                            "service": [
                                "EventHub"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_512"
                    ],
                    "severity": "Medium",
                    "title": "Event Hub namespaces should use customer-managed key for encryption",
                    "description": "Azure Event Hubs supports the option of encrypting data at rest with either Microsoft-managed keys (default) or customer-managed keys. Choosing to encrypt data using customer-managed keys enables you to assign, rotate, disable, and revoke access to the keys that Event Hub will use to encrypt data in your namespace. Note that Event Hub only supports encryption with customer-managed keys for namespaces in dedicated clusters."
                },
                {
                    "masterTestId": "PR-AZR-CLD-EHB-006",
                    "type": "rego",
                    "rule": "file(eventhub.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-EHB-006",
                            "eval": "data.rule.event_hub_namespace_only_has_rootmanage_sharedaccesskey",
                            "message": "data.rule.event_hub_namespace_only_has_rootmanage_sharedaccesskey_err",
                            "remediationDescription": "Upon creation of the Eventhub namespace, a default AuthorizationRule Policy is created called 'RootManageSharedAccessKey' which includes the Access/Authorization keys you need. This default policy can be viewed & managed in the Portal by navigating to the EventhubNamespace -> 'Shared Access Policies' under Settings. Don't add any custom access policies/keys here.",
                            "remediationFunction": "PR_AZR_CLD_EHB_006.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practice"
                            ],
                            "service": [
                                "EventHub"
                            ]
                        }              
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_512",
                        "AZRSNP_513"
                    ],
                    "severity": "Medium",
                    "title": "All authorization rules except RootManageSharedAccessKey should be removed from Event Hub namespace",
                    "description": "Event Hub clients should not use a namespace level access policy that provides access to all queues and topics in a namespace. To align with the least privilege security model, you should create access policies at the entity level for queues and topics to provide access to only the specific entity"
                },
                {
                    "masterTestId": "PR-AZR-CLD-EHB-007",
                    "type": "rego",
                    "rule": "file(eventhub.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-EHB-007",
                            "eval": "data.rule.event_hub_instance_has_auth_rule_defined",
                            "message": "data.rule.event_hub_instance_has_auth_rule_defined_err",
                            "remediationDescription": "Upon creation of the Eventhub instance, no AuthorizationRule Policy get created by default. From Azure portal create a shared access policy by navigating to the EventhubInstance -> 'Shared Access Policies' under Settings. Make sure you have at least one access policy defined.",
                            "remediationFunction": "PR_AZR_CLD_EHB_007.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "RMiT",
                                "RMiT_v1.0_10.55"
                            ],
                            "service": [
                                "EventHub"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_514"
                    ],
                    "severity": "Medium",
                    "title": "Authorization rules on the Event Hub instance should be defined",
                    "description": "Audit existence of authorization rules on Event Hub entities to grant least-privileged access"
                },
                {
                    "masterTestId": "PR-AZR-CLD-AFA-001",
                    "type": "rego",
                    "rule": "file(functionapp.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AFA-001",
                            "eval": "data.rule.https_only",
                            "message": "data.rule.https_only_err",
                            "remediationDescription": "1. Sign on to Azure Portal<br>2. Click on the name of the function app you want to examine<br>3. In the navigation panel, under Settings, select 'TLS/SSL settings'<br>4. In the 'HTTPS Only' toggle select ON<br><br>References:<br><a href='https://docs.microsoft.com/en-us/azure/app-service/configure-ssl-bindings' target='_blank'>https://docs.microsoft.com/en-us/azure/app-service/configure-ssl-bindings</a>",
                            "remediationFunction": "PR_AZR_CLD_AFA_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15", 
                                "APRA (CPS 234) Information Security-CPS234-16", 
                                "APRA (CPS 234) Information Security-CPS234-17", 
                                "APRA (CPS 234) Information Security-CPS234-21", 
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-DP-4", 
                                "Azure Security Benchmark (v2)-NS-1", 
                                "Azure Security Benchmark (v3)-DP-3", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CIS",
                                "CIS v1.1 (Azure)-9.2", 
                                "CIS v1.2.0 (Azure)-9.2", 
                                "CIS v1.3.0 (Azure)-9.2", 
                                "CIS v1.3.1 (Azure)-9.2", 
                                "CIS v1.4.0 (Azure)-9.2", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03", 
                                "CSA CCM v.4.0.1-DSP-10", 
                                "CSA CCM v.4.0.1-IVS-03", 
                                "CSA CCM v.4.0.1-UEM-11", 
                                "CyberSecurity Law of the People's Republic of China-Article 21", 
                                "CyberSecurity Law of the People's Republic of China-Article 40", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.185", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.s", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1", 
                                "ISO/IEC 27002:2013-12.2.1", 
                                "ISO/IEC 27002:2013-12.3.1", 
                                "ISO/IEC 27002:2013-13.1.1", 
                                "ISO/IEC 27002:2013-13.1.2", 
                                "ISO/IEC 27002:2013-13.1.3", 
                                "ISO/IEC 27002:2013-13.2.1", 
                                "ISO/IEC 27002:2013-13.2.3", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.1.3", 
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-8.3.1", 
                                "ISO/IEC 27002:2013-8.3.3", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2", 
                                "ISO/IEC 27017:2015-6.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2", 
                                "ISO/IEC 27018:2019-12.3.1", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Transmission Confidentiality and Integrity | Cryptographic Protection", 
                                "NIST 800-53 Rev4-SC-8 (1)",
                                "NIST CSF", 
                                "NIST CSF-PR.DS-2", 
                                "NIST CSF-PR.DS-5",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.13.8", 
                                "NIST SP 800-172-3.4.1e", 
                                "NIST SP 800-172-3.4.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-2.3", 
                                "PCI DSS v3.2.1-4.1", 
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Web"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Azure Function App enforce https connection",
                    "description": "This policy identifies Azure Function App which doesn't redirect HTTP to HTTPS. Azure Function App can be accessed by anyone using non-secure HTTP links by default. Non-secure HTTP requests can be restricted and all HTTP requests redirected to the secure HTTPS port. It is recommended to enforce HTTPS-only traffic."
                },
                {
                    "masterTestId": "PR-AZR-CLD-AFA-002",
                    "type": "rego",
                    "rule": "file(functionapp.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AFA-002",
                            "eval": "data.rule.min_tls_version",
                            "message": "data.rule.min_tls_version_err",
                            "remediationDescription": "1. Go to your Function App.<br>2. Select 'TLS/SSL settings' under 'Settings' on the navigation menu.<br>3. Under 'Bindings' set 'Minimum TLS Version' to '1.2'.<br><br><a href=' https://docs.microsoft.com/en-us/cli/azure/webapp/config?view=azure-cli-latest' target='_blank'> https://docs.microsoft.com/en-us/cli/azure/webapp/config?view=azure-cli-latest</a>",
                            "remediationFunction": "PR_AZR_CLD_AFA_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15", 
                                "APRA (CPS 234) Information Security-CPS234-16", 
                                "APRA (CPS 234) Information Security-CPS234-17", 
                                "APRA (CPS 234) Information Security-CPS234-21", 
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-DP-4", 
                                "Azure Security Benchmark (v2)-NS-1", 
                                "Azure Security Benchmark (v3)-DP-3", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CIS",
                                "CIS v1.1 (Azure)-9.3", 
                                "CIS v1.2.0 (Azure)-9.3", 
                                "CIS v1.3.0 (Azure)-9.3", 
                                "CIS v1.3.1 (Azure)-9.3", 
                                "CIS v1.4.0 (Azure)-9.3", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03", 
                                "CSA CCM v.4.0.1-DSP-10", 
                                "CSA CCM v.4.0.1-IVS-03", 
                                "CSA CCM v.4.0.1-UEM-11", 
                                "CyberSecurity Law of the People's Republic of China-Article 21", 
                                "CyberSecurity Law of the People's Republic of China-Article 40", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.185", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.s", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1", 
                                "ISO/IEC 27002:2013-12.2.1", 
                                "ISO/IEC 27002:2013-12.3.1", 
                                "ISO/IEC 27002:2013-13.1.1", 
                                "ISO/IEC 27002:2013-13.1.2", 
                                "ISO/IEC 27002:2013-13.1.3", 
                                "ISO/IEC 27002:2013-13.2.1", 
                                "ISO/IEC 27002:2013-13.2.3", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.1.3", 
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-8.3.1", 
                                "ISO/IEC 27002:2013-8.3.3", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2", 
                                "ISO/IEC 27017:2015-6.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2", 
                                "ISO/IEC 27018:2019-12.3.1", 
                                "MITRE ATT&CK",
                                "MITRE ATT&CK v10.0-T1190 - Exploit Public-Facing Application", 
                                "MITRE ATT&CK v6.3-T1190", 
                                "MITRE ATT&CK v8.2-T1190", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Transmission Confidentiality and Integrity | Cryptographic Protection", 
                                "NIST 800-53 Rev4-SC-8 (1)",
                                "NIST CSF", 
                                "NIST CSF-PR.DS-2", 
                                "NIST CSF-PR.DS-5",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.13.8", 
                                "NIST SP 800-172-3.4.1e", 
                                "NIST SP 800-172-3.4.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-2.3", 
                                "PCI DSS v3.2.1-4.1", 
                                "PIPEDA",
                                "PIPEDA-4.7.3"
                            ],
                            "service": [
                                "Web"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "High",
                    "title": "Azure Function App should use the latest version of TLS encryption",
                    "description": "This policy identifies Azure Function App which are not set with latest version of TLS encryption. Azure currently allows the Function App to set TLS versions 1.0, 1.1 and 1.2. It is highly recommended to use the latest TLS 1.2 version for Function App secure connections."
                },
                {
                    "masterTestId": "PR-AZR-CLD-AFA-003",
                    "type": "rego",
                    "rule": "file(functionapp.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AFA-003",
                            "eval": "data.rule.client_cert_enabled",
                            "message": "data.rule.client_cert_enabled_err",
                            "remediationDescription": "1. Go to your Function App.<br>2. Under 'Settings, select 'Configuration' on the navigation menu.<br>3. Select 'General Settings'.<br>4. Go to 'Client Certificate mode' under 'Incoming Client Certificates' and select 'Require' Button.<br>5. Click Save.<br><br>Note: By default, Client Certificate mode is set to Ignore.<br><br>References:<a href='https://docs.microsoft.com/en-us/azure/app-service/app-service-web-configure-tls-mutual-auth' target='_blank'>https://docs.microsoft.com/en-us/azure/app-service/app-service-web-configure-tls-mutual-auth</a>",
                            "remediationFunction": "PR_AZR_CLD_AFA_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15", 
                                "APRA (CPS 234) Information Security-CPS234-16", 
                                "APRA (CPS 234) Information Security-CPS234-17", 
                                "APRA (CPS 234) Information Security-CPS234-21", 
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-DP-4", 
                                "Azure Security Benchmark (v3)-AM-4", 
                                "Azure Security Benchmark (v3)-IM-7", 
                                "Azure Security Benchmark (v3)-PA-7", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CIS",
                                "CIS v1.1 (Azure)-9.4", 
                                "CIS v1.2.0 (Azure)-9.4", 
                                "CIS v1.3.0 (Azure)-9.4", 
                                "CIS v1.3.1 (Azure)-9.4", 
                                "CIS v1.4.0 (Azure)-9.4", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-AIS-01", 
                                "CSA CCM v.4.0.1-AIS-02", 
                                "CSA CCM v.4.0.1-AIS-04", 
                                "CSA CCM v.4.0.1-CCC-01", 
                                "CSA CCM v.4.0.1-GRC-03", 
                                "CSA CCM v.4.0.1-IVS-04", 
                                "CSA CCM v.4.0.1-UEM-06", 
                                "CyberSecurity Law of the People's Republic of China-Article 21", 
                                "CyberSecurity Law of the People's Republic of China-Article 31", 
                                "CyberSecurity Law of the People's Republic of China-Article 40", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AC.2.013", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:10.a", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-12.1.2", 
                                "ISO/IEC 27002:2013-14.1.1", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.2.1", 
                                "ISO/IEC 27002:2013-14.2.2", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-12.1.2", 
                                "ISO/IEC 27017:2015-14.1.1", 
                                "ISO/IEC 27017:2015-14.1.2", 
                                "ISO/IEC 27017:2015-14.2.1", 
                                "ISO/IEC 27017:2015-14.2.5", 
                                "ISO/IEC 27017:2015-5.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-12.1.2", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Signed Components", 
                                "NIST 800-53 Rev4-CM-5 (3)",
                                "NIST CSF", 
                                "NIST CSF-PR.IP-1",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.4.2", 
                                "NIST SP 800-172-3.5.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-6.3"
                            ],
                            "service": [
                                "Web"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Azure Function App should have incoming client certificates enabled",
                    "description": "This policy identifies Azure Function App which are not set with client certificate. Client certificates allow for the app to request a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app."
                },
                {
                    "masterTestId": "PR-AZR-CLD-AFA-004",
                    "type": "rego",
                    "rule": "file(functionapp.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AFA-004",
                            "eval": "data.rule.http_20_enabled",
                            "message": "data.rule.http_20_enabled_err",
                            "remediationDescription": "1. Sign on to Azure and navigate to Function App<br>2. Click on the name of the Function App you want to examine<br>3. In the navigation panel,under Settings, select Configuration to access the configuration settings defined for the selected application.<br>4. On the Configuration panel, select 'General settings' tab to access the application general settings<br>5. In the Platform settings section, select '2.0' from the HTTP version dropdown list to enable HTTP/2 – the latest version of HTTP protocol,for the selected web application<br>6. Click Save to apply the change<br><br>References:<br><a href='https://docs.microsoft.com/en-us/azure/app-service/configure-ssl-bindings#enforce-tls-versions' target='_blank'>https://docs.microsoft.com/en-us/azure/app-service/configure-ssl-bindings#enforce-tls-versions</a>",
                            "remediationFunction": "PR_AZR_CLD_AFA_004.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15", 
                                "APRA (CPS 234) Information Security-CPS234-16", 
                                "APRA (CPS 234) Information Security-CPS234-17", 
                                "APRA (CPS 234) Information Security-CPS234-21", 
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-PV-3", 
                                "Azure Security Benchmark (v2)-PV-7", 
                                "Azure Security Benchmark (v3)-AM-2", 
                                "Azure Security Benchmark (v3)-AM-5", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CIS",
                                "CIS v1.1 (Azure)-9.10", 
                                "CIS v1.2.0 (Azure)-9.10", 
                                "CIS v1.3.0 (Azure)-9.9", 
                                "CIS v1.3.1 (Azure)-9.9", 
                                "CIS v1.4.0 (Azure)-9.9", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03", 
                                "CSA CCM v.4.0.1-DSP-10", 
                                "CSA CCM v.4.0.1-IVS-03", 
                                "CSA CCM v.4.0.1-UEM-11", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.185", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.s", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1", 
                                "ISO/IEC 27002:2013-12.2.1", 
                                "ISO/IEC 27002:2013-12.3.1", 
                                "ISO/IEC 27002:2013-13.1.1", 
                                "ISO/IEC 27002:2013-13.1.2", 
                                "ISO/IEC 27002:2013-13.1.3", 
                                "ISO/IEC 27002:2013-13.2.1", 
                                "ISO/IEC 27002:2013-13.2.3", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.1.3", 
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-8.3.1", 
                                "ISO/IEC 27002:2013-8.3.3", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2", 
                                "ISO/IEC 27017:2015-6.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2", 
                                "ISO/IEC 27018:2019-12.3.1", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Transmission Confidentiality and Integrity | Cryptographic Protection", 
                                "NIST 800-53 Rev4-SC-8 (1)",
                                "NIST CSF", 
                                "NIST CSF-PR.DS-2", 
                                "NIST CSF-PR.DS-5",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.13.8", 
                                "NIST SP 800-172-3.4.1e", 
                                "NIST SP 800-172-3.4.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-2.3", 
                                "PCI DSS v3.2.1-4.1"
                            ],
                            "service": [
                                "Web"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Azure Function App should use the latest version of HTTP",
                    "description": "This policy identifies Azure Function App which doesn't use HTTP 2.0. HTTP 2.0 has additional performance improvements on the head-of-line blocking problem of old HTTP version, header compression, and prioritisation of requests. HTTP 2.0 no longer supports HTTP 1.1's chunked transfer encoding mechanism, as it provides its own, more efficient, mechanisms for data streaming."
                },
                {
                    "masterTestId": "PR-AZR-CLD-AFA-005",
                    "type": "rego",
                    "rule": "file(functionapp.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AFA-005",
                            "eval": "data.rule.azure_function_app_has_auth_settings_enabled",
                            "message": "data.rule.azure_function_app_has_auth_settings_enabled_err",
                            "remediationDescription": "1. Log in to the Azure portal.<br>2. Navigate to Function App.<br>3. Click on the reported Function App.<br>4. Under Setting section, Click on 'Authentication / Authorization'.<br>5. Set 'App Service Authentication' to 'On'.<br>6. Choose other parameters as per your requirement.<br>7. Click on 'Save'",
                            "remediationFunction": "PR_AZR_CLD_AFA_005.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-15", 
                                "APRA (CPS 234) Information Security-CPS234-16", 
                                "APRA (CPS 234) Information Security-CPS234-17", 
                                "APRA (CPS 234) Information Security-CPS234-21", 
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-PV-3", 
                                "Azure Security Benchmark (v2)-PV-7", 
                                "Azure Security Benchmark (v3)-AM-2", 
                                "Azure Security Benchmark (v3)-AM-5", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CIS",
                                "CIS v1.1 (Azure)-9.10", 
                                "CIS v1.2.0 (Azure)-9.10", 
                                "CIS v1.3.0 (Azure)-9.9", 
                                "CIS v1.3.1 (Azure)-9.9", 
                                "CIS v1.4.0 (Azure)-9.9", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-CEK-03", 
                                "CSA CCM v.4.0.1-DSP-10", 
                                "CSA CCM v.4.0.1-IVS-03", 
                                "CSA CCM v.4.0.1-UEM-11", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-SC.3.185", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:09.s", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-10.1.1", 
                                "ISO/IEC 27002:2013-12.2.1", 
                                "ISO/IEC 27002:2013-12.3.1", 
                                "ISO/IEC 27002:2013-13.1.1", 
                                "ISO/IEC 27002:2013-13.1.2", 
                                "ISO/IEC 27002:2013-13.1.3", 
                                "ISO/IEC 27002:2013-13.2.1", 
                                "ISO/IEC 27002:2013-13.2.3", 
                                "ISO/IEC 27002:2013-14.1.2", 
                                "ISO/IEC 27002:2013-14.1.3", 
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-8.3.1", 
                                "ISO/IEC 27002:2013-8.3.3", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-10.1.1", 
                                "ISO/IEC 27017:2015-10.1.2", 
                                "ISO/IEC 27017:2015-6.1.1", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-10.1.2", 
                                "ISO/IEC 27018:2019-12.3.1", 
                                "NIST 800",
                                "NIST 800-53 Rev 5-Transmission Confidentiality and Integrity | Cryptographic Protection", 
                                "NIST 800-53 Rev4-SC-8 (1)",
                                "NIST CSF", 
                                "NIST CSF-PR.DS-2", 
                                "NIST CSF-PR.DS-5",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.13.8", 
                                "NIST SP 800-172-3.4.1e", 
                                "NIST SP 800-172-3.4.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-2.3", 
                                "PCI DSS v3.2.1-4.1"
                            ],
                            "service": [
                                "Web"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Azure Function App authentication should be enabled",
                    "description": "This policy identifies Azure Function App which has set authentication to off. Azure Function App Authentication is a feature that can prevent anonymous HTTP requests from reaching the API app, or authenticate those that have tokens before they reach the API app. If an anonymous request is received from a browser, Function App will redirect to a logon page. To handle the logon process, a choice from a set of identity providers can be made, or a custom authentication mechanism can be implemented."
                },
                {
                    "masterTestId": "PR-AZR-CLD-AFA-006",
                    "type": "rego",
                    "rule": "file(functionapp.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-CLD-AFA-006",
                            "eval": "data.rule.web_service_managed_identity_provider_enabled",
                            "message": "data.rule.web_service_managed_identity_provider_enabled_err",
                            "remediationDescription": "1. Log in to the Azure portal.<br>2. Navigate to Function App.<br>3. Click on the reported Function App.<br>4. Under Setting section, Click on 'Identity'.<br>5. Ensure that 'Status' is set to 'On'.<br>6. Click on 'Save'",
                            "remediationFunction": "PR_AZR_CLD_AFA_006.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "APRA",
                                "APRA (CPS 234) Information Security-CPS234-23", 
                                "APRA (CPS 234) Information Security-CPS234-27", 
                                "APRA (CPS 234) Information Security-CPS234-34", 
                                "Azure Security Benchmark",
                                "Azure Security Benchmark (v2)-IM-1", 
                                "Azure Security Benchmark (v3)-GS-6", 
                                "Brazilian Data Protection Law (LGPD)-Article 49", 
                                "CCPA",
                                "CCPA 2018-1798.150(a)(1)", 
                                "CIS",
                                "CIS v1.1 (Azure)-9.5", 
                                "CIS v1.2.0 (Azure)-9.5", 
                                "CIS v1.3.0 (Azure)-9.5", 
                                "CIS v1.3.1 (Azure)-9.5", 
                                "CIS v1.4.0 (Azure)-9.5", 
                                "CSA CCM",
                                "CSA CCM v.4.0.1-DSP-17", 
                                "CSA CCM v.4.0.1-HRS-04", 
                                "CSA CCM v.4.0.1-IAM-01", 
                                "CSA CCM v.4.0.1-IAM-04", 
                                "CSA CCM v.4.0.1-IAM-05", 
                                "CSA CCM v.4.0.1-IAM-09", 
                                "CSA CCM v.4.0.1-IAM-14", 
                                "CSA CCM v.4.0.1-IAM-16", 
                                "CSA CCM v.4.0.1-UEM-13", 
                                "CyberSecurity Law of the People's Republic of China-Article 21", 
                                "CMMC",
                                "Cybersecurity Maturity Model Certification (CMMC) v.1.02-AM.4.226", 
                                "HITRUST",
                                "HITRUST v.9.4.2-Control Reference:10.a", 
                                "ISO/IEC 27002:2013",
                                "ISO/IEC 27002:2013-18.1.3", 
                                "ISO/IEC 27002:2013-18.1.4", 
                                "ISO/IEC 27002:2013-5.1.2", 
                                "ISO/IEC 27002:2013-6.1.2", 
                                "ISO/IEC 27002:2013-6.2.1", 
                                "ISO/IEC 27002:2013-6.2.2", 
                                "ISO/IEC 27002:2013-9.1.1", 
                                "ISO/IEC 27002:2013-9.1.2", 
                                "ISO/IEC 27002:2013-9.2.3", 
                                "ISO/IEC 27002:2013-9.2.4", 
                                "ISO/IEC 27002:2013-9.2.5", 
                                "ISO/IEC 27002:2013-9.4.2", 
                                "ISO/IEC 27017:2015",
                                "ISO/IEC 27017:2015-9.1.2", 
                                "ISO/IEC 27017:2015-9.2.3", 
                                "ISO/IEC 27017:2015-9.2.4", 
                                "ISO/IEC 27017:2015-9.2.5", 
                                "ISO/IEC 27017:2015-9.4.2", 
                                "ISO/IEC 27018:2019",
                                "ISO/IEC 27018:2019-9.2.3", 
                                "ISO/IEC 27018:2019-9.2.5", 
                                "ISO/IEC 27018:2019-9.4.2", 
                                "NIST CSF",
                                "NIST CSF-PR.AC-3", 
                                "NIST CSF-PR.AC-4", 
                                "NIST CSF-PR.PT-3",
                                "NIST SP", 
                                "NIST SP 800-171 Revision 2-3.1.1", 
                                "NIST SP 800-172-3.4.1e", 
                                "NIST SP 800-172-3.4.2e", 
                                "PCI DSS",
                                "PCI DSS v3.2.1-6.3", 
                                "PIPEDA",
                                "PIPEDA-4.7.3"

                            ],
                            "service": [
                                "Web"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Azure Function App Managed Identity provider should be enabled",
                    "description": "This policy identifies Azure Function App which doesn't have a Managed Service Identity. Managed service identity in Function App makes the app more secure by eliminating secrets from the app, such as credentials in the connection strings. When registering with Azure Active Directory in the app service, the app will connect to other Azure services securely without the need of username and passwords."
                }
            ]
        }
    ]
}