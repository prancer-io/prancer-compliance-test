{
    "testSet": [
        {
            "masterTestName": "AZURE_Cloud_TEST",
            "version": "0.1",
            "cases": [
                {
                    "masterTestId": "AZURE_TEST_KV_01",
                    "type": "rego",
                    "rule": "file(Keyvault.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-KV-001",
                            "eval": "data.rule.KeyVault",
                            "message": "data.rule.KeyVault_err",
                            "remediationDescription": "1. Go to 'Key vaults' and choose your Key Vault<br>2. Select 'Keys/Secrets/Certificates' under 'Settings' in the navigation menu<br>3. Select 'Generate/Import' and complete the wizard.<br>Please visit <a href='https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_KV_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practices",
                                "HIPAA",
                                "NIST CSF"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_228"
                    ],
                    "severity": "Low",
                    "title": "Ensure that keyvault is in use",
                    "description": "Use the Azure Key Vault to store secrets within the Microsoft Azure environment. Secrets in Azure Key Vault are octet sequences with a maximum size of 25k bytes each."
                },
                {
                    "masterTestId": "AZURE_TEST_KV_02",
                    "type": "rego",
                    "rule": "file(Keyvault.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-KV-002",
                            "eval": "data.rule.enableSoftDelete",
                            "message": "data.rule.enableSoftDelete_err",
                            "remediationDescription": "Via Azure Portal<br>Azure Portal does not have provision to update the respective configurations<br><br>Via Azure CLI<br>Existing key vault:<br><br>For an existing key vault named ContosoVault, enable soft-delete as follows:<br><br>az resource update --id $(az keyvault show --name ContosoVault -o tsv , awk '{print $1}') --set properties.enableSoftDelete=true.<br>Please visit <a href='https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_KV_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practices"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_228"
                    ],
                    "severity": "High",
                    "title": "Ensure the key vault is recoverable - enable 'Soft Delete' setting for a Key Vault",
                    "description": "The key vault contains object keys, secrets and certificates. Accidental unavailability of a key vault can cause immediate data loss or loss of security functions (authentication, validation, verification, non-repudiation, etc.) supported by the key vault objects. It is recommended the key vault be made recoverable by enabling the 'Do Not Purge' and 'Soft Delete' functions. This is in order to prevent loss of encrypted data including storage accounts, SQL databases, and/or dependent services provided by key vault objects (Keys, Secrets, Certificates) etc., as may happen in the case of accidental deletion by a user or from disruptive activity by a malicious user."
                },
                {
                    "masterTestId": "AZURE_TEST_KV_03",
                    "type": "rego",
                    "rule": "file(Keyvault.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-KV-003",
                            "eval": "data.rule.enablePurgeProtection",
                            "message": "data.rule.enablePurgeProtection_err",
                            "remediationDescription": "Via Azure Portal<br>Azure Portal does not have provision to update the respective configurations<br><br>Via Azure CLI<br>Existing key vault:<br><br>For an existing key vault named ContosoVault, enable soft-delete as follows:<br><br>az resource update --id $(az keyvault show --name ContosoVault -o tsv , awk '{print $1}') --set properties.enableSoftDelete=true.<br>Please visit <a href='https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_KV_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practices"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_228"
                    ],
                    "severity": "High",
                    "title": "Key vault should have purge protection enabled",
                    "description": "The key vault contains object keys, secrets and certificates. Accidental unavailability of a key vault can cause immediate data loss or loss of security functions (authentication, validation, verification, non-repudiation"
                },
                {
                    "masterTestId": "AZURE_TEST_KV_04",
                    "type": "rego",
                    "rule": "file(KeyvaultKey.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-KV-004",
                            "eval": "data.rule.kv_expire",
                            "message": "data.rule.kv_expire_err",
                            "remediationDescription": "1. Go to 'Key vaults' and choose your Key Vault<br>2. Select 'Keys' under 'Settings' in the navigation menu<br>3. Select the relevant key and reselect its current version<br>3. Check 'Set expiration date'<br>4. Save.<br>Please visit <a href='https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_KV_004.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_229"
                    ],
                    "severity": "High",
                    "title": "Azure Key Vault secrets should have an expiration date",
                    "description": "This policy identifies Azure Key Vault secrets that do not have an expiration date. As a best practice, set an expiration date for each secret and rotate the secret regularly."
                },
                {
                    "masterTestId": "AZURE_TEST_KV_05",
                    "type": "rego",
                    "rule": "file(KeyvaultSecrets.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-KV-005",
                            "eval": "data.rule.kv_expire",
                            "message": "data.rule.kv_expire_err",
                            "remediationDescription": "1. Go to Key vaults<br>2. For each Key vault, click on Secrets.<br>3. Ensure that each secret in the vault has EXPIRATION DATE set as appropriate.<br>Please visit <a href='https://docs.microsoft.com/en-us/rest/api/keyvault/vaults/get' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_KV_005.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_227"
                    ],
                    "severity": "High",
                    "title": "Azure Key Vault secrets should have an expiration date",
                    "description": "This policy identifies Azure Key Vault secrets that do not have an expiration date. As a best practice, set an expiration date for each secret and rotate the secret regularly."
                },
                {
                    "masterTestId": "AZURE_TEST_STR_03",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "evals": [
                        {
                            "id": "PR-AZR-STR-003",
                            "eval": "data.rule.storage_secure",
                            "message": "data.rule.storage_secure_err",
                            "remediationDescription": "1. Go to 'Storage accounts' and choose your storage account<br>2. Select 'Configuration' under 'Settings' in the navigation menu<br>3. Set 'Secure transfer required' to 'Enabled'<br>4. Save.<br>Please visit <a href='https://docs.microsoft.com/en-us/rest/api/storagerp/storage-accounts/get-properties' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_STR_003.py"
                        }
                    ],
                    "severity": "High",
                    "title": "Storage Accounts https based secure transfer should be enabled",
                    "description": "The secure transfer option enhances the security of your storage account by only allowing requests to the storage account by a secure connection. For example, when calling REST APIs to access your storage accounts, you must connect using HTTPs. Any requests using HTTP will be rejected when 'secure transfer required' is enabled. When you are using the Azure files service, connection without encryption will fail, including scenarios using SMB 2.1, SMB 3.0 without encryption, and some flavors of the Linux SMB client. Because Azure storage doesnâ€™t support HTTPs for custom domain names, this option is not applied when using a custom domain name.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_STR_04",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "CIS",
                                "CSA CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "evals": [
                        {
                            "id": "PR-AZR-STR-004",
                            "eval": "data.rule.storage_acl",
                            "message": "data.rule.storage_acl_err",
                            "remediationDescription": "1. Go to Storage Accounts<br>2. For each storage account, Click on the settings menu called Firewalls and virtual networks.<br>3. Ensure that you have selected to allow access from Selected networks.<br>4. Add rules to allow traffic from specific network.<br>5. Click Save to apply your changes.<br>Azure Command Line Interface 2.0 Use the below command to update default-action to Deny.<br>Please visit <a href='https://docs.microsoft.com/en-us/rest/api/storagerp/storage-accounts/get-properties' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_STR_004.py"
                        }
                    ],
                    "severity": "High",
                    "title": "Storage Accounts should have firewall rules enabled",
                    "description": "Turning on firewall rules for your storage account blocks incoming requests for data by default, unless the requests come from a service that is operating within an Azure Virtual Network (VNet). Requests that are blocked include those from other Azure services, from the Azure portal, from logging and metrics services, and so on.<br><br>You can grant access to Azure services that operate from within a VNet by allowing the subnet of the service instance. Enable a limited number of scenarios through the Exceptions mechanism described in the following section. To access the Azure portal, you would need to be on a machine within the trusted boundary (either IP or VNet) that you set up.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_STR_06",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "PCI-DSS",
                                "GDPR",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "evals": [
                        {
                            "id": "PR-AZR-STR-006",
                            "eval": "data.rule.blobService",
                            "message": "data.rule.blobService_err",
                            "remediationDescription": "Currently, Storage account supports customer-managed keys encryption for blobs by default upon account creation, this cannot be changed after.<br>Note: When customer-managed keys are configured, your data in Blob storage and Azure Files is automatically protected using the customer-managed keys.<br>Please visit <a href='https://docs.microsoft.com/en-us/azure/storage/common/storage-service-encryption' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_STR_006.py"
                        }
                    ],
                    "severity": "High",
                    "title": "Ensure that 'Storage service encryption' is enabled for the Blob Service",
                    "description": "Enable data encryption at rest for blobs. Storage service encryption protects your data at rest. Azure Storage encrypts data when it's written, and automatically decrypts it when it is accessed.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_STR_07",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "PCI-DSS",
                                "GDPR",
                                "ISO 27001",
                                "HIPAA",
                                "Best Practices"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "evals": [
                        {
                            "id": "PR-AZR-STR-007",
                            "eval": "data.rule.fileService",
                            "message": "data.rule.fileService_err",
                            "remediationDescription": "Currently, Storage account supports customer-managed keys encryption for files by default upon account creation, this cannot be changed after.<br>Note: When customer-managed keys are configured, your data in Blob storage and Azure Files is automatically protected using the customer-managed keys.<br>Please visit <a href='https://docs.microsoft.com/en-us/azure/storage/common/storage-service-encryption' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_STR_007.py"
                        }
                    ],
                    "severity": "High",
                    "title": "Ensure that 'Storage service encryption' is enabled for the File Service",
                    "description": "Azure Storage encryption protects your data and to help you to meet your organizational security and compliance commitments. Data in Azure Storage is encrypted and decrypted transparently using 256-bit AES encryption, one of the strongest block ciphers available, and is FIPS 140-2 compliant. Azure Storage encryption is similar to BitLocker encryption on Windows.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_STR_08",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "Best Practices"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "evals": [
                        {
                            "id": "PR-AZR-STR-008",
                            "eval": "data.rule.keySource",
                            "message": "data.rule.keySource_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_STR_008.py"
                        }
                    ],
                    "severity": "High",
                    "title": "Ensure critical data storage in Storage Account is encrypted with Customer Managed Key",
                    "description": "By default, data in the storage account is encrypted using Microsoft Managed Keys at rest. All Azure Storage resources are encrypted, including blobs, disks, files, queues, and tables. All object metadata is also encrypted. However, if you want to control and manage this encryption key yourself, you can specify a customer-managed key, that key is used to protect and control access to the key that encrypts your data. You can also choose to automatically update the key version used for Azure Storage encryption whenever a new version is available in the associated Key Vault.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_STR_09",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "GDPR"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "evals": [
                        {
                            "id": "PR-AZR-STR-009",
                            "eval": "data.rule.region",
                            "message": "data.rule.region_err",
                            "remediationDescription": "Please refer to Azure documentations about Storage Accounts:<br><a href='https://docs.microsoft.com/en-us/azure/storage/common/storage-create-storage-account' target='_blank'>https://docs.microsoft.com/en-us/azure/storage/common/storage-create-storage-account</a>.<br>and<br>Azure documentations about Regions:<br><a href='https://azure.microsoft.com/en-us/global-infrastructure/regions/#services' target='_blank'>https://azure.microsoft.com/en-us/global-infrastructure/regions/#services</a>",
                            "remediationFunction": "PR_AZR_STR_009.py"
                        }
                    ],
                    "severity": "High",
                    "title": "Storage Accounts location configuration should be inside of Europe",
                    "description": "Identify Storage Accounts outside of the following regions: northeurope, westeurope",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_STR_10",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "evals": [
                        {
                            "id": "PR-AZR-STR-010",
                            "eval": "data.rule.blobServicePublicAccessDisabled",
                            "message": "data.rule.blobServicePublicAccessDisabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_STR_010.py"
                        }
                    ],
                    "severity": "High",
                    "title": "Ensure that Storage Account should not allow public access to all blobs or containers",
                    "description": "Identify Storage Accounts outside of the following regions: northeurope, westeurope",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_STR_11",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "evals": [
                        {
                            "id": "PR-AZR-STR-011",
                            "eval": "data.rule.storage_acount_by_pass",
                            "message": "data.rule.storage_acount_by_pass_err",
                            "remediationDescription": "1. Go to Storage Accounts<br>2. For each storage account, Click on the settings menu called Firewalls and virtual networks.<br>3. Ensure that you have elected to allow access from 'Selected networks'.<br>4. Enable check box for Allow trusted Microsoft services to access this storage account.<br>5. Click Save to apply your changes.<br>Azure Command Line Interface 2.0 Use the below command to update trusted Microsoft services.<br>Please visit <a href='https://docs.microsoft.com/en-us/azure/storage/common/storage-network-security' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_STR_011.py"
                        }
                    ],
                    "severity": "High",
                    "title": "Azure Storage Account Trusted Microsoft Services access should be enabled",
                    "description": "Specifies whether traffic is bypassed for Logging/Metrics/AzureServices. Possible values are any combination of Logging, Metrics, AzureServices (For example, 'Logging, Metrics'), or None to bypass none of those traffics. - None, Logging, Metrics, AzureServices.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_47",
                    "type": "rego",
                    "rule": "file(sql_servers.rego)",
                    "tags": [
                        {
                            "cloud": "git",
                            "compliance": [],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-047",
                            "eval": "data.rule.sql_public_access_disabled",
                            "message": "data.rule.sql_public_access_disabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_047.py"
                        }
                    ],
                    "severity": "Medium",
                    "title": "Ensure SQL servers don't have public network access enabled",
                    "description": "Always use Private Endpoint for Azure SQL Database and SQL Managed Instance",
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_49",
                    "type": "rego",
                    "rule": "file(sql_servers.rego)",
                    "tags": [
                        {
                            "cloud": "git",
                            "compliance": [
                                "PCI-DSS",
                                "GDPR",
                                "ISO 27001",
                                "NIST CSF",
                                "HIPAA",
                                "Best Practices"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-049",
                            "eval": "data.rule.sql_logical_server_login",
                            "message": "data.rule.sql_logical_server_login_err",
                            "remediationDescription": "This is set when the SQL Server is created. After created, only using external tools connected to the SQL Server, such as SSMS, can be used to alter the user, but it will not change the value in the Portal.<br><br>For more information: <a href='https://docs.microsoft.com/en-us/azure/sql-database/sql-database-manage-logins' target='_blank'>https://docs.microsoft.com/en-us/azure/sql-database/sql-database-manage-logins</a>.",
                            "remediationFunction": "PR_AZR_SQL_049.py"
                        }
                    ],
                    "severity": "Medium",
                    "title": "Ensure SQL Server administrator login does not contains 'Admin/Administrator' as name",
                    "description": "You must designate a Server admin login when you create an Azure SQL server. SQL server creates this account as a login in the master database. Only one such account can exist. This account connects using SQL Server authentication (username and password). It is recommended to avoid using names like 'admin' or 'administrator', which are targeted in brute force dictionary attacks.",
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_50",
                    "type": "rego",
                    "rule": "file(sql_servers.rego)",
                    "tags": [
                        {
                            "cloud": "git",
                            "compliance": [
                                "PCI-DSS",
                                "ISO 27001",
                                "NIST CSF",
                                "HIPAA",
                                "Best Practices"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-050",
                            "eval": "data.rule.fail_over_groups",
                            "message": "data.rule.fail_over_groups_err",
                            "remediationDescription": "Azure Console:<br>1. Go to SQL Servers<br>2. For each SQL Server<br>3. Select Failover groups<br>4. Press the Add group link on top of the page",
                            "remediationFunction": "PR_AZR_SQL_050.py"
                        }
                    ],
                    "severity": "Medium",
                    "title": "Ensure Azure SQL Server data replication with Fail Over groups",
                    "description": "SQL Server data should be replicated to avoid loss of unreplicated data.",
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_42",
                    "type": "rego",
                    "rule": "file(sql_servers_auditing.rego)",
                    "tags": [
                        {
                            "cloud": "git",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-042",
                            "eval": "data.rule.sql_server_log_audit",
                            "message": "data.rule.sql_server_log_audit_err",
                            "remediationDescription": "az sql server audit-policy show --name<br><br>References:<br><a href='https://docs.microsoft.com/en-us/cli/azure/mysql/server?view=azure-cli-latest#az_mysql_server_update' target='_blank'>https://docs.microsoft.com/en-us/cli/azure/mysql/server?view=azure-cli-latest#az_mysql_server_update</a> for details.",
                            "remediationFunction": "PR_AZR_SQL_042.py"
                        }
                    ],
                    "severity": "High",
                    "title": "Ensure that SQL Server Auditing is Enabled",
                    "description": "Ensure that SQL Server Auditing is enabled in order to keep track of Audit events.",
                    "masterSnapshotId": [
                        "AZRSNP_404"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_44",
                    "type": "rego",
                    "rule": "file(sql_servers_auditing.rego)",
                    "tags": [
                        {
                            "cloud": "git",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-044",
                            "eval": "data.rule.sql_server_audit_log_retention",
                            "message": "data.rule.sql_server_audit_log_retention_err",
                            "remediationDescription": "az sql server audit-policy update -g -n --state Enabled --storage-account --retention-days 91<br><br>References:<br><a href='https://docs.microsoft.com/en-us/cli/azure/sql/server/audit-policy?view=azure-cli-latest#az_sql_server_audit_policy_show' target='_blank'>https://docs.microsoft.com/en-us/cli/azure/sql/server/audit-policy?view=azure-cli-latest#az_sql_server_audit_policy_show</a> for more details.",
                            "remediationFunction": "PR_AZR_SQL_044.py"
                        }
                    ],
                    "severity": "High",
                    "title": "Azure SQL server audit log retention should be greater than 90 days",
                    "description": "Audit Logs can be used to check for anomalies and give insight into suspected breaches or misuse of information and access. We recommend you configure SQL server audit retention to be greater than 90 days.",
                    "masterSnapshotId": [
                        "AZRSNP_404"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_46",
                    "type": "rego",
                    "rule": "file(sql_servers_encryption.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-046",
                            "eval": "data.rule.serverKeyType",
                            "message": "data.rule.serverKeyType_err",
                            "remediationDescription": "Using Azure CLI:<br><br>Use the below command to encrypt SQL server's TDE protector with a Customer-managed key<br><br>az sql server tde-key >> Set --resource-group --server --server-key-type {AzureKeyVault} [--kid ]<br><br>References:<br>1. <a href='https://docs.microsoft.com/en-us/sql/relational-databases/security/encryption/transparent-data-encryption-byok-azure-sql' target='_blank'>https://docs.microsoft.com/en-us/sql/relational-databases/security/encryption/transparent-data-encryption-byok-azure-sql</a><br>2. <a href='https://azure.microsoft.com/en-in/blog/preview-sql-transparent-data-encryption-tde-with-bring-your-own-key-support/' target='_blank'>https://azure.microsoft.com/en-in/blog/preview-sql-transparent-data-encryption-tde-with-bring-your-own-key-support/</a>",
                            "remediationFunction": "PR_AZR_SQL_046.py"
                        }
                    ],
                    "severity": "Medium",
                    "title": "Ensure SQL server's TDE protector is encrypted with Customer-managed key",
                    "description": "Customer-managed key support for Transparent Data Encryption (TDE) allows user control of TDE encryption keys and restricts who can access them and when. Azure Key Vault, Azure's cloud-based external key management system is the first key management service where TDE has integrated support for Customer-managed keys. With Customer-managed key support, the database encryption key is protected by an asymmetric key stored in the Key Vault. The asymmetric key is set at the server level and inherited by all databases under that server.",
                    "tags": [
                        {
                            "cloud": "git",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "ARM_TEMPLATE_SNAPSHOT"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_216",
                    "type": "rego",
                    "rule": "file(PR_AZR_0007.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0007",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Sign in to the Azure portal.<br>2. Goto the Kubernetes Service and select your cluster.<br>3. Click Networking option in the left window pane.<br>4. Uncheck \"Enable HTTP application routing\" and click on save button.",
                            "remediationFunction": "PR_AZR_0007.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "Medium",
                    "title": "Azure AKS cluster HTTP application routing enabled",
                    "description": "HTTP application routing configures an Ingress controller in your AKS cluster. As applications are deployed, the solution also creates publicly accessible DNS names for application endpoints. While this makes it easy to access applications that are deployed to your Azure AKS cluster, this add-on is not recommended for production use.This policy checks your AKS cluster HTTP application routing add-on setting and alerts if enabled."
                },
                {
                    "masterTestId": "AZURE_TEST_217",
                    "type": "rego",
                    "rule": "file(PR_AZR_0008.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0008",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Sign in to the Azure portal.<br>2. Goto the Kubernetes Service and select your cluster.<br>3. Click Insights in the left window pane.<br>4. If you have an existing Log Analytics workspace in the same subscription as the cluster, select it in the drop-down list.<br>5. Select Enable.",
                            "remediationFunction": "PR_AZR_0008.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "Medium",
                    "title": "Azure AKS cluster monitoring enabled",
                    "description": "Azure Monitor for Containers is a feature designed to monitor the performance of Container workloads deployed to either Azure Container Instances or managed Kubernetes clusters hosted on Azure Kubernetes Service (AKS). Monitoring your Containers is critical, especially when you're running a production cluster, at scale, with multiple applications.This policy checks your AKS cluster monitoring add-on setting and alerts if no configuration is found, or monitoring is disabled."
                },
                {
                    "masterTestId": "AZURE_TEST_218",
                    "type": "rego",
                    "rule": "file(PR_AZR_0009.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0009",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Sign in to the Azure portal.<br>2. Goto the Kubernetes Service and select your cluster.<br>3. Click Scale in the left window pane.<br>4. Just above Total cluster capacity, increase the total number of nodes in your pool.<br>5. Click Save.",
                            "remediationFunction": "PR_AZR_0009.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "Medium",
                    "title": "Azure AKS cluster pool profile count contains 3 more then nodes",
                    "description": "Ensure your AKS cluster pool profile count contains 3 or more nodes. This is recommended for a more resilient cluster. (Clusters smaller than 3 may experience downtime during upgrades.)This policy checks the size of your cluster pool profiles and alerts if there are fewer than 3 nodes."
                },
                {
                    "masterTestId": "AZURE_TEST_219",
                    "type": "rego",
                    "rule": "file(PR_AZR_0010.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0010",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL:",
                            "remediationFunction": "PR_AZR_0010.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "Medium",
                    "title": "Azure AKS enable role-based access control (RBAC) enforced",
                    "description": "To provide granular filtering of the actions that users can perform, Kubernetes uses role-based access controls (RBAC). This control mechanism lets you assign users, or groups of users, permission to do things like create or modify resources, or view logs from running application workloads. These permissions can be scoped to a single namespace, or granted across the entire AKS cluster."
                },
                {
                    "masterTestId": "AZURE_TEST_224",
                    "type": "rego",
                    "rule": "file(PR_AZR_0015.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0015",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Log in to the Azure portal.<br>2. Select 'All services' > 'Container Registries'.<br>3. Select the Container registry you need to modify.<br>4. Select 'Upgrade to managed registry'.<br>5. Select 'OK' to confirm the upgrade.",
                            "remediationFunction": "PR_AZR_0015.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_224"
                    ],
                    "severity": "Medium",
                    "title": "Azure Container Registry using the deprecated not classic registry",
                    "description": "This policy identifies an Azure Container Registry (ACR) that is using the classic SKU. The initial release of the Azure Container Registry (ACR) service that was offered as a classic SKU is being deprecated and will be unavailable after April 2019. As a best practice, upgrade your existing classic registry to a managed registry."
                },
                {
                    "masterTestId": "AZURE_TEST_229",
                    "type": "rego",
                    "rule": "file(PR_AZR_0020.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0020",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row (22 PORT).<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0020.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group (NSG) allows SSH traffic from internet on port 22",
                    "description": "Blocking SSH port 22 will protect users from attacks like Account compromise.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_230",
                    "type": "rego",
                    "rule": "file(PR_AZR_0021.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0021",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row (3389 PORT).<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0021.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group (NSG) allows traffic from internet on port 3389",
                    "description": "Blocking RDP port 3389 will protect users from attacks like account compromise, Denial of service and ransomware.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_231",
                    "type": "rego",
                    "rule": "file(PR_AZR_0022.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0022",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row.<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0022.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "CUSTOM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group (NSG) dose not having Inbound rule overly permissive to all TCP traffic from any source",
                    "description": "This policy identifies Azure Network Security Groups (NSGs) which are overly permissive to open TCP traffic from any source. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources, allowing only authorized protocols and ports.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_232",
                    "type": "rego",
                    "rule": "file(PR_AZR_0023.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0023",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row.<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0023.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "CUSTOM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group (NSG) dose not having Inbound rule overly permissive to all UDP traffic from any source",
                    "description": "This policy identifies Azure Network Security Groups (NSGs) which are overly permissive to open UDP traffic from any source. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources, allowing only authorized protocols and ports.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_233",
                    "type": "rego",
                    "rule": "file(PR_AZR_0024.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0024",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row.<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0024.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "CUSTOM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group (NSG) dose not having Inbound rule overly permissive to all traffic from Internet on TCP protocol",
                    "description": "This policy identifies Azure Network Security Groups (NSGs) which are overly permissive to all traffic from Internet on TCP protocol. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources, allowing only authorized protocols and ports.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_234",
                    "type": "rego",
                    "rule": "file(PR_AZR_0025.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0025",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row.<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0025.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group (NSG) dose not having Inbound rule overly permissive to all traffic from Internet on UDP protocol",
                    "description": "This policy identifies Azure Network Security Groups (NSGs) which are overly permissive to all traffic from Internet on UDP protocol. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources, allowing only authorized protocols and ports.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_235",
                    "type": "rego",
                    "rule": "file(PR_AZR_0026.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0026",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row.<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0026.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "CUSTOM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group (NSG) dose not having Inbound rule overly permissive to all traffic from Internet on any protocol",
                    "description": "This policy identifies Azure Network Security Groups (NSGs) which are overly permissive to all traffic from Internet on any protocol. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources, allowing only authorized protocols and ports.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_236",
                    "type": "rego",
                    "rule": "file(PR_AZR_0027.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0027",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row.<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0027.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group (NSG) dose not having Inbound rule overly permissive to allow all traffic from any source on any protocol",
                    "description": "This policy identifies NSGs which allows incoming traffic from any source. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources on authorized protocols and ports.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_237",
                    "type": "rego",
                    "rule": "file(PR_AZR_0028.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0028",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row.<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0028.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group (NSG) dose not having Inbound rule overly permissive to allow all traffic from any source on any destiation",
                    "description": "This policy identifies NSGs which allows incoming traffic from any source. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources on authorized protocols and ports.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_238",
                    "type": "rego",
                    "rule": "file(PR_AZR_0029.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0029",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row (445 PORT).<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0029.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group allows CIFS (UDP Port 445)",
                    "description": "This policy detects any NSG rule that allows CIFS traffic on UDP port 445 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.As a best practice, restrict CIFS solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_239",
                    "type": "rego",
                    "rule": "file(PR_AZR_0030.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0030",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row ( TCP PORT 53).<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0030.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group allows DNS (TCP Port 53)",
                    "description": "This policy detects any NSG rule that allows DNS traffic on TCP port 53 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.As a best practice, restrict DNS solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_240",
                    "type": "rego",
                    "rule": "file(PR_AZR_0031.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0031",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row ( UDP Port 53 ).<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0031.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group allows DNS (UDP Port 53)",
                    "description": "This policy detects any NSG rule that allows DNS traffic on UDP port 53 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.As a best practice, restrict DNS solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_241",
                    "type": "rego",
                    "rule": "file(PR_AZR_0032.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0032",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row (21 PORT).<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0032.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group allows FTP (TCP Port 21)",
                    "description": "This policy detects any NSG rule that allows FTP traffic on TCP port 21 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.As a best practice, restrict FTP solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_242",
                    "type": "rego",
                    "rule": "file(PR_AZR_0033.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0033",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row (PORT 20).<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0033.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group allows FTP-Data (TCP Port 20)",
                    "description": "This policy detects any NSG rule that allows FTP-Data traffic on TCP port 20 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.As a best practice, restrict FTP-Data solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_243",
                    "type": "rego",
                    "rule": "file(PR_AZR_0034.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0034",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row.<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0034.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group allows ICMP (Ping)",
                    "description": "ICMP is used by devices to communicate error messages and status. While ICMP is useful for  diagnostics and troubleshooting, it can also be used to exploit or disrupt systems.This policy detects any NSG rule that allows ICMP (Ping) traffic from the internet. Review your list of NSG rules to ensure that your resources are not exposed.As a best practice, restrict ICMP (Ping) solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_244",
                    "type": "rego",
                    "rule": "file(PR_AZR_0035.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0035",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row (PORT 4333).<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0035.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group allows MSQL (TCP Port 4333)",
                    "description": "This policy detects any NSG rule that allows MSQL traffic on TCP port 4333 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.As a best practice, restrict MSQL solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_245",
                    "type": "rego",
                    "rule": "file(PR_AZR_0036.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0036",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row ( PORT 3306).<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0036.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group allows MySQL (TCP Port 3306)",
                    "description": "This policy detects any NSG rule that allows MySQL traffic on TCP port 3306 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.As a best practice, restrict MySQL solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_246",
                    "type": "rego",
                    "rule": "file(PR_AZR_0037.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0037",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row ( PORT 137).<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0037.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group allows NetBIOS (UDP Port 137)",
                    "description": "This policy detects any NSG rule that allows NetBIOS traffic on UDP port 137 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.As a best practice, restrict NetBIOS solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_247",
                    "type": "rego",
                    "rule": "file(PR_AZR_0038.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0038",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row(PORT 138).<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0038.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group allows NetBIOS (UDP Port 138)",
                    "description": "This policy identifies NSGs which allows incoming traffic from any source. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources on authorized protocols and ports.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_248",
                    "type": "rego",
                    "rule": "file(PR_AZR_0039.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0039",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row(PORT 5432).<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0039.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group allows PostgreSQL (TCP Port 5432)",
                    "description": "This policy detects any NSG rule that allows PostgreSQL traffic on TCP port 5432 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.As a best practice, restrict PostgreSQL solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_249",
                    "type": "rego",
                    "rule": "file(azure_network_security_249.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0040",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row(PORT 25).<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0040.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "next generation firewall is set to OFF in Security Center",
                    "description": "This policy detects any NSG rule that allows SMTP traffic on TCP port 25 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.As a best practice, restrict SMTP solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_250",
                    "type": "rego",
                    "rule": "file(PR_AZR_0041.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0041",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row(PORT 1434).<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0041.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group allows SQLServer (UDP Port 1434)",
                    "description": "This policy detects any NSG rule that allows SQLServer traffic on UDP port 1434 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.As a best practice, restrict SQLServer solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_251",
                    "type": "rego",
                    "rule": "file(PR_AZR_0042.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0042",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row(PORT 1433).<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0042.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group allows SqlServer (TCP Port 1433)",
                    "description": "This policy detects any NSG rule that allows SqlServer traffic on TCP port 1433 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.As a best practice, restrict SqlServer solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_252",
                    "type": "rego",
                    "rule": "file(PR_AZR_0043.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0043",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row(PORT 4333).<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0043.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group allows MSQL (TCP Port 4333)",
                    "description": "Telnet provides a plaintext connection to manage devices using the command line, and is less secure than SSH.This policy detects any NSG rule that allows Telnet traffic on TCP port 23 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.As a best practice, restrict Telnet solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_253",
                    "type": "rego",
                    "rule": "file(PR_AZR_0044.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0044",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row(PORT 5500).<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0044.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group allows VNC Listener (TCP Port 5500)",
                    "description": "This policy detects any NSG rule that allows VNC Listener traffic on TCP port 5500 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.As a best practice, restrict VNC Listener solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_254",
                    "type": "rego",
                    "rule": "file(PR_AZR_0045.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0045",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row(PORT 5900).<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0045.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group allows VNC Server (TCP Port 5900)",
                    "description": "This policy detects any NSG rule that allows VNC Server traffic on TCP port 5900 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.As a best practice, restrict VNC Server solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_255",
                    "type": "rego",
                    "rule": "file(PR_AZR_0046.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0046",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row(PORT 135).<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0046.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group allows Windows RPC (TCP Port 135)",
                    "description": "This policy detects any NSG rule that allows Windows RPC traffic on TCP port 135 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.As a best practice, restrict Windows RPC solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_256",
                    "type": "rego",
                    "rule": "file(PR_AZR_0047.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0047",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row(PORT 445).<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0047.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group allows Windows SMB (TCP Port 445)",
                    "description": "This policy detects any NSG rule that allows Windows SMB traffic on TCP port 445 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.As a best practice, restrict Windows SMB solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_257",
                    "type": "rego",
                    "rule": "file(PR_AZR_0048.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0048",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "1. Login to Azure Portal.<br>2. Click on All services.<br>3. Under Networking, click on Network security groups.<br>4. Click on reported Network security group.<br> 5. Under settings, click on Inbound security rules.<br>6. Click on reported row.<br>7. Set Action to Deny.<br>8. Click on OK.",
                            "remediationFunction": "PR_AZR_0048.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Group with Outbound rule to allow all traffic to any source",
                    "description": "This policy identifies NSGs which allows outgoing traffic to any source. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic to known sources on authorized protocols and ports.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_284",
                    "type": "rego",
                    "rule": "file(PR_AZR_0075.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0075",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_0075.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure virtual network peer is disconnected",
                    "description": "Virtual network peering enables you to connect two Azure virtual networks so that the resources in these networks are directly connected.This policy identifies Azure virtual network peers that are disconnected. Typically, the disconnection happens when a peering configuration is deleted on one virtual network, and the other virtual network reports the peering status as disconnected.",
                    "masterSnapshotId": [
                        "AZRSNP_284"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_6",
                    "type": "rego",
                    "rule": "file(PR_AZR_gID6.rego)",
                    "evals": [
                        {
                            "id": "gID6",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/rest/api/virtualnetwork/networksecuritygroups/get , https://resources.azure.com/subscriptions/db3667b7-cef9-4523-8e45-e2d9ed4518ab/resourceGroups/hardikResourceGroup/providers/Microsoft.Network/networkSecurityGroups/hardikVM-nsg",
                            "remediationFunction": "PR_AZR_gID6.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Publicly exposed DB Ports",
                    "description": "DB Servers contain sensitive data and should not be exposed to any direct traffic from internet. This policy checks for the network traffic from internet hitting the DB Servers on their default ports. The DB servers default ports are : Microsoft SQL Server (1433), Oracle (1521), MySQL (3306), Sybase (5000), Postgresql (5432), CouchDB (5984), Redis (6379, 6380), RethinkDB (8080,28015, 29015), CassandraDB (9042), Memcached (11211), MongoDB (27017), DB2 (50000).",
                    "masterSnapshotId": [
                        "AZRSNP_284"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_211",
                    "type": "rego",
                    "rule": "file(PR_AZR_0002.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0002",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/rest/api/resources/policyassignments/list#code-try-0",
                            "remediationFunction": "PR_AZR_0002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "ISO 27001",
                                "NIST 800"
                            ],
                            "service": [
                                "Management and Governance"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Adaptive Application Controls is set to OFF in Security Center",
                    "description": "Turning on Adaptive Application Controls will make sure that only certain applications can run on your VMs in Microsoft Azure. This will prevent any malicious, unwanted, or unsupported software on the VMs.",
                    "masterSnapshotId": [
                        "AZRSNP_211"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_258",
                    "type": "rego",
                    "rule": "file(PR_AZR_0049.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0049",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/rest/api/resources/policyassignments/list#code-try-0",
                            "remediationFunction": "PR_AZR_0049.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Management and Governance"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Security Groups (NSG) is set to OFF in Security Center",
                    "description": "Turning on Network Security Groups will identify the Network Security Groups which are not enabled. Network Security Groups are designed to control inbound and outbound traffic to VMs that have open endpoints.",
                    "masterSnapshotId": [
                        "AZRSNP_211"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_285",
                    "type": "rego",
                    "rule": "file(PR_AZR_0076.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0076",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/rest/api/resources/policyassignments/list#code-try-0",
                            "remediationFunction": "PR_AZR_0076.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Management and Governance"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Disk encryption is set to OFF in Security Center",
                    "description": "Turning on Disk encryption for virtual machines will secure the data by encrypting it.",
                    "masterSnapshotId": [
                        "AZRSNP_211"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_286",
                    "type": "rego",
                    "rule": "file(PR_AZR_0077.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0077",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/rest/api/resources/policyassignments/list#code-try-0",
                            "remediationFunction": "PR_AZR_0077.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Management and Governance"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Endpoint protection is set to OFF in Security Center",
                    "description": "Turning on the Endpoint Protection will make sure that any issues or shortcomings in endpoint protection for all Microsoft Windows virtual machines are identified so that they can, in turn, be removed.",
                    "masterSnapshotId": [
                        "AZRSNP_211"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_287",
                    "type": "rego",
                    "rule": "file(PR_AZR_0078.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0078",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/rest/api/resources/policyassignments/list#code-try-0",
                            "remediationFunction": "PR_AZR_0078.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "ISO 27001",
                                "NIST 800"
                            ],
                            "service": [
                                "Management and Governance"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "JIT Network Access is set to OFF in Security Center",
                    "description": "Turning on JIT Network Access will enhance the protection of VMs by creating a Just in Time VM. The JIT VM with NSG rule will restrict the availability of access to the ports to connect to the VM for a pre-set time and only after checking the Role Based Access Control permissions of the user. This feature will control the brute force attacks on the VMs.",
                    "masterSnapshotId": [
                        "AZRSNP_211"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_288",
                    "type": "rego",
                    "rule": "file(PR_AZR_0079.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0079",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/rest/api/resources/policyassignments/list#code-try-0",
                            "remediationFunction": "PR_AZR_0079.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Management and Governance"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Next generation firewall is set to OFF in Security Center",
                    "description": "Turning on Next Generation Firewall (NGFW) will extend protection beyond a traditional firewall setting of Network Security Groups in Microsoft Azure environment. A Next-Generation Firewall (NGFW) is a part of the third generation of firewall technology, combining a traditional firewall with other network device filtering functionalities.",
                    "masterSnapshotId": [
                        "AZRSNP_211"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_290",
                    "type": "rego",
                    "rule": "file(PR_AZR_0081.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0081",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/rest/api/resources/policyassignments/list#code-try-0",
                            "remediationFunction": "PR_AZR_0081.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Management and Governance"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "SQL Encryption is set to OFF in Security Center",
                    "description": "Turning on SQL Encryption enables encryption at rest for your SQL database, related backups, and transaction log files. This will make sure that even if the database is compromised, the data is not readable.",
                    "masterSnapshotId": [
                        "AZRSNP_211"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_292",
                    "type": "rego",
                    "rule": "file(PR_AZR_0083.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0083",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/rest/api/resources/policyassignments/list#code-try-0",
                            "remediationFunction": "PR_AZR_0083.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Management and Governance"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "SQL auditing and Threat detection is set to OFF in Security Center",
                    "description": "Turning on SQL auditing and Threat detection will make sure that the databases adhere to regulatory compliance. It will also help understand database activity, and gain insights into discrepancies and anomalies that could show business concerns or any security violations.",
                    "masterSnapshotId": [
                        "AZRSNP_211"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_295",
                    "type": "rego",
                    "rule": "file(PR_AZR_0086.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0086",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/rest/api/resources/policyassignments/list#code-try-0",
                            "remediationFunction": "PR_AZR_0086.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Management and Governance"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Security Configurations is set to OFF in Security Center",
                    "description": "Turning on the Security configurations will enable the daily analysis of operating system configurations. The rules for hardening the operating system like firewall rules, password and audit policies are reviewed. Recommendations are made for setting the right level of security controls.",
                    "masterSnapshotId": [
                        "AZRSNP_211"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_303",
                    "type": "rego",
                    "rule": "file(PR_AZR_0094.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0094",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/rest/api/resources/policyassignments/list#code-try-0",
                            "remediationFunction": "PR_AZR_0094.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Management and Governance"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Storage Encryption is set to OFF in Security Center",
                    "description": "Turning on Storage Encryption will encrypt the data written to the storage and decrypt it when retrieved from the storage. The data encryption starts from the point this setting is turned on. The old data remains unencrypted.",
                    "masterSnapshotId": [
                        "AZRSNP_211"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_304",
                    "type": "rego",
                    "rule": "file(PR_AZR_0095.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0095",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/rest/api/resources/policyassignments/list#code-try-0",
                            "remediationFunction": "PR_AZR_0095.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Management and Governance"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "System updates is set to OFF in Security Center",
                    "description": "Turning on the System updates will retrieve a list of recommended security and critical updates for the given virtual system from Microsoft Windows Update or Microsoft Windows Server Update. These updates are also shown for Linux systems through distro-provided package management systems. The recommendation is to apply all the latest updates.",
                    "masterSnapshotId": [
                        "AZRSNP_211"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_308",
                    "type": "rego",
                    "rule": "file(PR_AZR_0099.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0099",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/rest/api/resources/policyassignments/list#code-try-0",
                            "remediationFunction": "PR_AZR_0099.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Management and Governance"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Vulnerability assessment is set to OFF in Security Center",
                    "description": "Turning on Vulnerability assessment will recommend that you install a vulnerability assessment solution on your VM. A partner agent, after deployment, will report any vulnerability data for the VM.",
                    "masterSnapshotId": [
                        "AZRSNP_211"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_309",
                    "type": "rego",
                    "rule": "file(PR_AZR_0100.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0100",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/rest/api/resources/policyassignments/list#code-try-0",
                            "remediationFunction": "PR_AZR_0100.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Management and Governance"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Web application firewall is set to OFF in Security Center",
                    "description": "Turning on Web application firewall will identify if WAF is recommended for the public facing IP instances in your environment. Web Application Firewall or WAF is recommended for any public facing IP instance (VM or Load Balancer) which has an associated Network Security Group with open inbound ports 80 and 443.",
                    "masterSnapshotId": [
                        "AZRSNP_211"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_274",
                    "type": "rego",
                    "rule": "file(PR_AZR_0065.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0065",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/rest/api/compute/virtualmachines/get , https://resources.azure.com/subscriptions/db3667b7-cef9-4523-8e45-e2d9ed4518ab/resourceGroups/hardikResourceGroup/providers/Microsoft.Compute/virtualMachines/hardikVM",
                            "remediationFunction": "PR_AZR_0065.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure Virtual Machine is assigned to an availability set",
                    "description": "To provide application redundancy during planned or unplanned maintenance events, you can group two or more virtual machines (VMs) in an availability set. An availability set ensures that the VMs are distributed across multiple isolated hardware nodes in a cluster so that only a subset of your VMs are impacted should a hardware or software failure occur on Azure.This policy identifies Azure VMs that are not deployed in an availability set. As a high availability (HA) best practice, deploy your VMs in an availability set.",
                    "masterSnapshotId": [
                        "AZRSNP_274"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_277",
                    "type": "rego",
                    "rule": "file(PR_AZR_0068.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0068",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/rest/api/compute/disks/get , https://resources.azure.com/subscriptions/db3667b7-cef9-4523-8e45-e2d9ed4518ab/resourceGroups/hardikResourceGroup/providers/Microsoft.Compute/disks",
                            "remediationFunction": "PR_AZR_0068.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "severity": "Medium",
                    "title": "Azure disk for VM operating system is encrypted at rest using ADE",
                    "description": "To meet your organizational security or compliance requirement, Azure provides disk encryption at rest using Azure Storage Service Encryption (SSE) and Azure Disk Encryption (ADE). Starting February 2017, SSE is enabled by default for all managed disks. ADE is integrated with Azure Key Vault to help you control, manage, and audit the disk encryption keys and secrets.This policy detects Virtual Machine (VM) OS disks that are not encrypted at rest using ADE. As a best practice, enable ADE for provide volume encryption for the OS disk. For more information, see https://docs.microsoft.com/en-us/azure/security/azure-security-disk-encryption-overview.",
                    "masterSnapshotId": [
                        "AZRSNP_277"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_302",
                    "type": "rego",
                    "rule": "file(PR_AZR_0093.rego)",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "CIS",
                                "HIPAA",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "evals": [
                        {
                            "id": "PR-AZR-0093",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://resources.azure.com/subscriptions/db3667b7-cef9-4523-8e45-e2d9ed4518ab/resourceGroups/hardikResourceGroup/providers/Microsoft.Storage/storageAccounts/vatsalstorage1 , https://docs.microsoft.com/en-us/rest/api/storagerp/storageaccounts/getproperties",
                            "remediationFunction": "PR_AZR_0093.py"
                        }
                    ],
                    "severity": "Medium",
                    "title": "Storage Accounts without Secure transfer enabled",
                    "description": "Turning on firewall rules for your storage account blocks incoming requests for data by default, unless the requests come from a service that is operating within an Azure Virtual Network (VNet). Requests that are blocked include those from other Azure services, from the Azure portal, from logging and metrics services, and so on.You can grant access to Azure services that operate from within a VNet by allowing the subnet of the service instance. Enable a limited number of scenarios through the Exceptions mechanism described in the following section. To access the Azure portal, you would need to be on a machine within the trusted boundary (either IP or VNet) that you set up.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_221",
                    "type": "rego",
                    "rule": "file(PR_AZR_0012.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0012",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/rest/api/application-gateway/applicationgateways/get , https://resources.azure.com/subscriptions/db3667b7-cef9-4523-8e45-e2d9ed4518ab/resourceGroups/hardikResourceGroup/providers/Microsoft.Network/applicationGateways/hardikApplicationGateway",
                            "remediationFunction": "PR_AZR_0012.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_221"
                    ],
                    "severity": "Medium",
                    "title": "Azure Application Gateway dose have the Web application firewall (WAF) enabled",
                    "description": "This policy identifies Azure Application Gateways that do not have Web application firewall (WAF) enabled. As a best practice, enable WAF to manage and protect your web applications behind the Application Gateway from common exploits and vulnerabilities."
                },
                {
                    "masterTestId": "AZURE_TEST_259",
                    "type": "rego",
                    "rule": "file(PR_AZR_0050.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0050",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_0050.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_260"
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Watcher Network Security Group (NSG) flow logs are desebled",
                    "description": "This policy identifies Azure Network Security Groups (NSG) for which flow logs are disabled.NSG flow logs, a feature of the Network Watcher app, enable you to view information about ingress and egress IP traffic through an NSG. The flow logs include information such as:-Outbound and inbound flows on a per-rule basis.-Network interface to which the flow applies.-5-tuple information about the flow (source/destination IP, source/destination port, protocol).-Whether the traffic was allowed or denied"
                },
                {
                    "masterTestId": "AZURE_TEST_260",
                    "type": "rego",
                    "rule": "file(PR_AZR_0051.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0051",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_0051.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_260"
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Watcher Network Security Group (NSG) flow logs retention is less than 90 days",
                    "description": "This policy identifies Azure Network Security Groups (NSG) for which flow logs retention period is 90 days or less.NSG flow logs, a feature of the Network Watcher app, enable you to view information about ingress and egress IP traffic through an NSG. The flow logs include information such as:-Outbound and inbound flows on a per-rule basis.-Network interface to which the flow applies.-5-tuple information about the flow (source/destination IP, source/destination port, protocol).-Whether the traffic was allowed or denied."
                },
                {
                    "masterTestId": "AZURE_TEST_1",
                    "type": "rego",
                    "rule": "file(gID1.rego)",
                    "evals": [
                        {
                            "id": "gID1",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.network/networksecuritygroups",
                            "remediationFunction": "PR_AZR_gID1.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "HIPAA",
                                "NIST CSF"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "Medium",
                    "title": "Instance is communicating with ports known to mine Bitcoin",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_210",
                    "type": "rego",
                    "rule": "file(PR_AZR_0001.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0001",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/azure-monitor/platform/template-workspace-configuration",
                            "remediationFunction": "PR_AZR_0001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_210"
                    ],
                    "severity": "Medium",
                    "title": "Activity Log Retention should not be set to less than 365 days",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_212",
                    "type": "rego",
                    "rule": "file(PR_AZR_0003.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0003",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/2017-03-01-preview/servers/databases/auditingsettings",
                            "remediationFunction": "PR_AZR_0003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_212"
                    ],
                    "severity": "Medium",
                    "title": "Auditing for SQL database should be set to On",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_214",
                    "type": "rego",
                    "rule": "file(PR_AZR_0005.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0005",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.containerregistry/registries/webhooks",
                            "remediationFunction": "PR_AZR_0005.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_214"
                    ],
                    "severity": "Medium",
                    "title": "Azure ACR HTTPS not enabled for webhook",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_215",
                    "type": "rego",
                    "rule": "file(PR_AZR_0006.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0006",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.containerservice/2020-04-01/managedclusters",
                            "remediationFunction": "PR_AZR_0006.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "Medium",
                    "title": "Azure AKS cluster Azure CNI networking not enabled",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_220",
                    "type": "rego",
                    "rule": "file(PR_AZR_0011.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0011",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/rest/api/application-gateway/applicationgateways/get , https://resources.azure.com/subscriptions/db3667b7-cef9-4523-8e45-e2d9ed4518ab/resourceGroups/hardikResourceGroup/providers/Microsoft.Network/applicationGateways/hardikApplicationGateway",
                            "remediationFunction": "PR_AZR_0011.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_221"
                    ],
                    "severity": "Medium",
                    "title": "Azure Application Gateway allows TLSv1.1 or lower",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_222",
                    "type": "rego",
                    "rule": "file(PR_AZR_0013.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0013",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.storage/2019-06-01/storageaccounts/blobservices/containers",
                            "remediationFunction": "PR_AZR_0013.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_222"
                    ],
                    "severity": "Medium",
                    "title": "Azure Blob container(s) with public access and logging set to less than 180 days",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_226",
                    "type": "rego",
                    "rule": "file(PR_AZR_0017.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0017",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.insights/2017-05-01-preview/diagnosticsettings",
                            "remediationFunction": "PR_AZR_0017.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_226"
                    ],
                    "severity": "Medium",
                    "title": "Azure Key Vault audit logging is disabled",
                    "description": "This policy identifies Azure Key Vault instances for which audit logging is disabled. As a best practice, enable audit event logging for Key Vault instances to monitor how and when your key vaults are accessed, and by whom."
                },
                {
                    "masterTestId": "AZURE_TEST_227",
                    "type": "rego",
                    "rule": "file(PR_AZR_0018.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0018",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.keyvault/vaults/secrets",
                            "remediationFunction": "PR_AZR_0018.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_227"
                    ],
                    "severity": "Medium",
                    "title": "Azure Key Vault secrets have no expiration date",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_228",
                    "type": "rego",
                    "rule": "file(PR_AZR_0019.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0019",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.insights/2017-05-01-preview/diagnosticsettings",
                            "remediationFunction": "PR_AZR_0019.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_226"
                    ],
                    "severity": "Medium",
                    "title": "Azure Load Balancer diagnostics logs are disabled",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_261",
                    "type": "rego",
                    "rule": "file(PR_AZR_0052.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0052",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.authorization/2016-09-01/locks",
                            "remediationFunction": "PR_AZR_0052.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_261"
                    ],
                    "severity": "Medium",
                    "title": "Azure Resource Group does not have a resource lock",
                    "description": "Azure Resource Manager locks provide a way to lock down Azure resources from being deleted or modified. The lock level can be set to either 'CanNotDelete' or 'ReadOnly'. When you apply a lock at a parent scope, all resources within the scope inherit the same lock, and the most restrictive lock takes precedence.<br><br>This policy identifies Azure Resource Groups that do not have a lock set. As a best practice, place a lock on important resources to prevent accidental or malicious modification or deletion by unauthorized users."
                },
                {
                    "masterTestId": "AZURE_TEST_262",
                    "type": "rego",
                    "rule": "file(PR_AZR_0053.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0053",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/2017-03-01-preview/servers/databases/auditingsettings",
                            "remediationFunction": "PR_AZR_0053.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_212"
                    ],
                    "severity": "Medium",
                    "title": "Azure SQL Database with Auditing Retention less than 90 days",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_263",
                    "type": "rego",
                    "rule": "file(PR_AZR_0054.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0054",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/2018-06-01-preview/servers/databases/securityalertpolicies",
                            "remediationFunction": "PR_AZR_0054.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_263"
                    ],
                    "severity": "Medium",
                    "title": "Azure SQL Database with Threat Retention less than or equals to 90 days",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_264",
                    "type": "rego",
                    "rule": "file(PR_AZR_0055.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0055",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/2018-06-01-preview/servers/databases/securityalertpolicies",
                            "remediationFunction": "PR_AZR_0055.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_263"
                    ],
                    "severity": "Medium",
                    "title": "Azure SQL Databases with disabled Email service and co-administrators for Threat Detection",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_265",
                    "type": "rego",
                    "rule": "file(PR_AZR_0056.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0056",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/2017-03-01-preview/servers/databases/vulnerabilityassessments",
                            "remediationFunction": "PR_AZR_0056.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_265"
                    ],
                    "severity": "Medium",
                    "title": "Azure SQL Server advanced data security does not have an email alert recipient",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_266",
                    "type": "rego",
                    "rule": "file(PR_AZR_0057.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0057",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/2017-03-01-preview/servers/databases/vulnerabilityassessments",
                            "remediationFunction": "PR_AZR_0057.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_265"
                    ],
                    "severity": "Medium",
                    "title": "Azure SQL Server advanced data security does not send alerts to service and co-administrators",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_267",
                    "type": "rego",
                    "rule": "file(PR_AZR_0058.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0058",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/2017-03-01-preview/servers/databases/vulnerabilityassessments",
                            "remediationFunction": "PR_AZR_0058.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_265"
                    ],
                    "severity": "Medium",
                    "title": "Azure SQL Server advanced data security is disabled",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_268",
                    "type": "rego",
                    "rule": "file(PR_AZR_0059.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0059",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/2017-03-01-preview/servers/auditingsettings",
                            "remediationFunction": "PR_AZR_0059.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_212"
                    ],
                    "severity": "Medium",
                    "title": "Azure SQL Server audit log retention is less than 91 days",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_270",
                    "type": "rego",
                    "rule": "file(PR_AZR_0061.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0061",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/2017-03-01-preview/servers/securityalertpolicies",
                            "remediationFunction": "PR_AZR_0061.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_263"
                    ],
                    "severity": "Medium",
                    "title": "Azure SQL Server threat detection alerts not enabled for all threat types",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_271",
                    "type": "rego",
                    "rule": "file(PR_AZR_0062.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0062",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/2017-03-01-preview/servers/securityalertpolicies",
                            "remediationFunction": "PR_AZR_0062.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_263"
                    ],
                    "severity": "Medium",
                    "title": "Azure SQL Server threat logs retention is less than 91 days",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_272",
                    "type": "rego",
                    "rule": "file(PR_AZR_0063.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0063",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.insights/2017-05-01-preview/diagnosticsettings",
                            "remediationFunction": "PR_AZR_0063.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_226"
                    ],
                    "severity": "Medium",
                    "title": "Azure Storage Account with Auditing Retention less than 90 days (TJX)",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_273",
                    "type": "rego",
                    "rule": "file(PR_AZR_0064.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0064",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.compute/virtualmachines/extensions",
                            "remediationFunction": "PR_AZR_0064.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_273"
                    ],
                    "severity": "Medium",
                    "title": "Azure Virtual Machine does not have endpoint protection installed",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_275",
                    "type": "rego",
                    "rule": "file(PR_AZR_0066.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0066",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.network/virtualnetworks/subnets",
                            "remediationFunction": "PR_AZR_0066.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_275"
                    ],
                    "severity": "Medium",
                    "title": "Azure Virtual Network subnet is not configured with a Network Security Group",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_276",
                    "type": "rego",
                    "rule": "file(PR_AZR_0067.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0067",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.network/virtualnetworks/subnets",
                            "remediationFunction": "PR_AZR_0067.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_275"
                    ],
                    "severity": "Medium",
                    "title": "Azure Virtual Network subnet is not configured with a Network Security Group (TJX)",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_278",
                    "type": "rego",
                    "rule": "file(PR_AZR_0069.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0069",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.insights/2017-05-01-preview/diagnosticsettings",
                            "remediationFunction": "PR_AZR_0069.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_226"
                    ],
                    "severity": "Medium",
                    "title": "Azure storage account logging for blobs is disabled",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_279",
                    "type": "rego",
                    "rule": "file(PR_AZR_0070.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0070",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.insights/2017-05-01-preview/diagnosticsettings",
                            "remediationFunction": "PR_AZR_0070.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_226"
                    ],
                    "severity": "Medium",
                    "title": "Azure storage account logging for queues is disabled",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_280",
                    "type": "rego",
                    "rule": "file(PR_AZR_0071.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0071",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.insights/2017-05-01-preview/diagnosticsettings",
                            "remediationFunction": "PR_AZR_0071.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_226"
                    ],
                    "severity": "Medium",
                    "title": "Azure storage account logging for queues is disabled (TJX)",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_281",
                    "type": "rego",
                    "rule": "file(PR_AZR_0072.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0072",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.insights/2017-05-01-preview/diagnosticsettings",
                            "remediationFunction": "PR_AZR_0072.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_226"
                    ],
                    "severity": "Medium",
                    "title": "Azure storage account logging for tables is disabled",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_282",
                    "type": "rego",
                    "rule": "file(PR_AZR_0073.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0073",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.insights/2017-05-01-preview/diagnosticsettings",
                            "remediationFunction": "PR_AZR_0073.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_226"
                    ],
                    "severity": "Medium",
                    "title": "Azure storage account logging for tables is disabled (TJX)",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_283",
                    "type": "rego",
                    "rule": "file(PR_AZR_0074.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0074",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.storage/2019-06-01/storageaccounts/blobservices/containers",
                            "remediationFunction": "PR_AZR_0074.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_283"
                    ],
                    "severity": "Medium",
                    "title": "Azure storage accounts has blob container(s) with public access",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_291",
                    "type": "rego",
                    "rule": "file(PR_AZR_0082.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0082",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/2015-05-01-preview/servers/firewallrules",
                            "remediationFunction": "PR_AZR_0082.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_291"
                    ],
                    "severity": "Medium",
                    "title": "SQL Server Firewall rules allow access to any Azure internal resources",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_293",
                    "type": "rego",
                    "rule": "file(PR_AZR_0084.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0084",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/2014-04-01/servers/databases/transparentdataencryption",
                            "remediationFunction": "PR_AZR_0084.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_293"
                    ],
                    "severity": "Medium",
                    "title": "SQL databases has encryption disabled",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_294",
                    "type": "rego",
                    "rule": "file(PR_AZR_0085.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0085",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/2019-06-01-preview/servers/administrators",
                            "remediationFunction": "PR_AZR_0085.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA-CCM",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_294"
                    ],
                    "severity": "Medium",
                    "title": "SQL servers which do not have Azure Active Directory admin configured",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_296",
                    "type": "rego",
                    "rule": "file(PR_AZR_0087.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0087",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.security/securitycontacts",
                            "remediationFunction": "PR_AZR_0087.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_296"
                    ],
                    "severity": "Medium",
                    "title": "Security contact emails is not set in Security Center",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_297",
                    "type": "rego",
                    "rule": "file(PR_AZR_0088.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0088",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/2017-03-01-preview/servers/databases/auditingsettings",
                            "remediationFunction": "PR_AZR_0088.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_212"
                    ],
                    "severity": "Medium",
                    "title": "Send alerts on field value on SQL Databases is misconfigured",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_299",
                    "type": "rego",
                    "rule": "file(PR_AZR_0090.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0090",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.insights/2017-04-01/activitylogalerts",
                            "remediationFunction": "PR_AZR_0090.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_299"
                    ],
                    "severity": "Medium",
                    "title": "Send me emails about alerts is set to OFF in Security Center",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_2",
                    "type": "rego",
                    "rule": "file(gID2.rego)",
                    "evals": [
                        {
                            "id": "gID2",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.network/networksecuritygroups",
                            "remediationFunction": "PR_AZR_gID2.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "HIPAA",
                                "NIST CSF"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "Medium",
                    "title": "Instance is communicating with ports known to mine Ethereum",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_300",
                    "type": "rego",
                    "rule": "file(PR_AZR_0091.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0091",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.security/pricings",
                            "remediationFunction": "PR_AZR_0091.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "ISO 27001"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_300"
                    ],
                    "severity": "Medium",
                    "title": "Standard pricing tier is not selected in Security Center",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_305",
                    "type": "rego",
                    "rule": "file(PR_AZR_0096.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0096",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/2018-06-01-preview/servers/databases/securityalertpolicies",
                            "remediationFunction": "PR_AZR_0096.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_263"
                    ],
                    "severity": "Medium",
                    "title": "Threat Detection on SQL databases is set to Off",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_306",
                    "type": "rego",
                    "rule": "file(PR_AZR_0097.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0097",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/2018-06-01-preview/servers/databases/securityalertpolicies",
                            "remediationFunction": "PR_AZR_0097.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_263"
                    ],
                    "severity": "Medium",
                    "title": "Threat Detection types on SQL databases is misconfigured",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_307",
                    "type": "rego",
                    "rule": "file(PR_AZR_0098.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0098",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.network/vpngateways",
                            "remediationFunction": "PR_AZR_0098.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_307"
                    ],
                    "severity": "Medium",
                    "title": "VPN is not configured with cryptographic algorithm",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_3",
                    "type": "rego",
                    "rule": "file(gID3.rego)",
                    "evals": [
                        {
                            "id": "gID3",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.network/networksecuritygroups",
                            "remediationFunction": "PR_AZR_gID3.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "GDPR",
                                "HIPAA",
                                "NIST CSF",
                                "PCI-DSS",
                                "SOC 2"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "Medium",
                    "title": "Internet connectivity via tcp over insecure port",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_5",
                    "type": "rego",
                    "rule": "file(gID5.rego)",
                    "evals": [
                        {
                            "id": "gID5",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.network/networksecuritygroups",
                            "remediationFunction": "PR_AZR_gID5.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "Medium",
                    "title": "Memcached DDoS attack attempted",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_7",
                    "type": "rego",
                    "rule": "file(gID7.rego)",
                    "evals": [
                        {
                            "id": "gID7",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/azure/templates/microsoft.network/networksecuritygroups",
                            "remediationFunction": "PR_AZR_gID7.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "Medium",
                    "title": "RedisWannaMine vulnerable instances with active network traffic",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_213",
                    "type": "rego",
                    "rule": "file(PR_AZR_0004.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0004",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Make sure you are following the Arm api format presented at this URL: https://docs.microsoft.com/en-us/rest/api/resources/policyassignments/list#code-try-0",
                            "remediationFunction": "PR_AZR_0004.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_211"
                    ],
                    "severity": "Medium",
                    "title": "Automatic provisioning of monitoring agent is set to Off in Security Center",
                    "description": ""
                },
                {
                    "masterTestId": "AZURE_TEST_400",
                    "type": "rego",
                    "rule": "file(PR_AZR_0101.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0101",
                            "eval": "data.rule.sql_server_rulepass",
                            "message": "data.rule.sql_server_rulepass_err",
                            "remediationDescription": "Mannual Steps:<br>1) Open Azure Portal.<br>2) Open SQL Servers list<br>3) Select the SQL Server for which you want to modify the Mimimal TLS Version.<br>4) Click on `Firewalls and virtual networks` option under `Security` section.<br>5) Update the Minimum TLS Version to `1.2` and click on save button.",
                            "remediationFunction": "PR_AZR_0101.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "Medium",
                    "title": "Azure SQL Server check minumum TLS version",
                    "description": "This policy will find the Azure SQL Servers which have configured TLS version lower then 1.2"
                },
                {
                    "masterTestId": "AZURE_TEST_401",
                    "type": "rego",
                    "rule": "file(azure_401.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0101",
                            "eval": "data.rule.sql_instance_rulepass",
                            "message": "data.rule.sql_instance_rulepass_err",
                            "remediationDescription": "Mannual Steps:<br>1) Open Azure Portal.<br>2) Open SQL Instances list<br>3) Select the SQL Server for which you want to modify the Mimimal TLS Version.<br>4) Click on `Firewalls and virtual networks` option under `Security` section.<br>5) Update the Minimum TLS Version to `1.2` and click on save button.",
                            "remediationFunction": "PR_AZR_0101.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_401"
                    ],
                    "severity": "Medium",
                    "title": "Azure SQL Instances check minumum TLS version",
                    "description": "This policy will find the Azure SQL Instances which have configured TLS version lower then 1.2"
                },
                {
                    "masterTestId": "AZURE_TEST_402",
                    "type": "rego",
                    "rule": "file(PR_AZR_0102.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0102",
                            "eval": "data.rule.sql_server_rulepass",
                            "message": "data.rule.sql_server_rulepass_err",
                            "remediationDescription": "Mannual Steps:<br>1) Open Azure Portal.<br>2) Open Azure SQL list<br>3) Select the reported SQL Server.<br>4) Click on `Security Center` option under `Security` section.<br>5) Click on \"Enable Azure Defender for SQL\" button.",
                            "remediationFunction": "PR_AZR_0102.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "NIST 800"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_402"
                    ],
                    "severity": "Medium",
                    "title": "Advanced data security should be enabled on your SQL servers",
                    "description": "Azure Defender provides advanced SQL security capabilities, including SQL Vulnerability Assessment and Advanced Threat Protection. It is recomamanded to Enable the Azure Defender for SQL."
                },
                {
                    "masterTestId": "AZURE_TEST_403",
                    "type": "rego",
                    "rule": "file(PR_AZR_0102.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0102",
                            "eval": "data.rule.sql_instance_rulepass",
                            "message": "data.rule.sql_instance_rulepass_err",
                            "remediationDescription": "Mannual Steps:<br>1) Open Azure Portal.<br>2) Open Azure SQL list<br>3) Select the reported SQL Managed Instance.<br>4) Click on `Security Center` option under `Security` section.<br>5) Click on \"Enable Azure Defender for SQL\" button.",
                            "remediationFunction": "PR_AZR_0102.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "NIST 800"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_403"
                    ],
                    "severity": "Medium",
                    "title": "Advanced data security should be enabled on your SQL servers",
                    "description": "Azure Defender provides advanced SQL security capabilities, including SQL Vulnerability Assessment and Advanced Threat Protection. It is recomamanded to Enable the Azure Defender for SQL."
                },
                {
                    "masterTestId": "AZURE_TEST_404",
                    "type": "rego",
                    "rule": "file(PR_AZR_0103.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-0103",
                            "eval": "data.rule.rulepass",
                            "message": "data.rule.rulepass_err",
                            "remediationDescription": "Mannual Steps:<br>1) Open Azure Portal.<br>2) Open Azure SQL list<br>3) Select the reported SQL Server.<br>4) Click on `Security Center` option under `Security` section.<br>5) Click on \"Enable Azure Defender for SQL\" button.",
                            "remediationFunction": "PR_AZR_0103.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "NIST 800"
                            ],
                            "service": []
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_404"
                    ],
                    "severity": "Medium",
                    "title": "Auditing on SQL server should be enabled",
                    "description": ""
                }
            ]
        }
    ]
}